(function(){const b=document.createElement("link").relList;if(b&&b.supports&&b.supports("modulepreload"))return;for(const $ of document.querySelectorAll('link[rel="modulepreload"]'))I($);new MutationObserver($=>{for(const G of $)if(G.type==="childList")for(const q of G.addedNodes)q.tagName==="LINK"&&q.rel==="modulepreload"&&I(q)}).observe(document,{childList:!0,subtree:!0});function T($){const G={};return $.integrity&&(G.integrity=$.integrity),$.referrerPolicy&&(G.referrerPolicy=$.referrerPolicy),$.crossOrigin==="use-credentials"?G.credentials="include":$.crossOrigin==="anonymous"?G.credentials="omit":G.credentials="same-origin",G}function I($){if($.ep)return;$.ep=!0;const G=T($);fetch($.href,G)}})();function ch(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var nl={exports:{}},Pi={},il={exports:{}},yt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nu;function Qd(){if(Nu)return yt;Nu=1;var p=Symbol.for("react.element"),b=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),$=Symbol.for("react.profiler"),G=Symbol.for("react.provider"),q=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),h=Symbol.iterator;function v(A){return A===null||typeof A!="object"?null:(A=h&&A[h]||A["@@iterator"],typeof A=="function"?A:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,_={};function o(A,j,Z){this.props=A,this.context=j,this.refs=_,this.updater=Z||w}o.prototype.isReactComponent={},o.prototype.setState=function(A,j){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,j,"setState")},o.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function a(){}a.prototype=o.prototype;function n(A,j,Z){this.props=A,this.context=j,this.refs=_,this.updater=Z||w}var i=n.prototype=new a;i.constructor=n,k(i,o.prototype),i.isPureReactComponent=!0;var f=Array.isArray,S=Object.prototype.hasOwnProperty,C={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function y(A,j,Z){var he,me={},ve=null,W=null;if(j!=null)for(he in j.ref!==void 0&&(W=j.ref),j.key!==void 0&&(ve=""+j.key),j)S.call(j,he)&&!E.hasOwnProperty(he)&&(me[he]=j[he]);var D=arguments.length-2;if(D===1)me.children=Z;else if(1<D){for(var oe=Array(D),ee=0;ee<D;ee++)oe[ee]=arguments[ee+2];me.children=oe}if(A&&A.defaultProps)for(he in D=A.defaultProps,D)me[he]===void 0&&(me[he]=D[he]);return{$$typeof:p,type:A,key:ve,ref:W,props:me,_owner:C.current}}function P(A,j){return{$$typeof:p,type:A.type,key:j,ref:A.ref,props:A.props,_owner:A._owner}}function O(A){return typeof A=="object"&&A!==null&&A.$$typeof===p}function F(A){var j={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(Z){return j[Z]})}var U=/\/+/g;function B(A,j){return typeof A=="object"&&A!==null&&A.key!=null?F(""+A.key):j.toString(36)}function J(A,j,Z,he,me){var ve=typeof A;(ve==="undefined"||ve==="boolean")&&(A=null);var W=!1;if(A===null)W=!0;else switch(ve){case"string":case"number":W=!0;break;case"object":switch(A.$$typeof){case p:case b:W=!0}}if(W)return W=A,me=me(W),A=he===""?"."+B(W,0):he,f(me)?(Z="",A!=null&&(Z=A.replace(U,"$&/")+"/"),J(me,j,Z,"",function(ee){return ee})):me!=null&&(O(me)&&(me=P(me,Z+(!me.key||W&&W.key===me.key?"":(""+me.key).replace(U,"$&/")+"/")+A)),j.push(me)),1;if(W=0,he=he===""?".":he+":",f(A))for(var D=0;D<A.length;D++){ve=A[D];var oe=he+B(ve,D);W+=J(ve,j,Z,oe,me)}else if(oe=v(A),typeof oe=="function")for(A=oe.call(A),D=0;!(ve=A.next()).done;)ve=ve.value,oe=he+B(ve,D++),W+=J(ve,j,Z,oe,me);else if(ve==="object")throw j=String(A),Error("Objects are not valid as a React child (found: "+(j==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":j)+"). If you meant to render a collection of children, use an array instead.");return W}function ie(A,j,Z){if(A==null)return A;var he=[],me=0;return J(A,he,"","",function(ve){return j.call(Z,ve,me++)}),he}function fe(A){if(A._status===-1){var j=A._result;j=j(),j.then(function(Z){(A._status===0||A._status===-1)&&(A._status=1,A._result=Z)},function(Z){(A._status===0||A._status===-1)&&(A._status=2,A._result=Z)}),A._status===-1&&(A._status=0,A._result=j)}if(A._status===1)return A._result.default;throw A._result}var _e={current:null},Y={transition:null},R={ReactCurrentDispatcher:_e,ReactCurrentBatchConfig:Y,ReactCurrentOwner:C};function M(){throw Error("act(...) is not supported in production builds of React.")}return yt.Children={map:ie,forEach:function(A,j,Z){ie(A,function(){j.apply(this,arguments)},Z)},count:function(A){var j=0;return ie(A,function(){j++}),j},toArray:function(A){return ie(A,function(j){return j})||[]},only:function(A){if(!O(A))throw Error("React.Children.only expected to receive a single React element child.");return A}},yt.Component=o,yt.Fragment=T,yt.Profiler=$,yt.PureComponent=n,yt.StrictMode=I,yt.Suspense=u,yt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,yt.act=M,yt.cloneElement=function(A,j,Z){if(A==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+A+".");var he=k({},A.props),me=A.key,ve=A.ref,W=A._owner;if(j!=null){if(j.ref!==void 0&&(ve=j.ref,W=C.current),j.key!==void 0&&(me=""+j.key),A.type&&A.type.defaultProps)var D=A.type.defaultProps;for(oe in j)S.call(j,oe)&&!E.hasOwnProperty(oe)&&(he[oe]=j[oe]===void 0&&D!==void 0?D[oe]:j[oe])}var oe=arguments.length-2;if(oe===1)he.children=Z;else if(1<oe){D=Array(oe);for(var ee=0;ee<oe;ee++)D[ee]=arguments[ee+2];he.children=D}return{$$typeof:p,type:A.type,key:me,ref:ve,props:he,_owner:W}},yt.createContext=function(A){return A={$$typeof:q,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},A.Provider={$$typeof:G,_context:A},A.Consumer=A},yt.createElement=y,yt.createFactory=function(A){var j=y.bind(null,A);return j.type=A,j},yt.createRef=function(){return{current:null}},yt.forwardRef=function(A){return{$$typeof:c,render:A}},yt.isValidElement=O,yt.lazy=function(A){return{$$typeof:x,_payload:{_status:-1,_result:A},_init:fe}},yt.memo=function(A,j){return{$$typeof:g,type:A,compare:j===void 0?null:j}},yt.startTransition=function(A){var j=Y.transition;Y.transition={};try{A()}finally{Y.transition=j}},yt.unstable_act=M,yt.useCallback=function(A,j){return _e.current.useCallback(A,j)},yt.useContext=function(A){return _e.current.useContext(A)},yt.useDebugValue=function(){},yt.useDeferredValue=function(A){return _e.current.useDeferredValue(A)},yt.useEffect=function(A,j){return _e.current.useEffect(A,j)},yt.useId=function(){return _e.current.useId()},yt.useImperativeHandle=function(A,j,Z){return _e.current.useImperativeHandle(A,j,Z)},yt.useInsertionEffect=function(A,j){return _e.current.useInsertionEffect(A,j)},yt.useLayoutEffect=function(A,j){return _e.current.useLayoutEffect(A,j)},yt.useMemo=function(A,j){return _e.current.useMemo(A,j)},yt.useReducer=function(A,j,Z){return _e.current.useReducer(A,j,Z)},yt.useRef=function(A){return _e.current.useRef(A)},yt.useState=function(A){return _e.current.useState(A)},yt.useSyncExternalStore=function(A,j,Z){return _e.current.useSyncExternalStore(A,j,Z)},yt.useTransition=function(){return _e.current.useTransition()},yt.version="18.3.1",yt}var Mu;function wl(){return Mu||(Mu=1,il.exports=Qd()),il.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ju;function Jd(){if(ju)return Pi;ju=1;var p=wl(),b=Symbol.for("react.element"),T=Symbol.for("react.fragment"),I=Object.prototype.hasOwnProperty,$=p.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,G={key:!0,ref:!0,__self:!0,__source:!0};function q(c,u,g){var x,h={},v=null,w=null;g!==void 0&&(v=""+g),u.key!==void 0&&(v=""+u.key),u.ref!==void 0&&(w=u.ref);for(x in u)I.call(u,x)&&!G.hasOwnProperty(x)&&(h[x]=u[x]);if(c&&c.defaultProps)for(x in u=c.defaultProps,u)h[x]===void 0&&(h[x]=u[x]);return{$$typeof:b,type:c,key:v,ref:w,props:h,_owner:$.current}}return Pi.Fragment=T,Pi.jsx=q,Pi.jsxs=q,Pi}var Bu;function Zd(){return Bu||(Bu=1,nl.exports=Jd()),nl.exports}var d=Zd(),Eo={},ol={exports:{}},Yr={},al={exports:{}},ll={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iu;function ef(){return Iu||(Iu=1,(function(p){function b(Y,R){var M=Y.length;Y.push(R);e:for(;0<M;){var A=M-1>>>1,j=Y[A];if(0<$(j,R))Y[A]=R,Y[M]=j,M=A;else break e}}function T(Y){return Y.length===0?null:Y[0]}function I(Y){if(Y.length===0)return null;var R=Y[0],M=Y.pop();if(M!==R){Y[0]=M;e:for(var A=0,j=Y.length,Z=j>>>1;A<Z;){var he=2*(A+1)-1,me=Y[he],ve=he+1,W=Y[ve];if(0>$(me,M))ve<j&&0>$(W,me)?(Y[A]=W,Y[ve]=M,A=ve):(Y[A]=me,Y[he]=M,A=he);else if(ve<j&&0>$(W,M))Y[A]=W,Y[ve]=M,A=ve;else break e}}return R}function $(Y,R){var M=Y.sortIndex-R.sortIndex;return M!==0?M:Y.id-R.id}if(typeof performance=="object"&&typeof performance.now=="function"){var G=performance;p.unstable_now=function(){return G.now()}}else{var q=Date,c=q.now();p.unstable_now=function(){return q.now()-c}}var u=[],g=[],x=1,h=null,v=3,w=!1,k=!1,_=!1,o=typeof setTimeout=="function"?setTimeout:null,a=typeof clearTimeout=="function"?clearTimeout:null,n=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function i(Y){for(var R=T(g);R!==null;){if(R.callback===null)I(g);else if(R.startTime<=Y)I(g),R.sortIndex=R.expirationTime,b(u,R);else break;R=T(g)}}function f(Y){if(_=!1,i(Y),!k)if(T(u)!==null)k=!0,fe(S);else{var R=T(g);R!==null&&_e(f,R.startTime-Y)}}function S(Y,R){k=!1,_&&(_=!1,a(y),y=-1),w=!0;var M=v;try{for(i(R),h=T(u);h!==null&&(!(h.expirationTime>R)||Y&&!F());){var A=h.callback;if(typeof A=="function"){h.callback=null,v=h.priorityLevel;var j=A(h.expirationTime<=R);R=p.unstable_now(),typeof j=="function"?h.callback=j:h===T(u)&&I(u),i(R)}else I(u);h=T(u)}if(h!==null)var Z=!0;else{var he=T(g);he!==null&&_e(f,he.startTime-R),Z=!1}return Z}finally{h=null,v=M,w=!1}}var C=!1,E=null,y=-1,P=5,O=-1;function F(){return!(p.unstable_now()-O<P)}function U(){if(E!==null){var Y=p.unstable_now();O=Y;var R=!0;try{R=E(!0,Y)}finally{R?B():(C=!1,E=null)}}else C=!1}var B;if(typeof n=="function")B=function(){n(U)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,ie=J.port2;J.port1.onmessage=U,B=function(){ie.postMessage(null)}}else B=function(){o(U,0)};function fe(Y){E=Y,C||(C=!0,B())}function _e(Y,R){y=o(function(){Y(p.unstable_now())},R)}p.unstable_IdlePriority=5,p.unstable_ImmediatePriority=1,p.unstable_LowPriority=4,p.unstable_NormalPriority=3,p.unstable_Profiling=null,p.unstable_UserBlockingPriority=2,p.unstable_cancelCallback=function(Y){Y.callback=null},p.unstable_continueExecution=function(){k||w||(k=!0,fe(S))},p.unstable_forceFrameRate=function(Y){0>Y||125<Y?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<Y?Math.floor(1e3/Y):5},p.unstable_getCurrentPriorityLevel=function(){return v},p.unstable_getFirstCallbackNode=function(){return T(u)},p.unstable_next=function(Y){switch(v){case 1:case 2:case 3:var R=3;break;default:R=v}var M=v;v=R;try{return Y()}finally{v=M}},p.unstable_pauseExecution=function(){},p.unstable_requestPaint=function(){},p.unstable_runWithPriority=function(Y,R){switch(Y){case 1:case 2:case 3:case 4:case 5:break;default:Y=3}var M=v;v=Y;try{return R()}finally{v=M}},p.unstable_scheduleCallback=function(Y,R,M){var A=p.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?A+M:A):M=A,Y){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=M+j,Y={id:x++,callback:R,priorityLevel:Y,startTime:M,expirationTime:j,sortIndex:-1},M>A?(Y.sortIndex=M,b(g,Y),T(u)===null&&Y===T(g)&&(_?(a(y),y=-1):_=!0,_e(f,M-A))):(Y.sortIndex=j,b(u,Y),k||w||(k=!0,fe(S))),Y},p.unstable_shouldYield=F,p.unstable_wrapCallback=function(Y){var R=v;return function(){var M=v;v=R;try{return Y.apply(this,arguments)}finally{v=M}}}})(ll)),ll}var Ou;function tf(){return Ou||(Ou=1,al.exports=ef()),al.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fu;function rf(){if(Fu)return Yr;Fu=1;var p=wl(),b=tf();function T(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var I=new Set,$={};function G(e,t){q(e,t),q(e+"Capture",t)}function q(e,t){for($[e]=t,e=0;e<t.length;e++)I.add(t[e])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,g=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,x={},h={};function v(e){return u.call(h,e)?!0:u.call(x,e)?!1:g.test(e)?h[e]=!0:(x[e]=!0,!1)}function w(e,t,r,s){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function k(e,t,r,s){if(t===null||typeof t>"u"||w(e,t,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function _(e,t,r,s,l,m,L){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=l,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=m,this.removeEmptyString=L}var o={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){o[e]=new _(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];o[t]=new _(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){o[e]=new _(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){o[e]=new _(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){o[e]=new _(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){o[e]=new _(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){o[e]=new _(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){o[e]=new _(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){o[e]=new _(e,5,!1,e.toLowerCase(),null,!1,!1)});var a=/[\-:]([a-z])/g;function n(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(a,n);o[t]=new _(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(a,n);o[t]=new _(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(a,n);o[t]=new _(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){o[e]=new _(e,1,!1,e.toLowerCase(),null,!1,!1)}),o.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){o[e]=new _(e,1,!1,e.toLowerCase(),null,!0,!0)});function i(e,t,r,s){var l=o.hasOwnProperty(t)?o[t]:null;(l!==null?l.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(k(t,r,l,s)&&(r=null),s||l===null?v(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):l.mustUseProperty?e[l.propertyName]=r===null?l.type===3?!1:"":r:(t=l.attributeName,s=l.attributeNamespace,r===null?e.removeAttribute(t):(l=l.type,r=l===3||l===4&&r===!0?"":""+r,s?e.setAttributeNS(s,t,r):e.setAttribute(t,r))))}var f=p.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=Symbol.for("react.element"),C=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),F=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),J=Symbol.for("react.suspense_list"),ie=Symbol.for("react.memo"),fe=Symbol.for("react.lazy"),_e=Symbol.for("react.offscreen"),Y=Symbol.iterator;function R(e){return e===null||typeof e!="object"?null:(e=Y&&e[Y]||e["@@iterator"],typeof e=="function"?e:null)}var M=Object.assign,A;function j(e){if(A===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);A=t&&t[1]||""}return`
`+A+e}var Z=!1;function he(e,t){if(!e||Z)return"";Z=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(ce){var s=ce}Reflect.construct(e,[],t)}else{try{t.call()}catch(ce){s=ce}e.call(t.prototype)}else{try{throw Error()}catch(ce){s=ce}e()}}catch(ce){if(ce&&s&&typeof ce.stack=="string"){for(var l=ce.stack.split(`
`),m=s.stack.split(`
`),L=l.length-1,z=m.length-1;1<=L&&0<=z&&l[L]!==m[z];)z--;for(;1<=L&&0<=z;L--,z--)if(l[L]!==m[z]){if(L!==1||z!==1)do if(L--,z--,0>z||l[L]!==m[z]){var K=`
`+l[L].replace(" at new "," at ");return e.displayName&&K.includes("<anonymous>")&&(K=K.replace("<anonymous>",e.displayName)),K}while(1<=L&&0<=z);break}}}finally{Z=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?j(e):""}function me(e){switch(e.tag){case 5:return j(e.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return e=he(e.type,!1),e;case 11:return e=he(e.type.render,!1),e;case 1:return e=he(e.type,!0),e;default:return""}}function ve(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case E:return"Fragment";case C:return"Portal";case P:return"Profiler";case y:return"StrictMode";case B:return"Suspense";case J:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case F:return(e.displayName||"Context")+".Consumer";case O:return(e._context.displayName||"Context")+".Provider";case U:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ie:return t=e.displayName||null,t!==null?t:ve(e.type)||"Memo";case fe:t=e._payload,e=e._init;try{return ve(e(t))}catch{}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ve(t);case 8:return t===y?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function D(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function oe(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ee(e){var t=oe(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var l=r.get,m=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return l.call(this)},set:function(L){s=""+L,m.call(this,L)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(L){s=""+L},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function xe(e){e._valueTracker||(e._valueTracker=ee(e))}function Ce(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),s="";return e&&(s=oe(e)?e.checked?"true":"false":e.value),e=s,e!==r?(t.setValue(e),!0):!1}function Ke(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Xe(e,t){var r=t.checked;return M({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function ft(e,t){var r=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;r=D(t.value!=null?t.value:r),e._wrapperState={initialChecked:s,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function gt(e,t){t=t.checked,t!=null&&i(e,"checked",t,!1)}function Ae(e,t){gt(e,t);var r=D(t.value),s=t.type;if(r!=null)s==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Nt(e,t.type,r):t.hasOwnProperty("defaultValue")&&Nt(e,t.type,D(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ht(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Nt(e,t,r){(t!=="number"||Ke(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var sr=Array.isArray;function kt(e,t,r,s){if(e=e.options,t){t={};for(var l=0;l<r.length;l++)t["$"+r[l]]=!0;for(r=0;r<e.length;r++)l=t.hasOwnProperty("$"+e[r].value),e[r].selected!==l&&(e[r].selected=l),l&&s&&(e[r].defaultSelected=!0)}else{for(r=""+D(r),t=null,l=0;l<e.length;l++){if(e[l].value===r){e[l].selected=!0,s&&(e[l].defaultSelected=!0);return}t!==null||e[l].disabled||(t=e[l])}t!==null&&(t.selected=!0)}}function De(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(T(91));return M({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Qe(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(T(92));if(sr(r)){if(1<r.length)throw Error(T(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:D(r)}}function ir(e,t){var r=D(t.value),s=D(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),s!=null&&(e.defaultValue=""+s)}function Mt(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function or(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Re(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?or(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ct,mt=(function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,s,l){MSApp.execUnsafeLocalFunction(function(){return e(t,r,s,l)})}:e})(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ct=ct||document.createElement("div"),ct.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ct.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Ue(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var ut={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},nt=["Webkit","ms","Moz","O"];Object.keys(ut).forEach(function(e){nt.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ut[t]=ut[e]})});function Qt(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||ut.hasOwnProperty(e)&&ut[e]?(""+t).trim():t+"px"}function ar(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var s=r.indexOf("--")===0,l=Qt(r,t[r],s);r==="float"&&(r="cssFloat"),s?e.setProperty(r,l):e[r]=l}}var Mr=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ur(e,t){if(t){if(Mr[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(T(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(T(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(T(61))}if(t.style!=null&&typeof t.style!="object")throw Error(T(62))}}function Yt(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kr=null;function lr(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Fr=null,Et=null,Jt=null;function pt(e){if(e=di(e)){if(typeof Fr!="function")throw Error(T(280));var t=e.stateNode;t&&(t=Hi(t),Fr(e.stateNode,e.type,t))}}function Hr(e){Et?Jt?Jt.push(e):Jt=[e]:Et=e}function jt(){if(Et){var e=Et,t=Jt;if(Jt=Et=null,pt(e),t)for(e=0;e<t.length;e++)pt(t[e])}}function Ls(e,t){return e(t)}function hs(){}var es=!1;function Xr(e,t,r){if(es)return e(t,r);es=!0;try{return Ls(e,t,r)}finally{es=!1,(Et!==null||Jt!==null)&&(hs(),jt())}}function br(e,t){var r=e.stateNode;if(r===null)return null;var s=Hi(r);if(s===null)return null;r=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(T(231,t,typeof r));return r}var fr=!1;if(c)try{var vt={};Object.defineProperty(vt,"passive",{get:function(){fr=!0}}),window.addEventListener("test",vt,vt),window.removeEventListener("test",vt,vt)}catch{fr=!1}function cn(e,t,r,s,l,m,L,z,K){var ce=Array.prototype.slice.call(arguments,3);try{t.apply(r,ce)}catch(we){this.onError(we)}}var ts=!1,yr=null,zt=!1,rs=null,Ut={onError:function(e){ts=!0,yr=e}};function zr(e,t,r,s,l,m,L,z,K){ts=!1,yr=null,cn.apply(Ut,arguments)}function $r(e,t,r,s,l,m,L,z,K){if(zr.apply(this,arguments),ts){if(ts){var ce=yr;ts=!1,yr=null}else throw Error(T(198));zt||(zt=!0,rs=ce)}}function hr(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function bt(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Cs(e){if(hr(e)!==e)throw Error(T(188))}function Ds(e){var t=e.alternate;if(!t){if(t=hr(e),t===null)throw Error(T(188));return t!==e?null:e}for(var r=e,s=t;;){var l=r.return;if(l===null)break;var m=l.alternate;if(m===null){if(s=l.return,s!==null){r=s;continue}break}if(l.child===m.child){for(m=l.child;m;){if(m===r)return Cs(l),e;if(m===s)return Cs(l),t;m=m.sibling}throw Error(T(188))}if(r.return!==s.return)r=l,s=m;else{for(var L=!1,z=l.child;z;){if(z===r){L=!0,r=l,s=m;break}if(z===s){L=!0,s=l,r=m;break}z=z.sibling}if(!L){for(z=m.child;z;){if(z===r){L=!0,r=m,s=l;break}if(z===s){L=!0,s=m,r=l;break}z=z.sibling}if(!L)throw Error(T(189))}}if(r.alternate!==s)throw Error(T(190))}if(r.tag!==3)throw Error(T(188));return r.stateNode.current===r?e:t}function Ur(e){return e=Ds(e),e!==null?Er(e):null}function Er(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Er(e);if(t!==null)return t;e=e.sibling}return null}var pr=b.unstable_scheduleCallback,ds=b.unstable_cancelCallback,X=b.unstable_shouldYield,se=b.unstable_requestPaint,te=b.unstable_now,de=b.unstable_getCurrentPriorityLevel,pe=b.unstable_ImmediatePriority,ue=b.unstable_UserBlockingPriority,ge=b.unstable_NormalPriority,Q=b.unstable_LowPriority,Ie=b.unstable_IdlePriority,Ge=null,Te=null;function Ne(e){if(Te&&typeof Te.onCommitFiberRoot=="function")try{Te.onCommitFiberRoot(Ge,e,void 0,(e.current.flags&128)===128)}catch{}}var Fe=Math.clz32?Math.clz32:it,qe=Math.log,Ye=Math.LN2;function it(e){return e>>>=0,e===0?32:31-(qe(e)/Ye|0)|0}var et=64,_t=4194304;function wt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ve(e,t){var r=e.pendingLanes;if(r===0)return 0;var s=0,l=e.suspendedLanes,m=e.pingedLanes,L=r&268435455;if(L!==0){var z=L&~l;z!==0?s=wt(z):(m&=L,m!==0&&(s=wt(m)))}else L=r&~l,L!==0?s=wt(L):m!==0&&(s=wt(m));if(s===0)return 0;if(t!==0&&t!==s&&(t&l)===0&&(l=s&-s,m=t&-t,l>=m||l===16&&(m&4194240)!==0))return t;if((s&4)!==0&&(s|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)r=31-Fe(t),l=1<<r,s|=e[r],t&=~l;return s}function Rt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ae(e,t){for(var r=e.suspendedLanes,s=e.pingedLanes,l=e.expirationTimes,m=e.pendingLanes;0<m;){var L=31-Fe(m),z=1<<L,K=l[L];K===-1?((z&r)===0||(z&s)!==0)&&(l[L]=Rt(z,t)):K<=t&&(e.expiredLanes|=z),m&=~z}}function be(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function ke(){var e=et;return et<<=1,(et&4194240)===0&&(et=64),e}function He(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ot(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Fe(t),e[t]=r}function lt(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<r;){var l=31-Fe(r),m=1<<l;t[l]=0,s[l]=-1,e[l]=-1,r&=~m}}function Je(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var s=31-Fe(r),l=1<<s;l&t|e[s]&t&&(e[s]|=t),r&=~l}}var Me=0;function It(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var Ot,Zt,mr,jr,fs,Ar=!1,$e=[],Oe=null,tt=null,At=null,Ft=new Map,Wt=new Map,Kt=[],ps="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $t(e,t){switch(e){case"focusin":case"focusout":Oe=null;break;case"dragenter":case"dragleave":tt=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Ft.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wt.delete(t.pointerId)}}function ht(e,t,r,s,l,m){return e===null||e.nativeEvent!==m?(e={blockedOn:t,domEventName:r,eventSystemFlags:s,nativeEvent:m,targetContainers:[l]},t!==null&&(t=di(t),t!==null&&Zt(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,l!==null&&t.indexOf(l)===-1&&t.push(l),e)}function er(e,t,r,s,l){switch(t){case"focusin":return Oe=ht(Oe,e,t,r,s,l),!0;case"dragenter":return tt=ht(tt,e,t,r,s,l),!0;case"mouseover":return At=ht(At,e,t,r,s,l),!0;case"pointerover":var m=l.pointerId;return Ft.set(m,ht(Ft.get(m)||null,e,t,r,s,l)),!0;case"gotpointercapture":return m=l.pointerId,Wt.set(m,ht(Wt.get(m)||null,e,t,r,s,l)),!0}return!1}function _r(e){var t=fn(e.target);if(t!==null){var r=hr(t);if(r!==null){if(t=r.tag,t===13){if(t=bt(r),t!==null){e.blockedOn=t,fs(e.priority,function(){mr(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ks(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=un(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var s=new r.constructor(r.type,r);kr=s,r.target.dispatchEvent(s),kr=null}else return t=di(r),t!==null&&Zt(t),e.blockedOn=r,!1;t.shift()}return!0}function wr(e,t,r){ks(e)&&r.delete(t)}function Ws(){Ar=!1,Oe!==null&&ks(Oe)&&(Oe=null),tt!==null&&ks(tt)&&(tt=null),At!==null&&ks(At)&&(At=null),Ft.forEach(wr),Wt.forEach(wr)}function ss(e,t){e.blockedOn===t&&(e.blockedOn=null,Ar||(Ar=!0,b.unstable_scheduleCallback(b.unstable_NormalPriority,Ws)))}function Ns(e){function t(l){return ss(l,e)}if(0<$e.length){ss($e[0],e);for(var r=1;r<$e.length;r++){var s=$e[r];s.blockedOn===e&&(s.blockedOn=null)}}for(Oe!==null&&ss(Oe,e),tt!==null&&ss(tt,e),At!==null&&ss(At,e),Ft.forEach(t),Wt.forEach(t),r=0;r<Kt.length;r++)s=Kt[r],s.blockedOn===e&&(s.blockedOn=null);for(;0<Kt.length&&(r=Kt[0],r.blockedOn===null);)_r(r),r.blockedOn===null&&Kt.shift()}var Br=f.ReactCurrentBatchConfig,bs=!0;function Jn(e,t,r,s){var l=Me,m=Br.transition;Br.transition=null;try{Me=1,Zn(e,t,r,s)}finally{Me=l,Br.transition=m}}function jo(e,t,r,s){var l=Me,m=Br.transition;Br.transition=null;try{Me=4,Zn(e,t,r,s)}finally{Me=l,Br.transition=m}}function Zn(e,t,r,s){if(bs){var l=un(e,t,r,s);if(l===null)Go(e,t,s,En,r),$t(e,s);else if(er(l,e,t,r,s))s.stopPropagation();else if($t(e,s),t&4&&-1<ps.indexOf(e)){for(;l!==null;){var m=di(l);if(m!==null&&Ot(m),m=un(e,t,r,s),m===null&&Go(e,t,s,En,r),m===l)break;l=m}l!==null&&s.stopPropagation()}else Go(e,t,s,null,r)}}var En=null;function un(e,t,r,s){if(En=null,e=lr(s),e=fn(e),e!==null)if(t=hr(e),t===null)e=null;else if(r=t.tag,r===13){if(e=bt(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return En=e,null}function ei(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(de()){case pe:return 1;case ue:return 4;case ge:case Q:return 16;case Ie:return 536870912;default:return 16}default:return 16}}var Es=null,ti=null,Pn=null;function Li(){if(Pn)return Pn;var e,t=ti,r=t.length,s,l="value"in Es?Es.value:Es.textContent,m=l.length;for(e=0;e<r&&t[e]===l[e];e++);var L=r-e;for(s=1;s<=L&&t[r-s]===l[m-s];s++);return Pn=l.slice(e,1<s?1-s:void 0)}function hn(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function dn(){return!0}function ri(){return!1}function H(e){function t(r,s,l,m,L){this._reactName=r,this._targetInst=l,this.type=s,this.nativeEvent=m,this.target=L,this.currentTarget=null;for(var z in e)e.hasOwnProperty(z)&&(r=e[z],this[z]=r?r(m):m[z]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?dn:ri,this.isPropagationStopped=ri,this}return M(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=dn)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=dn)},persist:function(){},isPersistent:dn}),t}var le={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pe=H(le),Ze=M({},le,{view:0,detail:0}),Dt=H(Ze),St,xt,Bt,Di=M({},Ze,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Io,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Bt&&(Bt&&e.type==="mousemove"?(St=e.screenX-Bt.screenX,xt=e.screenY-Bt.screenY):xt=St=0,Bt=e),St)},movementY:function(e){return"movementY"in e?e.movementY:xt}}),xl=H(Di),bh=M({},Di,{dataTransfer:0}),Eh=H(bh),Ph=M({},Ze,{relatedTarget:0}),Bo=H(Ph),Rh=M({},le,{animationName:0,elapsedTime:0,pseudoElement:0}),Ah=H(Rh),Th=M({},le,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Lh=H(Th),Dh=M({},le,{data:0}),Cl=H(Dh),Nh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Bh(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=jh[e])?!!t[e]:!1}function Io(){return Bh}var Ih=M({},Ze,{key:function(e){if(e.key){var t=Nh[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=hn(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Mh[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Io,charCode:function(e){return e.type==="keypress"?hn(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?hn(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Oh=H(Ih),Fh=M({},Di,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kl=H(Fh),Hh=M({},Ze,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Io}),zh=H(Hh),$h=M({},le,{propertyName:0,elapsedTime:0,pseudoElement:0}),Uh=H($h),Wh=M({},Di,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Kh=H(Wh),qh=[9,13,27,32],Oo=c&&"CompositionEvent"in window,si=null;c&&"documentMode"in document&&(si=document.documentMode);var Vh=c&&"TextEvent"in window&&!si,bl=c&&(!Oo||si&&8<si&&11>=si),El=" ",Pl=!1;function Rl(e,t){switch(e){case"keyup":return qh.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Al(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Rn=!1;function Gh(e,t){switch(e){case"compositionend":return Al(t);case"keypress":return t.which!==32?null:(Pl=!0,El);case"textInput":return e=t.data,e===El&&Pl?null:e;default:return null}}function Yh(e,t){if(Rn)return e==="compositionend"||!Oo&&Rl(e,t)?(e=Li(),Pn=ti=Es=null,Rn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return bl&&t.locale!=="ko"?null:t.data;default:return null}}var Xh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tl(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Xh[e.type]:t==="textarea"}function Ll(e,t,r,s){Hr(s),t=Ii(t,"onChange"),0<t.length&&(r=new Pe("onChange","change",null,r,s),e.push({event:r,listeners:t}))}var ni=null,ii=null;function Qh(e){Yl(e,0)}function Ni(e){var t=Nn(e);if(Ce(t))return e}function Jh(e,t){if(e==="change")return t}var Dl=!1;if(c){var Fo;if(c){var Ho="oninput"in document;if(!Ho){var Nl=document.createElement("div");Nl.setAttribute("oninput","return;"),Ho=typeof Nl.oninput=="function"}Fo=Ho}else Fo=!1;Dl=Fo&&(!document.documentMode||9<document.documentMode)}function Ml(){ni&&(ni.detachEvent("onpropertychange",jl),ii=ni=null)}function jl(e){if(e.propertyName==="value"&&Ni(ii)){var t=[];Ll(t,ii,e,lr(e)),Xr(Qh,t)}}function Zh(e,t,r){e==="focusin"?(Ml(),ni=t,ii=r,ni.attachEvent("onpropertychange",jl)):e==="focusout"&&Ml()}function ed(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ni(ii)}function td(e,t){if(e==="click")return Ni(t)}function rd(e,t){if(e==="input"||e==="change")return Ni(t)}function sd(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ms=typeof Object.is=="function"?Object.is:sd;function oi(e,t){if(ms(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var l=r[s];if(!u.call(t,l)||!ms(e[l],t[l]))return!1}return!0}function Bl(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Il(e,t){var r=Bl(e);e=0;for(var s;r;){if(r.nodeType===3){if(s=e+r.textContent.length,e<=t&&s>=t)return{node:r,offset:t-e};e=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Bl(r)}}function Ol(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ol(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Fl(){for(var e=window,t=Ke();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Ke(e.document)}return t}function zo(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function nd(e){var t=Fl(),r=e.focusedElem,s=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Ol(r.ownerDocument.documentElement,r)){if(s!==null&&zo(r)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var l=r.textContent.length,m=Math.min(s.start,l);s=s.end===void 0?m:Math.min(s.end,l),!e.extend&&m>s&&(l=s,s=m,m=l),l=Il(r,m);var L=Il(r,s);l&&L&&(e.rangeCount!==1||e.anchorNode!==l.node||e.anchorOffset!==l.offset||e.focusNode!==L.node||e.focusOffset!==L.offset)&&(t=t.createRange(),t.setStart(l.node,l.offset),e.removeAllRanges(),m>s?(e.addRange(t),e.extend(L.node,L.offset)):(t.setEnd(L.node,L.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var id=c&&"documentMode"in document&&11>=document.documentMode,An=null,$o=null,ai=null,Uo=!1;function Hl(e,t,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Uo||An==null||An!==Ke(s)||(s=An,"selectionStart"in s&&zo(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),ai&&oi(ai,s)||(ai=s,s=Ii($o,"onSelect"),0<s.length&&(t=new Pe("onSelect","select",null,t,r),e.push({event:t,listeners:s}),t.target=An)))}function Mi(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Tn={animationend:Mi("Animation","AnimationEnd"),animationiteration:Mi("Animation","AnimationIteration"),animationstart:Mi("Animation","AnimationStart"),transitionend:Mi("Transition","TransitionEnd")},Wo={},zl={};c&&(zl=document.createElement("div").style,"AnimationEvent"in window||(delete Tn.animationend.animation,delete Tn.animationiteration.animation,delete Tn.animationstart.animation),"TransitionEvent"in window||delete Tn.transitionend.transition);function ji(e){if(Wo[e])return Wo[e];if(!Tn[e])return e;var t=Tn[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in zl)return Wo[e]=t[r];return e}var $l=ji("animationend"),Ul=ji("animationiteration"),Wl=ji("animationstart"),Kl=ji("transitionend"),ql=new Map,Vl="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ks(e,t){ql.set(e,t),G(t,[e])}for(var Ko=0;Ko<Vl.length;Ko++){var qo=Vl[Ko],od=qo.toLowerCase(),ad=qo[0].toUpperCase()+qo.slice(1);Ks(od,"on"+ad)}Ks($l,"onAnimationEnd"),Ks(Ul,"onAnimationIteration"),Ks(Wl,"onAnimationStart"),Ks("dblclick","onDoubleClick"),Ks("focusin","onFocus"),Ks("focusout","onBlur"),Ks(Kl,"onTransitionEnd"),q("onMouseEnter",["mouseout","mouseover"]),q("onMouseLeave",["mouseout","mouseover"]),q("onPointerEnter",["pointerout","pointerover"]),q("onPointerLeave",["pointerout","pointerover"]),G("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),G("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),G("onBeforeInput",["compositionend","keypress","textInput","paste"]),G("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),G("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),G("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var li="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ld=new Set("cancel close invalid load scroll toggle".split(" ").concat(li));function Gl(e,t,r){var s=e.type||"unknown-event";e.currentTarget=r,$r(s,t,void 0,e),e.currentTarget=null}function Yl(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var s=e[r],l=s.event;s=s.listeners;e:{var m=void 0;if(t)for(var L=s.length-1;0<=L;L--){var z=s[L],K=z.instance,ce=z.currentTarget;if(z=z.listener,K!==m&&l.isPropagationStopped())break e;Gl(l,z,ce),m=K}else for(L=0;L<s.length;L++){if(z=s[L],K=z.instance,ce=z.currentTarget,z=z.listener,K!==m&&l.isPropagationStopped())break e;Gl(l,z,ce),m=K}}}if(zt)throw e=rs,zt=!1,rs=null,e}function Vt(e,t){var r=t[ea];r===void 0&&(r=t[ea]=new Set);var s=e+"__bubble";r.has(s)||(Xl(t,e,2,!1),r.add(s))}function Vo(e,t,r){var s=0;t&&(s|=4),Xl(r,e,s,t)}var Bi="_reactListening"+Math.random().toString(36).slice(2);function ci(e){if(!e[Bi]){e[Bi]=!0,I.forEach(function(r){r!=="selectionchange"&&(ld.has(r)||Vo(r,!1,e),Vo(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Bi]||(t[Bi]=!0,Vo("selectionchange",!1,t))}}function Xl(e,t,r,s){switch(ei(t)){case 1:var l=Jn;break;case 4:l=jo;break;default:l=Zn}r=l.bind(null,t,r,e),l=void 0,!fr||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(l=!0),s?l!==void 0?e.addEventListener(t,r,{capture:!0,passive:l}):e.addEventListener(t,r,!0):l!==void 0?e.addEventListener(t,r,{passive:l}):e.addEventListener(t,r,!1)}function Go(e,t,r,s,l){var m=s;if((t&1)===0&&(t&2)===0&&s!==null)e:for(;;){if(s===null)return;var L=s.tag;if(L===3||L===4){var z=s.stateNode.containerInfo;if(z===l||z.nodeType===8&&z.parentNode===l)break;if(L===4)for(L=s.return;L!==null;){var K=L.tag;if((K===3||K===4)&&(K=L.stateNode.containerInfo,K===l||K.nodeType===8&&K.parentNode===l))return;L=L.return}for(;z!==null;){if(L=fn(z),L===null)return;if(K=L.tag,K===5||K===6){s=m=L;continue e}z=z.parentNode}}s=s.return}Xr(function(){var ce=m,we=lr(r),Se=[];e:{var ye=ql.get(e);if(ye!==void 0){var Le=Pe,Be=e;switch(e){case"keypress":if(hn(r)===0)break e;case"keydown":case"keyup":Le=Oh;break;case"focusin":Be="focus",Le=Bo;break;case"focusout":Be="blur",Le=Bo;break;case"beforeblur":case"afterblur":Le=Bo;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Le=xl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Le=Eh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Le=zh;break;case $l:case Ul:case Wl:Le=Ah;break;case Kl:Le=Uh;break;case"scroll":Le=Dt;break;case"wheel":Le=Kh;break;case"copy":case"cut":case"paste":Le=Lh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Le=kl}var ze=(t&4)!==0,cr=!ze&&e==="scroll",re=ze?ye!==null?ye+"Capture":null:ye;ze=[];for(var V=ce,ne;V!==null;){ne=V;var Ee=ne.stateNode;if(ne.tag===5&&Ee!==null&&(ne=Ee,re!==null&&(Ee=br(V,re),Ee!=null&&ze.push(ui(V,Ee,ne)))),cr)break;V=V.return}0<ze.length&&(ye=new Le(ye,Be,null,r,we),Se.push({event:ye,listeners:ze}))}}if((t&7)===0){e:{if(ye=e==="mouseover"||e==="pointerover",Le=e==="mouseout"||e==="pointerout",ye&&r!==kr&&(Be=r.relatedTarget||r.fromElement)&&(fn(Be)||Be[Ms]))break e;if((Le||ye)&&(ye=we.window===we?we:(ye=we.ownerDocument)?ye.defaultView||ye.parentWindow:window,Le?(Be=r.relatedTarget||r.toElement,Le=ce,Be=Be?fn(Be):null,Be!==null&&(cr=hr(Be),Be!==cr||Be.tag!==5&&Be.tag!==6)&&(Be=null)):(Le=null,Be=ce),Le!==Be)){if(ze=xl,Ee="onMouseLeave",re="onMouseEnter",V="mouse",(e==="pointerout"||e==="pointerover")&&(ze=kl,Ee="onPointerLeave",re="onPointerEnter",V="pointer"),cr=Le==null?ye:Nn(Le),ne=Be==null?ye:Nn(Be),ye=new ze(Ee,V+"leave",Le,r,we),ye.target=cr,ye.relatedTarget=ne,Ee=null,fn(we)===ce&&(ze=new ze(re,V+"enter",Be,r,we),ze.target=ne,ze.relatedTarget=cr,Ee=ze),cr=Ee,Le&&Be)t:{for(ze=Le,re=Be,V=0,ne=ze;ne;ne=Ln(ne))V++;for(ne=0,Ee=re;Ee;Ee=Ln(Ee))ne++;for(;0<V-ne;)ze=Ln(ze),V--;for(;0<ne-V;)re=Ln(re),ne--;for(;V--;){if(ze===re||re!==null&&ze===re.alternate)break t;ze=Ln(ze),re=Ln(re)}ze=null}else ze=null;Le!==null&&Ql(Se,ye,Le,ze,!1),Be!==null&&cr!==null&&Ql(Se,cr,Be,ze,!0)}}e:{if(ye=ce?Nn(ce):window,Le=ye.nodeName&&ye.nodeName.toLowerCase(),Le==="select"||Le==="input"&&ye.type==="file")var We=Jh;else if(Tl(ye))if(Dl)We=rd;else{We=ed;var rt=Zh}else(Le=ye.nodeName)&&Le.toLowerCase()==="input"&&(ye.type==="checkbox"||ye.type==="radio")&&(We=td);if(We&&(We=We(e,ce))){Ll(Se,We,r,we);break e}rt&&rt(e,ye,ce),e==="focusout"&&(rt=ye._wrapperState)&&rt.controlled&&ye.type==="number"&&Nt(ye,"number",ye.value)}switch(rt=ce?Nn(ce):window,e){case"focusin":(Tl(rt)||rt.contentEditable==="true")&&(An=rt,$o=ce,ai=null);break;case"focusout":ai=$o=An=null;break;case"mousedown":Uo=!0;break;case"contextmenu":case"mouseup":case"dragend":Uo=!1,Hl(Se,r,we);break;case"selectionchange":if(id)break;case"keydown":case"keyup":Hl(Se,r,we)}var st;if(Oo)e:{switch(e){case"compositionstart":var at="onCompositionStart";break e;case"compositionend":at="onCompositionEnd";break e;case"compositionupdate":at="onCompositionUpdate";break e}at=void 0}else Rn?Rl(e,r)&&(at="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(at="onCompositionStart");at&&(bl&&r.locale!=="ko"&&(Rn||at!=="onCompositionStart"?at==="onCompositionEnd"&&Rn&&(st=Li()):(Es=we,ti="value"in Es?Es.value:Es.textContent,Rn=!0)),rt=Ii(ce,at),0<rt.length&&(at=new Cl(at,e,null,r,we),Se.push({event:at,listeners:rt}),st?at.data=st:(st=Al(r),st!==null&&(at.data=st)))),(st=Vh?Gh(e,r):Yh(e,r))&&(ce=Ii(ce,"onBeforeInput"),0<ce.length&&(we=new Cl("onBeforeInput","beforeinput",null,r,we),Se.push({event:we,listeners:ce}),we.data=st))}Yl(Se,t)})}function ui(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Ii(e,t){for(var r=t+"Capture",s=[];e!==null;){var l=e,m=l.stateNode;l.tag===5&&m!==null&&(l=m,m=br(e,r),m!=null&&s.unshift(ui(e,m,l)),m=br(e,t),m!=null&&s.push(ui(e,m,l))),e=e.return}return s}function Ln(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Ql(e,t,r,s,l){for(var m=t._reactName,L=[];r!==null&&r!==s;){var z=r,K=z.alternate,ce=z.stateNode;if(K!==null&&K===s)break;z.tag===5&&ce!==null&&(z=ce,l?(K=br(r,m),K!=null&&L.unshift(ui(r,K,z))):l||(K=br(r,m),K!=null&&L.push(ui(r,K,z)))),r=r.return}L.length!==0&&e.push({event:t,listeners:L})}var cd=/\r\n?/g,ud=/\u0000|\uFFFD/g;function Jl(e){return(typeof e=="string"?e:""+e).replace(cd,`
`).replace(ud,"")}function Oi(e,t,r){if(t=Jl(t),Jl(e)!==t&&r)throw Error(T(425))}function Fi(){}var Yo=null,Xo=null;function Qo(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Jo=typeof setTimeout=="function"?setTimeout:void 0,hd=typeof clearTimeout=="function"?clearTimeout:void 0,Zl=typeof Promise=="function"?Promise:void 0,dd=typeof queueMicrotask=="function"?queueMicrotask:typeof Zl<"u"?function(e){return Zl.resolve(null).then(e).catch(fd)}:Jo;function fd(e){setTimeout(function(){throw e})}function Zo(e,t){var r=t,s=0;do{var l=r.nextSibling;if(e.removeChild(r),l&&l.nodeType===8)if(r=l.data,r==="/$"){if(s===0){e.removeChild(l),Ns(t);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=l}while(r);Ns(t)}function qs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function ec(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Dn=Math.random().toString(36).slice(2),Ps="__reactFiber$"+Dn,hi="__reactProps$"+Dn,Ms="__reactContainer$"+Dn,ea="__reactEvents$"+Dn,pd="__reactListeners$"+Dn,md="__reactHandles$"+Dn;function fn(e){var t=e[Ps];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ms]||r[Ps]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=ec(e);e!==null;){if(r=e[Ps])return r;e=ec(e)}return t}e=r,r=e.parentNode}return null}function di(e){return e=e[Ps]||e[Ms],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Nn(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(T(33))}function Hi(e){return e[hi]||null}var ta=[],Mn=-1;function Vs(e){return{current:e}}function Gt(e){0>Mn||(e.current=ta[Mn],ta[Mn]=null,Mn--)}function qt(e,t){Mn++,ta[Mn]=e.current,e.current=t}var Gs={},Tr=Vs(Gs),Wr=Vs(!1),pn=Gs;function jn(e,t){var r=e.type.contextTypes;if(!r)return Gs;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var l={},m;for(m in r)l[m]=t[m];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=l),l}function Kr(e){return e=e.childContextTypes,e!=null}function zi(){Gt(Wr),Gt(Tr)}function tc(e,t,r){if(Tr.current!==Gs)throw Error(T(168));qt(Tr,t),qt(Wr,r)}function rc(e,t,r){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var l in s)if(!(l in t))throw Error(T(108,W(e)||"Unknown",l));return M({},r,s)}function $i(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Gs,pn=Tr.current,qt(Tr,e),qt(Wr,Wr.current),!0}function sc(e,t,r){var s=e.stateNode;if(!s)throw Error(T(169));r?(e=rc(e,t,pn),s.__reactInternalMemoizedMergedChildContext=e,Gt(Wr),Gt(Tr),qt(Tr,e)):Gt(Wr),qt(Wr,r)}var js=null,Ui=!1,ra=!1;function nc(e){js===null?js=[e]:js.push(e)}function _d(e){Ui=!0,nc(e)}function Ys(){if(!ra&&js!==null){ra=!0;var e=0,t=Me;try{var r=js;for(Me=1;e<r.length;e++){var s=r[e];do s=s(!0);while(s!==null)}js=null,Ui=!1}catch(l){throw js!==null&&(js=js.slice(e+1)),pr(pe,Ys),l}finally{Me=t,ra=!1}}return null}var Bn=[],In=0,Wi=null,Ki=0,ns=[],is=0,mn=null,Bs=1,Is="";function _n(e,t){Bn[In++]=Ki,Bn[In++]=Wi,Wi=e,Ki=t}function ic(e,t,r){ns[is++]=Bs,ns[is++]=Is,ns[is++]=mn,mn=e;var s=Bs;e=Is;var l=32-Fe(s)-1;s&=~(1<<l),r+=1;var m=32-Fe(t)+l;if(30<m){var L=l-l%5;m=(s&(1<<L)-1).toString(32),s>>=L,l-=L,Bs=1<<32-Fe(t)+l|r<<l|s,Is=m+e}else Bs=1<<m|r<<l|s,Is=e}function sa(e){e.return!==null&&(_n(e,1),ic(e,1,0))}function na(e){for(;e===Wi;)Wi=Bn[--In],Bn[In]=null,Ki=Bn[--In],Bn[In]=null;for(;e===mn;)mn=ns[--is],ns[is]=null,Is=ns[--is],ns[is]=null,Bs=ns[--is],ns[is]=null}var Qr=null,Jr=null,Xt=!1,_s=null;function oc(e,t){var r=cs(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function ac(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Qr=e,Jr=qs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Qr=e,Jr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=mn!==null?{id:Bs,overflow:Is}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=cs(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Qr=e,Jr=null,!0):!1;default:return!1}}function ia(e){return(e.mode&1)!==0&&(e.flags&128)===0}function oa(e){if(Xt){var t=Jr;if(t){var r=t;if(!ac(e,t)){if(ia(e))throw Error(T(418));t=qs(r.nextSibling);var s=Qr;t&&ac(e,t)?oc(s,r):(e.flags=e.flags&-4097|2,Xt=!1,Qr=e)}}else{if(ia(e))throw Error(T(418));e.flags=e.flags&-4097|2,Xt=!1,Qr=e}}}function lc(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Qr=e}function qi(e){if(e!==Qr)return!1;if(!Xt)return lc(e),Xt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Qo(e.type,e.memoizedProps)),t&&(t=Jr)){if(ia(e))throw cc(),Error(T(418));for(;t;)oc(e,t),t=qs(t.nextSibling)}if(lc(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(T(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Jr=qs(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Jr=null}}else Jr=Qr?qs(e.stateNode.nextSibling):null;return!0}function cc(){for(var e=Jr;e;)e=qs(e.nextSibling)}function On(){Jr=Qr=null,Xt=!1}function aa(e){_s===null?_s=[e]:_s.push(e)}var gd=f.ReactCurrentBatchConfig;function fi(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(T(309));var s=r.stateNode}if(!s)throw Error(T(147,e));var l=s,m=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===m?t.ref:(t=function(L){var z=l.refs;L===null?delete z[m]:z[m]=L},t._stringRef=m,t)}if(typeof e!="string")throw Error(T(284));if(!r._owner)throw Error(T(290,e))}return e}function Vi(e,t){throw e=Object.prototype.toString.call(t),Error(T(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function uc(e){var t=e._init;return t(e._payload)}function hc(e){function t(re,V){if(e){var ne=re.deletions;ne===null?(re.deletions=[V],re.flags|=16):ne.push(V)}}function r(re,V){if(!e)return null;for(;V!==null;)t(re,V),V=V.sibling;return null}function s(re,V){for(re=new Map;V!==null;)V.key!==null?re.set(V.key,V):re.set(V.index,V),V=V.sibling;return re}function l(re,V){return re=sn(re,V),re.index=0,re.sibling=null,re}function m(re,V,ne){return re.index=ne,e?(ne=re.alternate,ne!==null?(ne=ne.index,ne<V?(re.flags|=2,V):ne):(re.flags|=2,V)):(re.flags|=1048576,V)}function L(re){return e&&re.alternate===null&&(re.flags|=2),re}function z(re,V,ne,Ee){return V===null||V.tag!==6?(V=Ja(ne,re.mode,Ee),V.return=re,V):(V=l(V,ne),V.return=re,V)}function K(re,V,ne,Ee){var We=ne.type;return We===E?we(re,V,ne.props.children,Ee,ne.key):V!==null&&(V.elementType===We||typeof We=="object"&&We!==null&&We.$$typeof===fe&&uc(We)===V.type)?(Ee=l(V,ne.props),Ee.ref=fi(re,V,ne),Ee.return=re,Ee):(Ee=vo(ne.type,ne.key,ne.props,null,re.mode,Ee),Ee.ref=fi(re,V,ne),Ee.return=re,Ee)}function ce(re,V,ne,Ee){return V===null||V.tag!==4||V.stateNode.containerInfo!==ne.containerInfo||V.stateNode.implementation!==ne.implementation?(V=Za(ne,re.mode,Ee),V.return=re,V):(V=l(V,ne.children||[]),V.return=re,V)}function we(re,V,ne,Ee,We){return V===null||V.tag!==7?(V=kn(ne,re.mode,Ee,We),V.return=re,V):(V=l(V,ne),V.return=re,V)}function Se(re,V,ne){if(typeof V=="string"&&V!==""||typeof V=="number")return V=Ja(""+V,re.mode,ne),V.return=re,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case S:return ne=vo(V.type,V.key,V.props,null,re.mode,ne),ne.ref=fi(re,null,V),ne.return=re,ne;case C:return V=Za(V,re.mode,ne),V.return=re,V;case fe:var Ee=V._init;return Se(re,Ee(V._payload),ne)}if(sr(V)||R(V))return V=kn(V,re.mode,ne,null),V.return=re,V;Vi(re,V)}return null}function ye(re,V,ne,Ee){var We=V!==null?V.key:null;if(typeof ne=="string"&&ne!==""||typeof ne=="number")return We!==null?null:z(re,V,""+ne,Ee);if(typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case S:return ne.key===We?K(re,V,ne,Ee):null;case C:return ne.key===We?ce(re,V,ne,Ee):null;case fe:return We=ne._init,ye(re,V,We(ne._payload),Ee)}if(sr(ne)||R(ne))return We!==null?null:we(re,V,ne,Ee,null);Vi(re,ne)}return null}function Le(re,V,ne,Ee,We){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number")return re=re.get(ne)||null,z(V,re,""+Ee,We);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case S:return re=re.get(Ee.key===null?ne:Ee.key)||null,K(V,re,Ee,We);case C:return re=re.get(Ee.key===null?ne:Ee.key)||null,ce(V,re,Ee,We);case fe:var rt=Ee._init;return Le(re,V,ne,rt(Ee._payload),We)}if(sr(Ee)||R(Ee))return re=re.get(ne)||null,we(V,re,Ee,We,null);Vi(V,Ee)}return null}function Be(re,V,ne,Ee){for(var We=null,rt=null,st=V,at=V=0,Cr=null;st!==null&&at<ne.length;at++){st.index>at?(Cr=st,st=null):Cr=st.sibling;var Tt=ye(re,st,ne[at],Ee);if(Tt===null){st===null&&(st=Cr);break}e&&st&&Tt.alternate===null&&t(re,st),V=m(Tt,V,at),rt===null?We=Tt:rt.sibling=Tt,rt=Tt,st=Cr}if(at===ne.length)return r(re,st),Xt&&_n(re,at),We;if(st===null){for(;at<ne.length;at++)st=Se(re,ne[at],Ee),st!==null&&(V=m(st,V,at),rt===null?We=st:rt.sibling=st,rt=st);return Xt&&_n(re,at),We}for(st=s(re,st);at<ne.length;at++)Cr=Le(st,re,at,ne[at],Ee),Cr!==null&&(e&&Cr.alternate!==null&&st.delete(Cr.key===null?at:Cr.key),V=m(Cr,V,at),rt===null?We=Cr:rt.sibling=Cr,rt=Cr);return e&&st.forEach(function(nn){return t(re,nn)}),Xt&&_n(re,at),We}function ze(re,V,ne,Ee){var We=R(ne);if(typeof We!="function")throw Error(T(150));if(ne=We.call(ne),ne==null)throw Error(T(151));for(var rt=We=null,st=V,at=V=0,Cr=null,Tt=ne.next();st!==null&&!Tt.done;at++,Tt=ne.next()){st.index>at?(Cr=st,st=null):Cr=st.sibling;var nn=ye(re,st,Tt.value,Ee);if(nn===null){st===null&&(st=Cr);break}e&&st&&nn.alternate===null&&t(re,st),V=m(nn,V,at),rt===null?We=nn:rt.sibling=nn,rt=nn,st=Cr}if(Tt.done)return r(re,st),Xt&&_n(re,at),We;if(st===null){for(;!Tt.done;at++,Tt=ne.next())Tt=Se(re,Tt.value,Ee),Tt!==null&&(V=m(Tt,V,at),rt===null?We=Tt:rt.sibling=Tt,rt=Tt);return Xt&&_n(re,at),We}for(st=s(re,st);!Tt.done;at++,Tt=ne.next())Tt=Le(st,re,at,Tt.value,Ee),Tt!==null&&(e&&Tt.alternate!==null&&st.delete(Tt.key===null?at:Tt.key),V=m(Tt,V,at),rt===null?We=Tt:rt.sibling=Tt,rt=Tt);return e&&st.forEach(function(Xd){return t(re,Xd)}),Xt&&_n(re,at),We}function cr(re,V,ne,Ee){if(typeof ne=="object"&&ne!==null&&ne.type===E&&ne.key===null&&(ne=ne.props.children),typeof ne=="object"&&ne!==null){switch(ne.$$typeof){case S:e:{for(var We=ne.key,rt=V;rt!==null;){if(rt.key===We){if(We=ne.type,We===E){if(rt.tag===7){r(re,rt.sibling),V=l(rt,ne.props.children),V.return=re,re=V;break e}}else if(rt.elementType===We||typeof We=="object"&&We!==null&&We.$$typeof===fe&&uc(We)===rt.type){r(re,rt.sibling),V=l(rt,ne.props),V.ref=fi(re,rt,ne),V.return=re,re=V;break e}r(re,rt);break}else t(re,rt);rt=rt.sibling}ne.type===E?(V=kn(ne.props.children,re.mode,Ee,ne.key),V.return=re,re=V):(Ee=vo(ne.type,ne.key,ne.props,null,re.mode,Ee),Ee.ref=fi(re,V,ne),Ee.return=re,re=Ee)}return L(re);case C:e:{for(rt=ne.key;V!==null;){if(V.key===rt)if(V.tag===4&&V.stateNode.containerInfo===ne.containerInfo&&V.stateNode.implementation===ne.implementation){r(re,V.sibling),V=l(V,ne.children||[]),V.return=re,re=V;break e}else{r(re,V);break}else t(re,V);V=V.sibling}V=Za(ne,re.mode,Ee),V.return=re,re=V}return L(re);case fe:return rt=ne._init,cr(re,V,rt(ne._payload),Ee)}if(sr(ne))return Be(re,V,ne,Ee);if(R(ne))return ze(re,V,ne,Ee);Vi(re,ne)}return typeof ne=="string"&&ne!==""||typeof ne=="number"?(ne=""+ne,V!==null&&V.tag===6?(r(re,V.sibling),V=l(V,ne),V.return=re,re=V):(r(re,V),V=Ja(ne,re.mode,Ee),V.return=re,re=V),L(re)):r(re,V)}return cr}var Fn=hc(!0),dc=hc(!1),Gi=Vs(null),Yi=null,Hn=null,la=null;function ca(){la=Hn=Yi=null}function ua(e){var t=Gi.current;Gt(Gi),e._currentValue=t}function ha(e,t,r){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===r)break;e=e.return}}function zn(e,t){Yi=e,la=Hn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(qr=!0),e.firstContext=null)}function os(e){var t=e._currentValue;if(la!==e)if(e={context:e,memoizedValue:t,next:null},Hn===null){if(Yi===null)throw Error(T(308));Hn=e,Yi.dependencies={lanes:0,firstContext:e}}else Hn=Hn.next=e;return t}var gn=null;function da(e){gn===null?gn=[e]:gn.push(e)}function fc(e,t,r,s){var l=t.interleaved;return l===null?(r.next=r,da(t)):(r.next=l.next,l.next=r),t.interleaved=r,Os(e,s)}function Os(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Xs=!1;function fa(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pc(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Qs(e,t,r){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,(Pt&2)!==0){var l=s.pending;return l===null?t.next=t:(t.next=l.next,l.next=t),s.pending=t,Os(e,r)}return l=s.interleaved,l===null?(t.next=t,da(s)):(t.next=l.next,l.next=t),s.interleaved=t,Os(e,r)}function Xi(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,Je(e,r)}}function mc(e,t){var r=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var l=null,m=null;if(r=r.firstBaseUpdate,r!==null){do{var L={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};m===null?l=m=L:m=m.next=L,r=r.next}while(r!==null);m===null?l=m=t:m=m.next=t}else l=m=t;r={baseState:s.baseState,firstBaseUpdate:l,lastBaseUpdate:m,shared:s.shared,effects:s.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Qi(e,t,r,s){var l=e.updateQueue;Xs=!1;var m=l.firstBaseUpdate,L=l.lastBaseUpdate,z=l.shared.pending;if(z!==null){l.shared.pending=null;var K=z,ce=K.next;K.next=null,L===null?m=ce:L.next=ce,L=K;var we=e.alternate;we!==null&&(we=we.updateQueue,z=we.lastBaseUpdate,z!==L&&(z===null?we.firstBaseUpdate=ce:z.next=ce,we.lastBaseUpdate=K))}if(m!==null){var Se=l.baseState;L=0,we=ce=K=null,z=m;do{var ye=z.lane,Le=z.eventTime;if((s&ye)===ye){we!==null&&(we=we.next={eventTime:Le,lane:0,tag:z.tag,payload:z.payload,callback:z.callback,next:null});e:{var Be=e,ze=z;switch(ye=t,Le=r,ze.tag){case 1:if(Be=ze.payload,typeof Be=="function"){Se=Be.call(Le,Se,ye);break e}Se=Be;break e;case 3:Be.flags=Be.flags&-65537|128;case 0:if(Be=ze.payload,ye=typeof Be=="function"?Be.call(Le,Se,ye):Be,ye==null)break e;Se=M({},Se,ye);break e;case 2:Xs=!0}}z.callback!==null&&z.lane!==0&&(e.flags|=64,ye=l.effects,ye===null?l.effects=[z]:ye.push(z))}else Le={eventTime:Le,lane:ye,tag:z.tag,payload:z.payload,callback:z.callback,next:null},we===null?(ce=we=Le,K=Se):we=we.next=Le,L|=ye;if(z=z.next,z===null){if(z=l.shared.pending,z===null)break;ye=z,z=ye.next,ye.next=null,l.lastBaseUpdate=ye,l.shared.pending=null}}while(!0);if(we===null&&(K=Se),l.baseState=K,l.firstBaseUpdate=ce,l.lastBaseUpdate=we,t=l.shared.interleaved,t!==null){l=t;do L|=l.lane,l=l.next;while(l!==t)}else m===null&&(l.shared.lanes=0);wn|=L,e.lanes=L,e.memoizedState=Se}}function _c(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],l=s.callback;if(l!==null){if(s.callback=null,s=r,typeof l!="function")throw Error(T(191,l));l.call(s)}}}var pi={},Rs=Vs(pi),mi=Vs(pi),_i=Vs(pi);function vn(e){if(e===pi)throw Error(T(174));return e}function pa(e,t){switch(qt(_i,t),qt(mi,e),qt(Rs,pi),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Re(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Re(t,e)}Gt(Rs),qt(Rs,t)}function $n(){Gt(Rs),Gt(mi),Gt(_i)}function gc(e){vn(_i.current);var t=vn(Rs.current),r=Re(t,e.type);t!==r&&(qt(mi,e),qt(Rs,r))}function ma(e){mi.current===e&&(Gt(Rs),Gt(mi))}var tr=Vs(0);function Ji(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var _a=[];function ga(){for(var e=0;e<_a.length;e++)_a[e]._workInProgressVersionPrimary=null;_a.length=0}var Zi=f.ReactCurrentDispatcher,va=f.ReactCurrentBatchConfig,yn=0,rr=null,gr=null,Sr=null,eo=!1,gi=!1,vi=0,vd=0;function Lr(){throw Error(T(321))}function ya(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ms(e[r],t[r]))return!1;return!0}function wa(e,t,r,s,l,m){if(yn=m,rr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Zi.current=e===null||e.memoizedState===null?xd:Cd,e=r(s,l),gi){m=0;do{if(gi=!1,vi=0,25<=m)throw Error(T(301));m+=1,Sr=gr=null,t.updateQueue=null,Zi.current=kd,e=r(s,l)}while(gi)}if(Zi.current=so,t=gr!==null&&gr.next!==null,yn=0,Sr=gr=rr=null,eo=!1,t)throw Error(T(300));return e}function Sa(){var e=vi!==0;return vi=0,e}function As(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Sr===null?rr.memoizedState=Sr=e:Sr=Sr.next=e,Sr}function as(){if(gr===null){var e=rr.alternate;e=e!==null?e.memoizedState:null}else e=gr.next;var t=Sr===null?rr.memoizedState:Sr.next;if(t!==null)Sr=t,gr=e;else{if(e===null)throw Error(T(310));gr=e,e={memoizedState:gr.memoizedState,baseState:gr.baseState,baseQueue:gr.baseQueue,queue:gr.queue,next:null},Sr===null?rr.memoizedState=Sr=e:Sr=Sr.next=e}return Sr}function yi(e,t){return typeof t=="function"?t(e):t}function xa(e){var t=as(),r=t.queue;if(r===null)throw Error(T(311));r.lastRenderedReducer=e;var s=gr,l=s.baseQueue,m=r.pending;if(m!==null){if(l!==null){var L=l.next;l.next=m.next,m.next=L}s.baseQueue=l=m,r.pending=null}if(l!==null){m=l.next,s=s.baseState;var z=L=null,K=null,ce=m;do{var we=ce.lane;if((yn&we)===we)K!==null&&(K=K.next={lane:0,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null}),s=ce.hasEagerState?ce.eagerState:e(s,ce.action);else{var Se={lane:we,action:ce.action,hasEagerState:ce.hasEagerState,eagerState:ce.eagerState,next:null};K===null?(z=K=Se,L=s):K=K.next=Se,rr.lanes|=we,wn|=we}ce=ce.next}while(ce!==null&&ce!==m);K===null?L=s:K.next=z,ms(s,t.memoizedState)||(qr=!0),t.memoizedState=s,t.baseState=L,t.baseQueue=K,r.lastRenderedState=s}if(e=r.interleaved,e!==null){l=e;do m=l.lane,rr.lanes|=m,wn|=m,l=l.next;while(l!==e)}else l===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ca(e){var t=as(),r=t.queue;if(r===null)throw Error(T(311));r.lastRenderedReducer=e;var s=r.dispatch,l=r.pending,m=t.memoizedState;if(l!==null){r.pending=null;var L=l=l.next;do m=e(m,L.action),L=L.next;while(L!==l);ms(m,t.memoizedState)||(qr=!0),t.memoizedState=m,t.baseQueue===null&&(t.baseState=m),r.lastRenderedState=m}return[m,s]}function vc(){}function yc(e,t){var r=rr,s=as(),l=t(),m=!ms(s.memoizedState,l);if(m&&(s.memoizedState=l,qr=!0),s=s.queue,ka(xc.bind(null,r,s,e),[e]),s.getSnapshot!==t||m||Sr!==null&&Sr.memoizedState.tag&1){if(r.flags|=2048,wi(9,Sc.bind(null,r,s,l,t),void 0,null),xr===null)throw Error(T(349));(yn&30)!==0||wc(r,t,l)}return l}function wc(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=rr.updateQueue,t===null?(t={lastEffect:null,stores:null},rr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Sc(e,t,r,s){t.value=r,t.getSnapshot=s,Cc(t)&&kc(e)}function xc(e,t,r){return r(function(){Cc(t)&&kc(e)})}function Cc(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ms(e,r)}catch{return!0}}function kc(e){var t=Os(e,1);t!==null&&ws(t,e,1,-1)}function bc(e){var t=As();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yi,lastRenderedState:e},t.queue=e,e=e.dispatch=Sd.bind(null,rr,e),[t.memoizedState,e]}function wi(e,t,r,s){return e={tag:e,create:t,destroy:r,deps:s,next:null},t=rr.updateQueue,t===null?(t={lastEffect:null,stores:null},rr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(s=r.next,r.next=e,e.next=s,t.lastEffect=e)),e}function Ec(){return as().memoizedState}function to(e,t,r,s){var l=As();rr.flags|=e,l.memoizedState=wi(1|t,r,void 0,s===void 0?null:s)}function ro(e,t,r,s){var l=as();s=s===void 0?null:s;var m=void 0;if(gr!==null){var L=gr.memoizedState;if(m=L.destroy,s!==null&&ya(s,L.deps)){l.memoizedState=wi(t,r,m,s);return}}rr.flags|=e,l.memoizedState=wi(1|t,r,m,s)}function Pc(e,t){return to(8390656,8,e,t)}function ka(e,t){return ro(2048,8,e,t)}function Rc(e,t){return ro(4,2,e,t)}function Ac(e,t){return ro(4,4,e,t)}function Tc(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Lc(e,t,r){return r=r!=null?r.concat([e]):null,ro(4,4,Tc.bind(null,t,e),r)}function ba(){}function Dc(e,t){var r=as();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&ya(t,s[1])?s[0]:(r.memoizedState=[e,t],e)}function Nc(e,t){var r=as();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&ya(t,s[1])?s[0]:(e=e(),r.memoizedState=[e,t],e)}function Mc(e,t,r){return(yn&21)===0?(e.baseState&&(e.baseState=!1,qr=!0),e.memoizedState=r):(ms(r,t)||(r=ke(),rr.lanes|=r,wn|=r,e.baseState=!0),t)}function yd(e,t){var r=Me;Me=r!==0&&4>r?r:4,e(!0);var s=va.transition;va.transition={};try{e(!1),t()}finally{Me=r,va.transition=s}}function jc(){return as().memoizedState}function wd(e,t,r){var s=tn(e);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},Bc(e))Ic(t,r);else if(r=fc(e,t,r,s),r!==null){var l=Or();ws(r,e,s,l),Oc(r,t,s)}}function Sd(e,t,r){var s=tn(e),l={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(Bc(e))Ic(t,l);else{var m=e.alternate;if(e.lanes===0&&(m===null||m.lanes===0)&&(m=t.lastRenderedReducer,m!==null))try{var L=t.lastRenderedState,z=m(L,r);if(l.hasEagerState=!0,l.eagerState=z,ms(z,L)){var K=t.interleaved;K===null?(l.next=l,da(t)):(l.next=K.next,K.next=l),t.interleaved=l;return}}catch{}finally{}r=fc(e,t,l,s),r!==null&&(l=Or(),ws(r,e,s,l),Oc(r,t,s))}}function Bc(e){var t=e.alternate;return e===rr||t!==null&&t===rr}function Ic(e,t){gi=eo=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Oc(e,t,r){if((r&4194240)!==0){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,Je(e,r)}}var so={readContext:os,useCallback:Lr,useContext:Lr,useEffect:Lr,useImperativeHandle:Lr,useInsertionEffect:Lr,useLayoutEffect:Lr,useMemo:Lr,useReducer:Lr,useRef:Lr,useState:Lr,useDebugValue:Lr,useDeferredValue:Lr,useTransition:Lr,useMutableSource:Lr,useSyncExternalStore:Lr,useId:Lr,unstable_isNewReconciler:!1},xd={readContext:os,useCallback:function(e,t){return As().memoizedState=[e,t===void 0?null:t],e},useContext:os,useEffect:Pc,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,to(4194308,4,Tc.bind(null,t,e),r)},useLayoutEffect:function(e,t){return to(4194308,4,e,t)},useInsertionEffect:function(e,t){return to(4,2,e,t)},useMemo:function(e,t){var r=As();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var s=As();return t=r!==void 0?r(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=wd.bind(null,rr,e),[s.memoizedState,e]},useRef:function(e){var t=As();return e={current:e},t.memoizedState=e},useState:bc,useDebugValue:ba,useDeferredValue:function(e){return As().memoizedState=e},useTransition:function(){var e=bc(!1),t=e[0];return e=yd.bind(null,e[1]),As().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var s=rr,l=As();if(Xt){if(r===void 0)throw Error(T(407));r=r()}else{if(r=t(),xr===null)throw Error(T(349));(yn&30)!==0||wc(s,t,r)}l.memoizedState=r;var m={value:r,getSnapshot:t};return l.queue=m,Pc(xc.bind(null,s,m,e),[e]),s.flags|=2048,wi(9,Sc.bind(null,s,m,r,t),void 0,null),r},useId:function(){var e=As(),t=xr.identifierPrefix;if(Xt){var r=Is,s=Bs;r=(s&~(1<<32-Fe(s)-1)).toString(32)+r,t=":"+t+"R"+r,r=vi++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=vd++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Cd={readContext:os,useCallback:Dc,useContext:os,useEffect:ka,useImperativeHandle:Lc,useInsertionEffect:Rc,useLayoutEffect:Ac,useMemo:Nc,useReducer:xa,useRef:Ec,useState:function(){return xa(yi)},useDebugValue:ba,useDeferredValue:function(e){var t=as();return Mc(t,gr.memoizedState,e)},useTransition:function(){var e=xa(yi)[0],t=as().memoizedState;return[e,t]},useMutableSource:vc,useSyncExternalStore:yc,useId:jc,unstable_isNewReconciler:!1},kd={readContext:os,useCallback:Dc,useContext:os,useEffect:ka,useImperativeHandle:Lc,useInsertionEffect:Rc,useLayoutEffect:Ac,useMemo:Nc,useReducer:Ca,useRef:Ec,useState:function(){return Ca(yi)},useDebugValue:ba,useDeferredValue:function(e){var t=as();return gr===null?t.memoizedState=e:Mc(t,gr.memoizedState,e)},useTransition:function(){var e=Ca(yi)[0],t=as().memoizedState;return[e,t]},useMutableSource:vc,useSyncExternalStore:yc,useId:jc,unstable_isNewReconciler:!1};function gs(e,t){if(e&&e.defaultProps){t=M({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Ea(e,t,r,s){t=e.memoizedState,r=r(s,t),r=r==null?t:M({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var no={isMounted:function(e){return(e=e._reactInternals)?hr(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var s=Or(),l=tn(e),m=Fs(s,l);m.payload=t,r!=null&&(m.callback=r),t=Qs(e,m,l),t!==null&&(ws(t,e,l,s),Xi(t,e,l))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var s=Or(),l=tn(e),m=Fs(s,l);m.tag=1,m.payload=t,r!=null&&(m.callback=r),t=Qs(e,m,l),t!==null&&(ws(t,e,l,s),Xi(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Or(),s=tn(e),l=Fs(r,s);l.tag=2,t!=null&&(l.callback=t),t=Qs(e,l,s),t!==null&&(ws(t,e,s,r),Xi(t,e,s))}};function Fc(e,t,r,s,l,m,L){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,m,L):t.prototype&&t.prototype.isPureReactComponent?!oi(r,s)||!oi(l,m):!0}function Hc(e,t,r){var s=!1,l=Gs,m=t.contextType;return typeof m=="object"&&m!==null?m=os(m):(l=Kr(t)?pn:Tr.current,s=t.contextTypes,m=(s=s!=null)?jn(e,l):Gs),t=new t(r,m),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=no,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=l,e.__reactInternalMemoizedMaskedChildContext=m),t}function zc(e,t,r,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,s),t.state!==e&&no.enqueueReplaceState(t,t.state,null)}function Pa(e,t,r,s){var l=e.stateNode;l.props=r,l.state=e.memoizedState,l.refs={},fa(e);var m=t.contextType;typeof m=="object"&&m!==null?l.context=os(m):(m=Kr(t)?pn:Tr.current,l.context=jn(e,m)),l.state=e.memoizedState,m=t.getDerivedStateFromProps,typeof m=="function"&&(Ea(e,t,m,r),l.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(t=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),t!==l.state&&no.enqueueReplaceState(l,l.state,null),Qi(e,r,l,s),l.state=e.memoizedState),typeof l.componentDidMount=="function"&&(e.flags|=4194308)}function Un(e,t){try{var r="",s=t;do r+=me(s),s=s.return;while(s);var l=r}catch(m){l=`
Error generating stack: `+m.message+`
`+m.stack}return{value:e,source:t,stack:l,digest:null}}function Ra(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Aa(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var bd=typeof WeakMap=="function"?WeakMap:Map;function $c(e,t,r){r=Fs(-1,r),r.tag=3,r.payload={element:null};var s=t.value;return r.callback=function(){ho||(ho=!0,Wa=s),Aa(e,t)},r}function Uc(e,t,r){r=Fs(-1,r),r.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var l=t.value;r.payload=function(){return s(l)},r.callback=function(){Aa(e,t)}}var m=e.stateNode;return m!==null&&typeof m.componentDidCatch=="function"&&(r.callback=function(){Aa(e,t),typeof s!="function"&&(Zs===null?Zs=new Set([this]):Zs.add(this));var L=t.stack;this.componentDidCatch(t.value,{componentStack:L!==null?L:""})}),r}function Wc(e,t,r){var s=e.pingCache;if(s===null){s=e.pingCache=new bd;var l=new Set;s.set(t,l)}else l=s.get(t),l===void 0&&(l=new Set,s.set(t,l));l.has(r)||(l.add(r),e=Fd.bind(null,e,t,r),t.then(e,e))}function Kc(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function qc(e,t,r,s,l){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Fs(-1,1),t.tag=2,Qs(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=l,e)}var Ed=f.ReactCurrentOwner,qr=!1;function Ir(e,t,r,s){t.child=e===null?dc(t,null,r,s):Fn(t,e.child,r,s)}function Vc(e,t,r,s,l){r=r.render;var m=t.ref;return zn(t,l),s=wa(e,t,r,s,m,l),r=Sa(),e!==null&&!qr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,Hs(e,t,l)):(Xt&&r&&sa(t),t.flags|=1,Ir(e,t,s,l),t.child)}function Gc(e,t,r,s,l){if(e===null){var m=r.type;return typeof m=="function"&&!Qa(m)&&m.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=m,Yc(e,t,m,s,l)):(e=vo(r.type,null,s,t,t.mode,l),e.ref=t.ref,e.return=t,t.child=e)}if(m=e.child,(e.lanes&l)===0){var L=m.memoizedProps;if(r=r.compare,r=r!==null?r:oi,r(L,s)&&e.ref===t.ref)return Hs(e,t,l)}return t.flags|=1,e=sn(m,s),e.ref=t.ref,e.return=t,t.child=e}function Yc(e,t,r,s,l){if(e!==null){var m=e.memoizedProps;if(oi(m,s)&&e.ref===t.ref)if(qr=!1,t.pendingProps=s=m,(e.lanes&l)!==0)(e.flags&131072)!==0&&(qr=!0);else return t.lanes=e.lanes,Hs(e,t,l)}return Ta(e,t,r,s,l)}function Xc(e,t,r){var s=t.pendingProps,l=s.children,m=e!==null?e.memoizedState:null;if(s.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},qt(Kn,Zr),Zr|=r;else{if((r&1073741824)===0)return e=m!==null?m.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,qt(Kn,Zr),Zr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=m!==null?m.baseLanes:r,qt(Kn,Zr),Zr|=s}else m!==null?(s=m.baseLanes|r,t.memoizedState=null):s=r,qt(Kn,Zr),Zr|=s;return Ir(e,t,l,r),t.child}function Qc(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ta(e,t,r,s,l){var m=Kr(r)?pn:Tr.current;return m=jn(t,m),zn(t,l),r=wa(e,t,r,s,m,l),s=Sa(),e!==null&&!qr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,Hs(e,t,l)):(Xt&&s&&sa(t),t.flags|=1,Ir(e,t,r,l),t.child)}function Jc(e,t,r,s,l){if(Kr(r)){var m=!0;$i(t)}else m=!1;if(zn(t,l),t.stateNode===null)oo(e,t),Hc(t,r,s),Pa(t,r,s,l),s=!0;else if(e===null){var L=t.stateNode,z=t.memoizedProps;L.props=z;var K=L.context,ce=r.contextType;typeof ce=="object"&&ce!==null?ce=os(ce):(ce=Kr(r)?pn:Tr.current,ce=jn(t,ce));var we=r.getDerivedStateFromProps,Se=typeof we=="function"||typeof L.getSnapshotBeforeUpdate=="function";Se||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(z!==s||K!==ce)&&zc(t,L,s,ce),Xs=!1;var ye=t.memoizedState;L.state=ye,Qi(t,s,L,l),K=t.memoizedState,z!==s||ye!==K||Wr.current||Xs?(typeof we=="function"&&(Ea(t,r,we,s),K=t.memoizedState),(z=Xs||Fc(t,r,z,s,ye,K,ce))?(Se||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(t.flags|=4194308)):(typeof L.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=K),L.props=s,L.state=K,L.context=ce,s=z):(typeof L.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{L=t.stateNode,pc(e,t),z=t.memoizedProps,ce=t.type===t.elementType?z:gs(t.type,z),L.props=ce,Se=t.pendingProps,ye=L.context,K=r.contextType,typeof K=="object"&&K!==null?K=os(K):(K=Kr(r)?pn:Tr.current,K=jn(t,K));var Le=r.getDerivedStateFromProps;(we=typeof Le=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(z!==Se||ye!==K)&&zc(t,L,s,K),Xs=!1,ye=t.memoizedState,L.state=ye,Qi(t,s,L,l);var Be=t.memoizedState;z!==Se||ye!==Be||Wr.current||Xs?(typeof Le=="function"&&(Ea(t,r,Le,s),Be=t.memoizedState),(ce=Xs||Fc(t,r,ce,s,ye,Be,K)||!1)?(we||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(s,Be,K),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(s,Be,K)),typeof L.componentDidUpdate=="function"&&(t.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof L.componentDidUpdate!="function"||z===e.memoizedProps&&ye===e.memoizedState||(t.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||z===e.memoizedProps&&ye===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=Be),L.props=s,L.state=Be,L.context=K,s=ce):(typeof L.componentDidUpdate!="function"||z===e.memoizedProps&&ye===e.memoizedState||(t.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||z===e.memoizedProps&&ye===e.memoizedState||(t.flags|=1024),s=!1)}return La(e,t,r,s,m,l)}function La(e,t,r,s,l,m){Qc(e,t);var L=(t.flags&128)!==0;if(!s&&!L)return l&&sc(t,r,!1),Hs(e,t,m);s=t.stateNode,Ed.current=t;var z=L&&typeof r.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&L?(t.child=Fn(t,e.child,null,m),t.child=Fn(t,null,z,m)):Ir(e,t,z,m),t.memoizedState=s.state,l&&sc(t,r,!0),t.child}function Zc(e){var t=e.stateNode;t.pendingContext?tc(e,t.pendingContext,t.pendingContext!==t.context):t.context&&tc(e,t.context,!1),pa(e,t.containerInfo)}function eu(e,t,r,s,l){return On(),aa(l),t.flags|=256,Ir(e,t,r,s),t.child}var Da={dehydrated:null,treeContext:null,retryLane:0};function Na(e){return{baseLanes:e,cachePool:null,transitions:null}}function tu(e,t,r){var s=t.pendingProps,l=tr.current,m=!1,L=(t.flags&128)!==0,z;if((z=L)||(z=e!==null&&e.memoizedState===null?!1:(l&2)!==0),z?(m=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(l|=1),qt(tr,l&1),e===null)return oa(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(L=s.children,e=s.fallback,m?(s=t.mode,m=t.child,L={mode:"hidden",children:L},(s&1)===0&&m!==null?(m.childLanes=0,m.pendingProps=L):m=yo(L,s,0,null),e=kn(e,s,r,null),m.return=t,e.return=t,m.sibling=e,t.child=m,t.child.memoizedState=Na(r),t.memoizedState=Da,e):Ma(t,L));if(l=e.memoizedState,l!==null&&(z=l.dehydrated,z!==null))return Pd(e,t,L,s,z,l,r);if(m){m=s.fallback,L=t.mode,l=e.child,z=l.sibling;var K={mode:"hidden",children:s.children};return(L&1)===0&&t.child!==l?(s=t.child,s.childLanes=0,s.pendingProps=K,t.deletions=null):(s=sn(l,K),s.subtreeFlags=l.subtreeFlags&14680064),z!==null?m=sn(z,m):(m=kn(m,L,r,null),m.flags|=2),m.return=t,s.return=t,s.sibling=m,t.child=s,s=m,m=t.child,L=e.child.memoizedState,L=L===null?Na(r):{baseLanes:L.baseLanes|r,cachePool:null,transitions:L.transitions},m.memoizedState=L,m.childLanes=e.childLanes&~r,t.memoizedState=Da,s}return m=e.child,e=m.sibling,s=sn(m,{mode:"visible",children:s.children}),(t.mode&1)===0&&(s.lanes=r),s.return=t,s.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=s,t.memoizedState=null,s}function Ma(e,t){return t=yo({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function io(e,t,r,s){return s!==null&&aa(s),Fn(t,e.child,null,r),e=Ma(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Pd(e,t,r,s,l,m,L){if(r)return t.flags&256?(t.flags&=-257,s=Ra(Error(T(422))),io(e,t,L,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(m=s.fallback,l=t.mode,s=yo({mode:"visible",children:s.children},l,0,null),m=kn(m,l,L,null),m.flags|=2,s.return=t,m.return=t,s.sibling=m,t.child=s,(t.mode&1)!==0&&Fn(t,e.child,null,L),t.child.memoizedState=Na(L),t.memoizedState=Da,m);if((t.mode&1)===0)return io(e,t,L,null);if(l.data==="$!"){if(s=l.nextSibling&&l.nextSibling.dataset,s)var z=s.dgst;return s=z,m=Error(T(419)),s=Ra(m,s,void 0),io(e,t,L,s)}if(z=(L&e.childLanes)!==0,qr||z){if(s=xr,s!==null){switch(L&-L){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=(l&(s.suspendedLanes|L))!==0?0:l,l!==0&&l!==m.retryLane&&(m.retryLane=l,Os(e,l),ws(s,e,l,-1))}return Xa(),s=Ra(Error(T(421))),io(e,t,L,s)}return l.data==="$?"?(t.flags|=128,t.child=e.child,t=Hd.bind(null,e),l._reactRetry=t,null):(e=m.treeContext,Jr=qs(l.nextSibling),Qr=t,Xt=!0,_s=null,e!==null&&(ns[is++]=Bs,ns[is++]=Is,ns[is++]=mn,Bs=e.id,Is=e.overflow,mn=t),t=Ma(t,s.children),t.flags|=4096,t)}function ru(e,t,r){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),ha(e.return,t,r)}function ja(e,t,r,s,l){var m=e.memoizedState;m===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:l}:(m.isBackwards=t,m.rendering=null,m.renderingStartTime=0,m.last=s,m.tail=r,m.tailMode=l)}function su(e,t,r){var s=t.pendingProps,l=s.revealOrder,m=s.tail;if(Ir(e,t,s.children,r),s=tr.current,(s&2)!==0)s=s&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&ru(e,r,t);else if(e.tag===19)ru(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(qt(tr,s),(t.mode&1)===0)t.memoizedState=null;else switch(l){case"forwards":for(r=t.child,l=null;r!==null;)e=r.alternate,e!==null&&Ji(e)===null&&(l=r),r=r.sibling;r=l,r===null?(l=t.child,t.child=null):(l=r.sibling,r.sibling=null),ja(t,!1,l,r,m);break;case"backwards":for(r=null,l=t.child,t.child=null;l!==null;){if(e=l.alternate,e!==null&&Ji(e)===null){t.child=l;break}e=l.sibling,l.sibling=r,r=l,l=e}ja(t,!0,r,null,m);break;case"together":ja(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function oo(e,t){(t.mode&1)===0&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hs(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),wn|=t.lanes,(r&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(T(153));if(t.child!==null){for(e=t.child,r=sn(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=sn(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Rd(e,t,r){switch(t.tag){case 3:Zc(t),On();break;case 5:gc(t);break;case 1:Kr(t.type)&&$i(t);break;case 4:pa(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,l=t.memoizedProps.value;qt(Gi,s._currentValue),s._currentValue=l;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(qt(tr,tr.current&1),t.flags|=128,null):(r&t.child.childLanes)!==0?tu(e,t,r):(qt(tr,tr.current&1),e=Hs(e,t,r),e!==null?e.sibling:null);qt(tr,tr.current&1);break;case 19:if(s=(r&t.childLanes)!==0,(e.flags&128)!==0){if(s)return su(e,t,r);t.flags|=128}if(l=t.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),qt(tr,tr.current),s)break;return null;case 22:case 23:return t.lanes=0,Xc(e,t,r)}return Hs(e,t,r)}var nu,Ba,iu,ou;nu=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Ba=function(){},iu=function(e,t,r,s){var l=e.memoizedProps;if(l!==s){e=t.stateNode,vn(Rs.current);var m=null;switch(r){case"input":l=Xe(e,l),s=Xe(e,s),m=[];break;case"select":l=M({},l,{value:void 0}),s=M({},s,{value:void 0}),m=[];break;case"textarea":l=De(e,l),s=De(e,s),m=[];break;default:typeof l.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=Fi)}ur(r,s);var L;r=null;for(ce in l)if(!s.hasOwnProperty(ce)&&l.hasOwnProperty(ce)&&l[ce]!=null)if(ce==="style"){var z=l[ce];for(L in z)z.hasOwnProperty(L)&&(r||(r={}),r[L]="")}else ce!=="dangerouslySetInnerHTML"&&ce!=="children"&&ce!=="suppressContentEditableWarning"&&ce!=="suppressHydrationWarning"&&ce!=="autoFocus"&&($.hasOwnProperty(ce)?m||(m=[]):(m=m||[]).push(ce,null));for(ce in s){var K=s[ce];if(z=l!=null?l[ce]:void 0,s.hasOwnProperty(ce)&&K!==z&&(K!=null||z!=null))if(ce==="style")if(z){for(L in z)!z.hasOwnProperty(L)||K&&K.hasOwnProperty(L)||(r||(r={}),r[L]="");for(L in K)K.hasOwnProperty(L)&&z[L]!==K[L]&&(r||(r={}),r[L]=K[L])}else r||(m||(m=[]),m.push(ce,r)),r=K;else ce==="dangerouslySetInnerHTML"?(K=K?K.__html:void 0,z=z?z.__html:void 0,K!=null&&z!==K&&(m=m||[]).push(ce,K)):ce==="children"?typeof K!="string"&&typeof K!="number"||(m=m||[]).push(ce,""+K):ce!=="suppressContentEditableWarning"&&ce!=="suppressHydrationWarning"&&($.hasOwnProperty(ce)?(K!=null&&ce==="onScroll"&&Vt("scroll",e),m||z===K||(m=[])):(m=m||[]).push(ce,K))}r&&(m=m||[]).push("style",r);var ce=m;(t.updateQueue=ce)&&(t.flags|=4)}},ou=function(e,t,r,s){r!==s&&(t.flags|=4)};function Si(e,t){if(!Xt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Dr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,s=0;if(t)for(var l=e.child;l!==null;)r|=l.lanes|l.childLanes,s|=l.subtreeFlags&14680064,s|=l.flags&14680064,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)r|=l.lanes|l.childLanes,s|=l.subtreeFlags,s|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=s,e.childLanes=r,t}function Ad(e,t,r){var s=t.pendingProps;switch(na(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dr(t),null;case 1:return Kr(t.type)&&zi(),Dr(t),null;case 3:return s=t.stateNode,$n(),Gt(Wr),Gt(Tr),ga(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(qi(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,_s!==null&&(Va(_s),_s=null))),Ba(e,t),Dr(t),null;case 5:ma(t);var l=vn(_i.current);if(r=t.type,e!==null&&t.stateNode!=null)iu(e,t,r,s,l),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(T(166));return Dr(t),null}if(e=vn(Rs.current),qi(t)){s=t.stateNode,r=t.type;var m=t.memoizedProps;switch(s[Ps]=t,s[hi]=m,e=(t.mode&1)!==0,r){case"dialog":Vt("cancel",s),Vt("close",s);break;case"iframe":case"object":case"embed":Vt("load",s);break;case"video":case"audio":for(l=0;l<li.length;l++)Vt(li[l],s);break;case"source":Vt("error",s);break;case"img":case"image":case"link":Vt("error",s),Vt("load",s);break;case"details":Vt("toggle",s);break;case"input":ft(s,m),Vt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!m.multiple},Vt("invalid",s);break;case"textarea":Qe(s,m),Vt("invalid",s)}ur(r,m),l=null;for(var L in m)if(m.hasOwnProperty(L)){var z=m[L];L==="children"?typeof z=="string"?s.textContent!==z&&(m.suppressHydrationWarning!==!0&&Oi(s.textContent,z,e),l=["children",z]):typeof z=="number"&&s.textContent!==""+z&&(m.suppressHydrationWarning!==!0&&Oi(s.textContent,z,e),l=["children",""+z]):$.hasOwnProperty(L)&&z!=null&&L==="onScroll"&&Vt("scroll",s)}switch(r){case"input":xe(s),Ht(s,m,!0);break;case"textarea":xe(s),Mt(s);break;case"select":case"option":break;default:typeof m.onClick=="function"&&(s.onclick=Fi)}s=l,t.updateQueue=s,s!==null&&(t.flags|=4)}else{L=l.nodeType===9?l:l.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=or(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=L.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=L.createElement(r,{is:s.is}):(e=L.createElement(r),r==="select"&&(L=e,s.multiple?L.multiple=!0:s.size&&(L.size=s.size))):e=L.createElementNS(e,r),e[Ps]=t,e[hi]=s,nu(e,t,!1,!1),t.stateNode=e;e:{switch(L=Yt(r,s),r){case"dialog":Vt("cancel",e),Vt("close",e),l=s;break;case"iframe":case"object":case"embed":Vt("load",e),l=s;break;case"video":case"audio":for(l=0;l<li.length;l++)Vt(li[l],e);l=s;break;case"source":Vt("error",e),l=s;break;case"img":case"image":case"link":Vt("error",e),Vt("load",e),l=s;break;case"details":Vt("toggle",e),l=s;break;case"input":ft(e,s),l=Xe(e,s),Vt("invalid",e);break;case"option":l=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},l=M({},s,{value:void 0}),Vt("invalid",e);break;case"textarea":Qe(e,s),l=De(e,s),Vt("invalid",e);break;default:l=s}ur(r,l),z=l;for(m in z)if(z.hasOwnProperty(m)){var K=z[m];m==="style"?ar(e,K):m==="dangerouslySetInnerHTML"?(K=K?K.__html:void 0,K!=null&&mt(e,K)):m==="children"?typeof K=="string"?(r!=="textarea"||K!=="")&&Ue(e,K):typeof K=="number"&&Ue(e,""+K):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&($.hasOwnProperty(m)?K!=null&&m==="onScroll"&&Vt("scroll",e):K!=null&&i(e,m,K,L))}switch(r){case"input":xe(e),Ht(e,s,!1);break;case"textarea":xe(e),Mt(e);break;case"option":s.value!=null&&e.setAttribute("value",""+D(s.value));break;case"select":e.multiple=!!s.multiple,m=s.value,m!=null?kt(e,!!s.multiple,m,!1):s.defaultValue!=null&&kt(e,!!s.multiple,s.defaultValue,!0);break;default:typeof l.onClick=="function"&&(e.onclick=Fi)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Dr(t),null;case 6:if(e&&t.stateNode!=null)ou(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(T(166));if(r=vn(_i.current),vn(Rs.current),qi(t)){if(s=t.stateNode,r=t.memoizedProps,s[Ps]=t,(m=s.nodeValue!==r)&&(e=Qr,e!==null))switch(e.tag){case 3:Oi(s.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Oi(s.nodeValue,r,(e.mode&1)!==0)}m&&(t.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[Ps]=t,t.stateNode=s}return Dr(t),null;case 13:if(Gt(tr),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Xt&&Jr!==null&&(t.mode&1)!==0&&(t.flags&128)===0)cc(),On(),t.flags|=98560,m=!1;else if(m=qi(t),s!==null&&s.dehydrated!==null){if(e===null){if(!m)throw Error(T(318));if(m=t.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(T(317));m[Ps]=t}else On(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Dr(t),m=!1}else _s!==null&&(Va(_s),_s=null),m=!0;if(!m)return t.flags&65536?t:null}return(t.flags&128)!==0?(t.lanes=r,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(tr.current&1)!==0?vr===0&&(vr=3):Xa())),t.updateQueue!==null&&(t.flags|=4),Dr(t),null);case 4:return $n(),Ba(e,t),e===null&&ci(t.stateNode.containerInfo),Dr(t),null;case 10:return ua(t.type._context),Dr(t),null;case 17:return Kr(t.type)&&zi(),Dr(t),null;case 19:if(Gt(tr),m=t.memoizedState,m===null)return Dr(t),null;if(s=(t.flags&128)!==0,L=m.rendering,L===null)if(s)Si(m,!1);else{if(vr!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(L=Ji(e),L!==null){for(t.flags|=128,Si(m,!1),s=L.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=r,r=t.child;r!==null;)m=r,e=s,m.flags&=14680066,L=m.alternate,L===null?(m.childLanes=0,m.lanes=e,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=L.childLanes,m.lanes=L.lanes,m.child=L.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=L.memoizedProps,m.memoizedState=L.memoizedState,m.updateQueue=L.updateQueue,m.type=L.type,e=L.dependencies,m.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return qt(tr,tr.current&1|2),t.child}e=e.sibling}m.tail!==null&&te()>qn&&(t.flags|=128,s=!0,Si(m,!1),t.lanes=4194304)}else{if(!s)if(e=Ji(L),e!==null){if(t.flags|=128,s=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Si(m,!0),m.tail===null&&m.tailMode==="hidden"&&!L.alternate&&!Xt)return Dr(t),null}else 2*te()-m.renderingStartTime>qn&&r!==1073741824&&(t.flags|=128,s=!0,Si(m,!1),t.lanes=4194304);m.isBackwards?(L.sibling=t.child,t.child=L):(r=m.last,r!==null?r.sibling=L:t.child=L,m.last=L)}return m.tail!==null?(t=m.tail,m.rendering=t,m.tail=t.sibling,m.renderingStartTime=te(),t.sibling=null,r=tr.current,qt(tr,s?r&1|2:r&1),t):(Dr(t),null);case 22:case 23:return Ya(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&(t.mode&1)!==0?(Zr&1073741824)!==0&&(Dr(t),t.subtreeFlags&6&&(t.flags|=8192)):Dr(t),null;case 24:return null;case 25:return null}throw Error(T(156,t.tag))}function Td(e,t){switch(na(t),t.tag){case 1:return Kr(t.type)&&zi(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return $n(),Gt(Wr),Gt(Tr),ga(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return ma(t),null;case 13:if(Gt(tr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(T(340));On()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Gt(tr),null;case 4:return $n(),null;case 10:return ua(t.type._context),null;case 22:case 23:return Ya(),null;case 24:return null;default:return null}}var ao=!1,Nr=!1,Ld=typeof WeakSet=="function"?WeakSet:Set,je=null;function Wn(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){nr(e,t,s)}else r.current=null}function Ia(e,t,r){try{r()}catch(s){nr(e,t,s)}}var au=!1;function Dd(e,t){if(Yo=bs,e=Fl(),zo(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var l=s.anchorOffset,m=s.focusNode;s=s.focusOffset;try{r.nodeType,m.nodeType}catch{r=null;break e}var L=0,z=-1,K=-1,ce=0,we=0,Se=e,ye=null;t:for(;;){for(var Le;Se!==r||l!==0&&Se.nodeType!==3||(z=L+l),Se!==m||s!==0&&Se.nodeType!==3||(K=L+s),Se.nodeType===3&&(L+=Se.nodeValue.length),(Le=Se.firstChild)!==null;)ye=Se,Se=Le;for(;;){if(Se===e)break t;if(ye===r&&++ce===l&&(z=L),ye===m&&++we===s&&(K=L),(Le=Se.nextSibling)!==null)break;Se=ye,ye=Se.parentNode}Se=Le}r=z===-1||K===-1?null:{start:z,end:K}}else r=null}r=r||{start:0,end:0}}else r=null;for(Xo={focusedElem:e,selectionRange:r},bs=!1,je=t;je!==null;)if(t=je,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,je=e;else for(;je!==null;){t=je;try{var Be=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(Be!==null){var ze=Be.memoizedProps,cr=Be.memoizedState,re=t.stateNode,V=re.getSnapshotBeforeUpdate(t.elementType===t.type?ze:gs(t.type,ze),cr);re.__reactInternalSnapshotBeforeUpdate=V}break;case 3:var ne=t.stateNode.containerInfo;ne.nodeType===1?ne.textContent="":ne.nodeType===9&&ne.documentElement&&ne.removeChild(ne.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(T(163))}}catch(Ee){nr(t,t.return,Ee)}if(e=t.sibling,e!==null){e.return=t.return,je=e;break}je=t.return}return Be=au,au=!1,Be}function xi(e,t,r){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var l=s=s.next;do{if((l.tag&e)===e){var m=l.destroy;l.destroy=void 0,m!==void 0&&Ia(t,r,m)}l=l.next}while(l!==s)}}function lo(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var s=r.create;r.destroy=s()}r=r.next}while(r!==t)}}function Oa(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function lu(e){var t=e.alternate;t!==null&&(e.alternate=null,lu(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ps],delete t[hi],delete t[ea],delete t[pd],delete t[md])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function cu(e){return e.tag===5||e.tag===3||e.tag===4}function uu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||cu(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Fa(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Fi));else if(s!==4&&(e=e.child,e!==null))for(Fa(e,t,r),e=e.sibling;e!==null;)Fa(e,t,r),e=e.sibling}function Ha(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(Ha(e,t,r),e=e.sibling;e!==null;)Ha(e,t,r),e=e.sibling}var Pr=null,vs=!1;function Js(e,t,r){for(r=r.child;r!==null;)hu(e,t,r),r=r.sibling}function hu(e,t,r){if(Te&&typeof Te.onCommitFiberUnmount=="function")try{Te.onCommitFiberUnmount(Ge,r)}catch{}switch(r.tag){case 5:Nr||Wn(r,t);case 6:var s=Pr,l=vs;Pr=null,Js(e,t,r),Pr=s,vs=l,Pr!==null&&(vs?(e=Pr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Pr.removeChild(r.stateNode));break;case 18:Pr!==null&&(vs?(e=Pr,r=r.stateNode,e.nodeType===8?Zo(e.parentNode,r):e.nodeType===1&&Zo(e,r),Ns(e)):Zo(Pr,r.stateNode));break;case 4:s=Pr,l=vs,Pr=r.stateNode.containerInfo,vs=!0,Js(e,t,r),Pr=s,vs=l;break;case 0:case 11:case 14:case 15:if(!Nr&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){l=s=s.next;do{var m=l,L=m.destroy;m=m.tag,L!==void 0&&((m&2)!==0||(m&4)!==0)&&Ia(r,t,L),l=l.next}while(l!==s)}Js(e,t,r);break;case 1:if(!Nr&&(Wn(r,t),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(z){nr(r,t,z)}Js(e,t,r);break;case 21:Js(e,t,r);break;case 22:r.mode&1?(Nr=(s=Nr)||r.memoizedState!==null,Js(e,t,r),Nr=s):Js(e,t,r);break;default:Js(e,t,r)}}function du(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Ld),t.forEach(function(s){var l=zd.bind(null,e,s);r.has(s)||(r.add(s),s.then(l,l))})}}function ys(e,t){var r=t.deletions;if(r!==null)for(var s=0;s<r.length;s++){var l=r[s];try{var m=e,L=t,z=L;e:for(;z!==null;){switch(z.tag){case 5:Pr=z.stateNode,vs=!1;break e;case 3:Pr=z.stateNode.containerInfo,vs=!0;break e;case 4:Pr=z.stateNode.containerInfo,vs=!0;break e}z=z.return}if(Pr===null)throw Error(T(160));hu(m,L,l),Pr=null,vs=!1;var K=l.alternate;K!==null&&(K.return=null),l.return=null}catch(ce){nr(l,t,ce)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)fu(t,e),t=t.sibling}function fu(e,t){var r=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ys(t,e),Ts(e),s&4){try{xi(3,e,e.return),lo(3,e)}catch(ze){nr(e,e.return,ze)}try{xi(5,e,e.return)}catch(ze){nr(e,e.return,ze)}}break;case 1:ys(t,e),Ts(e),s&512&&r!==null&&Wn(r,r.return);break;case 5:if(ys(t,e),Ts(e),s&512&&r!==null&&Wn(r,r.return),e.flags&32){var l=e.stateNode;try{Ue(l,"")}catch(ze){nr(e,e.return,ze)}}if(s&4&&(l=e.stateNode,l!=null)){var m=e.memoizedProps,L=r!==null?r.memoizedProps:m,z=e.type,K=e.updateQueue;if(e.updateQueue=null,K!==null)try{z==="input"&&m.type==="radio"&&m.name!=null&&gt(l,m),Yt(z,L);var ce=Yt(z,m);for(L=0;L<K.length;L+=2){var we=K[L],Se=K[L+1];we==="style"?ar(l,Se):we==="dangerouslySetInnerHTML"?mt(l,Se):we==="children"?Ue(l,Se):i(l,we,Se,ce)}switch(z){case"input":Ae(l,m);break;case"textarea":ir(l,m);break;case"select":var ye=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!m.multiple;var Le=m.value;Le!=null?kt(l,!!m.multiple,Le,!1):ye!==!!m.multiple&&(m.defaultValue!=null?kt(l,!!m.multiple,m.defaultValue,!0):kt(l,!!m.multiple,m.multiple?[]:"",!1))}l[hi]=m}catch(ze){nr(e,e.return,ze)}}break;case 6:if(ys(t,e),Ts(e),s&4){if(e.stateNode===null)throw Error(T(162));l=e.stateNode,m=e.memoizedProps;try{l.nodeValue=m}catch(ze){nr(e,e.return,ze)}}break;case 3:if(ys(t,e),Ts(e),s&4&&r!==null&&r.memoizedState.isDehydrated)try{Ns(t.containerInfo)}catch(ze){nr(e,e.return,ze)}break;case 4:ys(t,e),Ts(e);break;case 13:ys(t,e),Ts(e),l=e.child,l.flags&8192&&(m=l.memoizedState!==null,l.stateNode.isHidden=m,!m||l.alternate!==null&&l.alternate.memoizedState!==null||(Ua=te())),s&4&&du(e);break;case 22:if(we=r!==null&&r.memoizedState!==null,e.mode&1?(Nr=(ce=Nr)||we,ys(t,e),Nr=ce):ys(t,e),Ts(e),s&8192){if(ce=e.memoizedState!==null,(e.stateNode.isHidden=ce)&&!we&&(e.mode&1)!==0)for(je=e,we=e.child;we!==null;){for(Se=je=we;je!==null;){switch(ye=je,Le=ye.child,ye.tag){case 0:case 11:case 14:case 15:xi(4,ye,ye.return);break;case 1:Wn(ye,ye.return);var Be=ye.stateNode;if(typeof Be.componentWillUnmount=="function"){s=ye,r=ye.return;try{t=s,Be.props=t.memoizedProps,Be.state=t.memoizedState,Be.componentWillUnmount()}catch(ze){nr(s,r,ze)}}break;case 5:Wn(ye,ye.return);break;case 22:if(ye.memoizedState!==null){_u(Se);continue}}Le!==null?(Le.return=ye,je=Le):_u(Se)}we=we.sibling}e:for(we=null,Se=e;;){if(Se.tag===5){if(we===null){we=Se;try{l=Se.stateNode,ce?(m=l.style,typeof m.setProperty=="function"?m.setProperty("display","none","important"):m.display="none"):(z=Se.stateNode,K=Se.memoizedProps.style,L=K!=null&&K.hasOwnProperty("display")?K.display:null,z.style.display=Qt("display",L))}catch(ze){nr(e,e.return,ze)}}}else if(Se.tag===6){if(we===null)try{Se.stateNode.nodeValue=ce?"":Se.memoizedProps}catch(ze){nr(e,e.return,ze)}}else if((Se.tag!==22&&Se.tag!==23||Se.memoizedState===null||Se===e)&&Se.child!==null){Se.child.return=Se,Se=Se.child;continue}if(Se===e)break e;for(;Se.sibling===null;){if(Se.return===null||Se.return===e)break e;we===Se&&(we=null),Se=Se.return}we===Se&&(we=null),Se.sibling.return=Se.return,Se=Se.sibling}}break;case 19:ys(t,e),Ts(e),s&4&&du(e);break;case 21:break;default:ys(t,e),Ts(e)}}function Ts(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(cu(r)){var s=r;break e}r=r.return}throw Error(T(160))}switch(s.tag){case 5:var l=s.stateNode;s.flags&32&&(Ue(l,""),s.flags&=-33);var m=uu(e);Ha(e,m,l);break;case 3:case 4:var L=s.stateNode.containerInfo,z=uu(e);Fa(e,z,L);break;default:throw Error(T(161))}}catch(K){nr(e,e.return,K)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Nd(e,t,r){je=e,pu(e)}function pu(e,t,r){for(var s=(e.mode&1)!==0;je!==null;){var l=je,m=l.child;if(l.tag===22&&s){var L=l.memoizedState!==null||ao;if(!L){var z=l.alternate,K=z!==null&&z.memoizedState!==null||Nr;z=ao;var ce=Nr;if(ao=L,(Nr=K)&&!ce)for(je=l;je!==null;)L=je,K=L.child,L.tag===22&&L.memoizedState!==null?gu(l):K!==null?(K.return=L,je=K):gu(l);for(;m!==null;)je=m,pu(m),m=m.sibling;je=l,ao=z,Nr=ce}mu(e)}else(l.subtreeFlags&8772)!==0&&m!==null?(m.return=l,je=m):mu(e)}}function mu(e){for(;je!==null;){var t=je;if((t.flags&8772)!==0){var r=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:Nr||lo(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!Nr)if(r===null)s.componentDidMount();else{var l=t.elementType===t.type?r.memoizedProps:gs(t.type,r.memoizedProps);s.componentDidUpdate(l,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var m=t.updateQueue;m!==null&&_c(t,m,s);break;case 3:var L=t.updateQueue;if(L!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}_c(t,L,r)}break;case 5:var z=t.stateNode;if(r===null&&t.flags&4){r=z;var K=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":K.autoFocus&&r.focus();break;case"img":K.src&&(r.src=K.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var ce=t.alternate;if(ce!==null){var we=ce.memoizedState;if(we!==null){var Se=we.dehydrated;Se!==null&&Ns(Se)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(T(163))}Nr||t.flags&512&&Oa(t)}catch(ye){nr(t,t.return,ye)}}if(t===e){je=null;break}if(r=t.sibling,r!==null){r.return=t.return,je=r;break}je=t.return}}function _u(e){for(;je!==null;){var t=je;if(t===e){je=null;break}var r=t.sibling;if(r!==null){r.return=t.return,je=r;break}je=t.return}}function gu(e){for(;je!==null;){var t=je;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{lo(4,t)}catch(K){nr(t,r,K)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var l=t.return;try{s.componentDidMount()}catch(K){nr(t,l,K)}}var m=t.return;try{Oa(t)}catch(K){nr(t,m,K)}break;case 5:var L=t.return;try{Oa(t)}catch(K){nr(t,L,K)}}}catch(K){nr(t,t.return,K)}if(t===e){je=null;break}var z=t.sibling;if(z!==null){z.return=t.return,je=z;break}je=t.return}}var Md=Math.ceil,co=f.ReactCurrentDispatcher,za=f.ReactCurrentOwner,ls=f.ReactCurrentBatchConfig,Pt=0,xr=null,dr=null,Rr=0,Zr=0,Kn=Vs(0),vr=0,Ci=null,wn=0,uo=0,$a=0,ki=null,Vr=null,Ua=0,qn=1/0,zs=null,ho=!1,Wa=null,Zs=null,fo=!1,en=null,po=0,bi=0,Ka=null,mo=-1,_o=0;function Or(){return(Pt&6)!==0?te():mo!==-1?mo:mo=te()}function tn(e){return(e.mode&1)===0?1:(Pt&2)!==0&&Rr!==0?Rr&-Rr:gd.transition!==null?(_o===0&&(_o=ke()),_o):(e=Me,e!==0||(e=window.event,e=e===void 0?16:ei(e.type)),e)}function ws(e,t,r,s){if(50<bi)throw bi=0,Ka=null,Error(T(185));ot(e,r,s),((Pt&2)===0||e!==xr)&&(e===xr&&((Pt&2)===0&&(uo|=r),vr===4&&rn(e,Rr)),Gr(e,s),r===1&&Pt===0&&(t.mode&1)===0&&(qn=te()+500,Ui&&Ys()))}function Gr(e,t){var r=e.callbackNode;ae(e,t);var s=Ve(e,e===xr?Rr:0);if(s===0)r!==null&&ds(r),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(r!=null&&ds(r),t===1)e.tag===0?_d(yu.bind(null,e)):nc(yu.bind(null,e)),dd(function(){(Pt&6)===0&&Ys()}),r=null;else{switch(It(s)){case 1:r=pe;break;case 4:r=ue;break;case 16:r=ge;break;case 536870912:r=Ie;break;default:r=ge}r=Pu(r,vu.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function vu(e,t){if(mo=-1,_o=0,(Pt&6)!==0)throw Error(T(327));var r=e.callbackNode;if(Vn()&&e.callbackNode!==r)return null;var s=Ve(e,e===xr?Rr:0);if(s===0)return null;if((s&30)!==0||(s&e.expiredLanes)!==0||t)t=go(e,s);else{t=s;var l=Pt;Pt|=2;var m=Su();(xr!==e||Rr!==t)&&(zs=null,qn=te()+500,xn(e,t));do try{Id();break}catch(z){wu(e,z)}while(!0);ca(),co.current=m,Pt=l,dr!==null?t=0:(xr=null,Rr=0,t=vr)}if(t!==0){if(t===2&&(l=be(e),l!==0&&(s=l,t=qa(e,l))),t===1)throw r=Ci,xn(e,0),rn(e,s),Gr(e,te()),r;if(t===6)rn(e,s);else{if(l=e.current.alternate,(s&30)===0&&!jd(l)&&(t=go(e,s),t===2&&(m=be(e),m!==0&&(s=m,t=qa(e,m))),t===1))throw r=Ci,xn(e,0),rn(e,s),Gr(e,te()),r;switch(e.finishedWork=l,e.finishedLanes=s,t){case 0:case 1:throw Error(T(345));case 2:Cn(e,Vr,zs);break;case 3:if(rn(e,s),(s&130023424)===s&&(t=Ua+500-te(),10<t)){if(Ve(e,0)!==0)break;if(l=e.suspendedLanes,(l&s)!==s){Or(),e.pingedLanes|=e.suspendedLanes&l;break}e.timeoutHandle=Jo(Cn.bind(null,e,Vr,zs),t);break}Cn(e,Vr,zs);break;case 4:if(rn(e,s),(s&4194240)===s)break;for(t=e.eventTimes,l=-1;0<s;){var L=31-Fe(s);m=1<<L,L=t[L],L>l&&(l=L),s&=~m}if(s=l,s=te()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*Md(s/1960))-s,10<s){e.timeoutHandle=Jo(Cn.bind(null,e,Vr,zs),s);break}Cn(e,Vr,zs);break;case 5:Cn(e,Vr,zs);break;default:throw Error(T(329))}}}return Gr(e,te()),e.callbackNode===r?vu.bind(null,e):null}function qa(e,t){var r=ki;return e.current.memoizedState.isDehydrated&&(xn(e,t).flags|=256),e=go(e,t),e!==2&&(t=Vr,Vr=r,t!==null&&Va(t)),e}function Va(e){Vr===null?Vr=e:Vr.push.apply(Vr,e)}function jd(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var l=r[s],m=l.getSnapshot;l=l.value;try{if(!ms(m(),l))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function rn(e,t){for(t&=~$a,t&=~uo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Fe(t),s=1<<r;e[r]=-1,t&=~s}}function yu(e){if((Pt&6)!==0)throw Error(T(327));Vn();var t=Ve(e,0);if((t&1)===0)return Gr(e,te()),null;var r=go(e,t);if(e.tag!==0&&r===2){var s=be(e);s!==0&&(t=s,r=qa(e,s))}if(r===1)throw r=Ci,xn(e,0),rn(e,t),Gr(e,te()),r;if(r===6)throw Error(T(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Cn(e,Vr,zs),Gr(e,te()),null}function Ga(e,t){var r=Pt;Pt|=1;try{return e(t)}finally{Pt=r,Pt===0&&(qn=te()+500,Ui&&Ys())}}function Sn(e){en!==null&&en.tag===0&&(Pt&6)===0&&Vn();var t=Pt;Pt|=1;var r=ls.transition,s=Me;try{if(ls.transition=null,Me=1,e)return e()}finally{Me=s,ls.transition=r,Pt=t,(Pt&6)===0&&Ys()}}function Ya(){Zr=Kn.current,Gt(Kn)}function xn(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,hd(r)),dr!==null)for(r=dr.return;r!==null;){var s=r;switch(na(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&zi();break;case 3:$n(),Gt(Wr),Gt(Tr),ga();break;case 5:ma(s);break;case 4:$n();break;case 13:Gt(tr);break;case 19:Gt(tr);break;case 10:ua(s.type._context);break;case 22:case 23:Ya()}r=r.return}if(xr=e,dr=e=sn(e.current,null),Rr=Zr=t,vr=0,Ci=null,$a=uo=wn=0,Vr=ki=null,gn!==null){for(t=0;t<gn.length;t++)if(r=gn[t],s=r.interleaved,s!==null){r.interleaved=null;var l=s.next,m=r.pending;if(m!==null){var L=m.next;m.next=l,s.next=L}r.pending=s}gn=null}return e}function wu(e,t){do{var r=dr;try{if(ca(),Zi.current=so,eo){for(var s=rr.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}eo=!1}if(yn=0,Sr=gr=rr=null,gi=!1,vi=0,za.current=null,r===null||r.return===null){vr=1,Ci=t,dr=null;break}e:{var m=e,L=r.return,z=r,K=t;if(t=Rr,z.flags|=32768,K!==null&&typeof K=="object"&&typeof K.then=="function"){var ce=K,we=z,Se=we.tag;if((we.mode&1)===0&&(Se===0||Se===11||Se===15)){var ye=we.alternate;ye?(we.updateQueue=ye.updateQueue,we.memoizedState=ye.memoizedState,we.lanes=ye.lanes):(we.updateQueue=null,we.memoizedState=null)}var Le=Kc(L);if(Le!==null){Le.flags&=-257,qc(Le,L,z,m,t),Le.mode&1&&Wc(m,ce,t),t=Le,K=ce;var Be=t.updateQueue;if(Be===null){var ze=new Set;ze.add(K),t.updateQueue=ze}else Be.add(K);break e}else{if((t&1)===0){Wc(m,ce,t),Xa();break e}K=Error(T(426))}}else if(Xt&&z.mode&1){var cr=Kc(L);if(cr!==null){(cr.flags&65536)===0&&(cr.flags|=256),qc(cr,L,z,m,t),aa(Un(K,z));break e}}m=K=Un(K,z),vr!==4&&(vr=2),ki===null?ki=[m]:ki.push(m),m=L;do{switch(m.tag){case 3:m.flags|=65536,t&=-t,m.lanes|=t;var re=$c(m,K,t);mc(m,re);break e;case 1:z=K;var V=m.type,ne=m.stateNode;if((m.flags&128)===0&&(typeof V.getDerivedStateFromError=="function"||ne!==null&&typeof ne.componentDidCatch=="function"&&(Zs===null||!Zs.has(ne)))){m.flags|=65536,t&=-t,m.lanes|=t;var Ee=Uc(m,z,t);mc(m,Ee);break e}}m=m.return}while(m!==null)}Cu(r)}catch(We){t=We,dr===r&&r!==null&&(dr=r=r.return);continue}break}while(!0)}function Su(){var e=co.current;return co.current=so,e===null?so:e}function Xa(){(vr===0||vr===3||vr===2)&&(vr=4),xr===null||(wn&268435455)===0&&(uo&268435455)===0||rn(xr,Rr)}function go(e,t){var r=Pt;Pt|=2;var s=Su();(xr!==e||Rr!==t)&&(zs=null,xn(e,t));do try{Bd();break}catch(l){wu(e,l)}while(!0);if(ca(),Pt=r,co.current=s,dr!==null)throw Error(T(261));return xr=null,Rr=0,vr}function Bd(){for(;dr!==null;)xu(dr)}function Id(){for(;dr!==null&&!X();)xu(dr)}function xu(e){var t=Eu(e.alternate,e,Zr);e.memoizedProps=e.pendingProps,t===null?Cu(e):dr=t,za.current=null}function Cu(e){var t=e;do{var r=t.alternate;if(e=t.return,(t.flags&32768)===0){if(r=Ad(r,t,Zr),r!==null){dr=r;return}}else{if(r=Td(r,t),r!==null){r.flags&=32767,dr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{vr=6,dr=null;return}}if(t=t.sibling,t!==null){dr=t;return}dr=t=e}while(t!==null);vr===0&&(vr=5)}function Cn(e,t,r){var s=Me,l=ls.transition;try{ls.transition=null,Me=1,Od(e,t,r,s)}finally{ls.transition=l,Me=s}return null}function Od(e,t,r,s){do Vn();while(en!==null);if((Pt&6)!==0)throw Error(T(327));r=e.finishedWork;var l=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(T(177));e.callbackNode=null,e.callbackPriority=0;var m=r.lanes|r.childLanes;if(lt(e,m),e===xr&&(dr=xr=null,Rr=0),(r.subtreeFlags&2064)===0&&(r.flags&2064)===0||fo||(fo=!0,Pu(ge,function(){return Vn(),null})),m=(r.flags&15990)!==0,(r.subtreeFlags&15990)!==0||m){m=ls.transition,ls.transition=null;var L=Me;Me=1;var z=Pt;Pt|=4,za.current=null,Dd(e,r),fu(r,e),nd(Xo),bs=!!Yo,Xo=Yo=null,e.current=r,Nd(r),se(),Pt=z,Me=L,ls.transition=m}else e.current=r;if(fo&&(fo=!1,en=e,po=l),m=e.pendingLanes,m===0&&(Zs=null),Ne(r.stateNode),Gr(e,te()),t!==null)for(s=e.onRecoverableError,r=0;r<t.length;r++)l=t[r],s(l.value,{componentStack:l.stack,digest:l.digest});if(ho)throw ho=!1,e=Wa,Wa=null,e;return(po&1)!==0&&e.tag!==0&&Vn(),m=e.pendingLanes,(m&1)!==0?e===Ka?bi++:(bi=0,Ka=e):bi=0,Ys(),null}function Vn(){if(en!==null){var e=It(po),t=ls.transition,r=Me;try{if(ls.transition=null,Me=16>e?16:e,en===null)var s=!1;else{if(e=en,en=null,po=0,(Pt&6)!==0)throw Error(T(331));var l=Pt;for(Pt|=4,je=e.current;je!==null;){var m=je,L=m.child;if((je.flags&16)!==0){var z=m.deletions;if(z!==null){for(var K=0;K<z.length;K++){var ce=z[K];for(je=ce;je!==null;){var we=je;switch(we.tag){case 0:case 11:case 15:xi(8,we,m)}var Se=we.child;if(Se!==null)Se.return=we,je=Se;else for(;je!==null;){we=je;var ye=we.sibling,Le=we.return;if(lu(we),we===ce){je=null;break}if(ye!==null){ye.return=Le,je=ye;break}je=Le}}}var Be=m.alternate;if(Be!==null){var ze=Be.child;if(ze!==null){Be.child=null;do{var cr=ze.sibling;ze.sibling=null,ze=cr}while(ze!==null)}}je=m}}if((m.subtreeFlags&2064)!==0&&L!==null)L.return=m,je=L;else e:for(;je!==null;){if(m=je,(m.flags&2048)!==0)switch(m.tag){case 0:case 11:case 15:xi(9,m,m.return)}var re=m.sibling;if(re!==null){re.return=m.return,je=re;break e}je=m.return}}var V=e.current;for(je=V;je!==null;){L=je;var ne=L.child;if((L.subtreeFlags&2064)!==0&&ne!==null)ne.return=L,je=ne;else e:for(L=V;je!==null;){if(z=je,(z.flags&2048)!==0)try{switch(z.tag){case 0:case 11:case 15:lo(9,z)}}catch(We){nr(z,z.return,We)}if(z===L){je=null;break e}var Ee=z.sibling;if(Ee!==null){Ee.return=z.return,je=Ee;break e}je=z.return}}if(Pt=l,Ys(),Te&&typeof Te.onPostCommitFiberRoot=="function")try{Te.onPostCommitFiberRoot(Ge,e)}catch{}s=!0}return s}finally{Me=r,ls.transition=t}}return!1}function ku(e,t,r){t=Un(r,t),t=$c(e,t,1),e=Qs(e,t,1),t=Or(),e!==null&&(ot(e,1,t),Gr(e,t))}function nr(e,t,r){if(e.tag===3)ku(e,e,r);else for(;t!==null;){if(t.tag===3){ku(t,e,r);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Zs===null||!Zs.has(s))){e=Un(r,e),e=Uc(t,e,1),t=Qs(t,e,1),e=Or(),t!==null&&(ot(t,1,e),Gr(t,e));break}}t=t.return}}function Fd(e,t,r){var s=e.pingCache;s!==null&&s.delete(t),t=Or(),e.pingedLanes|=e.suspendedLanes&r,xr===e&&(Rr&r)===r&&(vr===4||vr===3&&(Rr&130023424)===Rr&&500>te()-Ua?xn(e,0):$a|=r),Gr(e,t)}function bu(e,t){t===0&&((e.mode&1)===0?t=1:(t=_t,_t<<=1,(_t&130023424)===0&&(_t=4194304)));var r=Or();e=Os(e,t),e!==null&&(ot(e,t,r),Gr(e,r))}function Hd(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),bu(e,r)}function zd(e,t){var r=0;switch(e.tag){case 13:var s=e.stateNode,l=e.memoizedState;l!==null&&(r=l.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(T(314))}s!==null&&s.delete(t),bu(e,r)}var Eu;Eu=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Wr.current)qr=!0;else{if((e.lanes&r)===0&&(t.flags&128)===0)return qr=!1,Rd(e,t,r);qr=(e.flags&131072)!==0}else qr=!1,Xt&&(t.flags&1048576)!==0&&ic(t,Ki,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;oo(e,t),e=t.pendingProps;var l=jn(t,Tr.current);zn(t,r),l=wa(null,t,s,e,l,r);var m=Sa();return t.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Kr(s)?(m=!0,$i(t)):m=!1,t.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,fa(t),l.updater=no,t.stateNode=l,l._reactInternals=t,Pa(t,s,e,r),t=La(null,t,s,!0,m,r)):(t.tag=0,Xt&&m&&sa(t),Ir(null,t,l,r),t=t.child),t;case 16:s=t.elementType;e:{switch(oo(e,t),e=t.pendingProps,l=s._init,s=l(s._payload),t.type=s,l=t.tag=Ud(s),e=gs(s,e),l){case 0:t=Ta(null,t,s,e,r);break e;case 1:t=Jc(null,t,s,e,r);break e;case 11:t=Vc(null,t,s,e,r);break e;case 14:t=Gc(null,t,s,gs(s.type,e),r);break e}throw Error(T(306,s,""))}return t;case 0:return s=t.type,l=t.pendingProps,l=t.elementType===s?l:gs(s,l),Ta(e,t,s,l,r);case 1:return s=t.type,l=t.pendingProps,l=t.elementType===s?l:gs(s,l),Jc(e,t,s,l,r);case 3:e:{if(Zc(t),e===null)throw Error(T(387));s=t.pendingProps,m=t.memoizedState,l=m.element,pc(e,t),Qi(t,s,null,r);var L=t.memoizedState;if(s=L.element,m.isDehydrated)if(m={element:s,isDehydrated:!1,cache:L.cache,pendingSuspenseBoundaries:L.pendingSuspenseBoundaries,transitions:L.transitions},t.updateQueue.baseState=m,t.memoizedState=m,t.flags&256){l=Un(Error(T(423)),t),t=eu(e,t,s,r,l);break e}else if(s!==l){l=Un(Error(T(424)),t),t=eu(e,t,s,r,l);break e}else for(Jr=qs(t.stateNode.containerInfo.firstChild),Qr=t,Xt=!0,_s=null,r=dc(t,null,s,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(On(),s===l){t=Hs(e,t,r);break e}Ir(e,t,s,r)}t=t.child}return t;case 5:return gc(t),e===null&&oa(t),s=t.type,l=t.pendingProps,m=e!==null?e.memoizedProps:null,L=l.children,Qo(s,l)?L=null:m!==null&&Qo(s,m)&&(t.flags|=32),Qc(e,t),Ir(e,t,L,r),t.child;case 6:return e===null&&oa(t),null;case 13:return tu(e,t,r);case 4:return pa(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Fn(t,null,s,r):Ir(e,t,s,r),t.child;case 11:return s=t.type,l=t.pendingProps,l=t.elementType===s?l:gs(s,l),Vc(e,t,s,l,r);case 7:return Ir(e,t,t.pendingProps,r),t.child;case 8:return Ir(e,t,t.pendingProps.children,r),t.child;case 12:return Ir(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(s=t.type._context,l=t.pendingProps,m=t.memoizedProps,L=l.value,qt(Gi,s._currentValue),s._currentValue=L,m!==null)if(ms(m.value,L)){if(m.children===l.children&&!Wr.current){t=Hs(e,t,r);break e}}else for(m=t.child,m!==null&&(m.return=t);m!==null;){var z=m.dependencies;if(z!==null){L=m.child;for(var K=z.firstContext;K!==null;){if(K.context===s){if(m.tag===1){K=Fs(-1,r&-r),K.tag=2;var ce=m.updateQueue;if(ce!==null){ce=ce.shared;var we=ce.pending;we===null?K.next=K:(K.next=we.next,we.next=K),ce.pending=K}}m.lanes|=r,K=m.alternate,K!==null&&(K.lanes|=r),ha(m.return,r,t),z.lanes|=r;break}K=K.next}}else if(m.tag===10)L=m.type===t.type?null:m.child;else if(m.tag===18){if(L=m.return,L===null)throw Error(T(341));L.lanes|=r,z=L.alternate,z!==null&&(z.lanes|=r),ha(L,r,t),L=m.sibling}else L=m.child;if(L!==null)L.return=m;else for(L=m;L!==null;){if(L===t){L=null;break}if(m=L.sibling,m!==null){m.return=L.return,L=m;break}L=L.return}m=L}Ir(e,t,l.children,r),t=t.child}return t;case 9:return l=t.type,s=t.pendingProps.children,zn(t,r),l=os(l),s=s(l),t.flags|=1,Ir(e,t,s,r),t.child;case 14:return s=t.type,l=gs(s,t.pendingProps),l=gs(s.type,l),Gc(e,t,s,l,r);case 15:return Yc(e,t,t.type,t.pendingProps,r);case 17:return s=t.type,l=t.pendingProps,l=t.elementType===s?l:gs(s,l),oo(e,t),t.tag=1,Kr(s)?(e=!0,$i(t)):e=!1,zn(t,r),Hc(t,s,l),Pa(t,s,l,r),La(null,t,s,!0,e,r);case 19:return su(e,t,r);case 22:return Xc(e,t,r)}throw Error(T(156,t.tag))};function Pu(e,t){return pr(e,t)}function $d(e,t,r,s){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cs(e,t,r,s){return new $d(e,t,r,s)}function Qa(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ud(e){if(typeof e=="function")return Qa(e)?1:0;if(e!=null){if(e=e.$$typeof,e===U)return 11;if(e===ie)return 14}return 2}function sn(e,t){var r=e.alternate;return r===null?(r=cs(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function vo(e,t,r,s,l,m){var L=2;if(s=e,typeof e=="function")Qa(e)&&(L=1);else if(typeof e=="string")L=5;else e:switch(e){case E:return kn(r.children,l,m,t);case y:L=8,l|=8;break;case P:return e=cs(12,r,t,l|2),e.elementType=P,e.lanes=m,e;case B:return e=cs(13,r,t,l),e.elementType=B,e.lanes=m,e;case J:return e=cs(19,r,t,l),e.elementType=J,e.lanes=m,e;case _e:return yo(r,l,m,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case O:L=10;break e;case F:L=9;break e;case U:L=11;break e;case ie:L=14;break e;case fe:L=16,s=null;break e}throw Error(T(130,e==null?e:typeof e,""))}return t=cs(L,r,t,l),t.elementType=e,t.type=s,t.lanes=m,t}function kn(e,t,r,s){return e=cs(7,e,s,t),e.lanes=r,e}function yo(e,t,r,s){return e=cs(22,e,s,t),e.elementType=_e,e.lanes=r,e.stateNode={isHidden:!1},e}function Ja(e,t,r){return e=cs(6,e,null,t),e.lanes=r,e}function Za(e,t,r){return t=cs(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Wd(e,t,r,s,l){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=He(0),this.expirationTimes=He(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=He(0),this.identifierPrefix=s,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function el(e,t,r,s,l,m,L,z,K){return e=new Wd(e,t,r,z,K),t===1?(t=1,m===!0&&(t|=8)):t=0,m=cs(3,null,null,t),e.current=m,m.stateNode=e,m.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},fa(m),e}function Kd(e,t,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:C,key:s==null?null:""+s,children:e,containerInfo:t,implementation:r}}function Ru(e){if(!e)return Gs;e=e._reactInternals;e:{if(hr(e)!==e||e.tag!==1)throw Error(T(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Kr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(T(171))}if(e.tag===1){var r=e.type;if(Kr(r))return rc(e,r,t)}return t}function Au(e,t,r,s,l,m,L,z,K){return e=el(r,s,!0,e,l,m,L,z,K),e.context=Ru(null),r=e.current,s=Or(),l=tn(r),m=Fs(s,l),m.callback=t??null,Qs(r,m,l),e.current.lanes=l,ot(e,l,s),Gr(e,s),e}function wo(e,t,r,s){var l=t.current,m=Or(),L=tn(l);return r=Ru(r),t.context===null?t.context=r:t.pendingContext=r,t=Fs(m,L),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=Qs(l,t,L),e!==null&&(ws(e,l,L,m),Xi(e,l,L)),L}function So(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Tu(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function tl(e,t){Tu(e,t),(e=e.alternate)&&Tu(e,t)}function qd(){return null}var Lu=typeof reportError=="function"?reportError:function(e){console.error(e)};function rl(e){this._internalRoot=e}xo.prototype.render=rl.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(T(409));wo(e,t,null,null)},xo.prototype.unmount=rl.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Sn(function(){wo(null,e,null,null)}),t[Ms]=null}};function xo(e){this._internalRoot=e}xo.prototype.unstable_scheduleHydration=function(e){if(e){var t=jr();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Kt.length&&t!==0&&t<Kt[r].priority;r++);Kt.splice(r,0,e),r===0&&_r(e)}};function sl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Co(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Du(){}function Vd(e,t,r,s,l){if(l){if(typeof s=="function"){var m=s;s=function(){var ce=So(L);m.call(ce)}}var L=Au(t,s,e,0,null,!1,!1,"",Du);return e._reactRootContainer=L,e[Ms]=L.current,ci(e.nodeType===8?e.parentNode:e),Sn(),L}for(;l=e.lastChild;)e.removeChild(l);if(typeof s=="function"){var z=s;s=function(){var ce=So(K);z.call(ce)}}var K=el(e,0,!1,null,null,!1,!1,"",Du);return e._reactRootContainer=K,e[Ms]=K.current,ci(e.nodeType===8?e.parentNode:e),Sn(function(){wo(t,K,r,s)}),K}function ko(e,t,r,s,l){var m=r._reactRootContainer;if(m){var L=m;if(typeof l=="function"){var z=l;l=function(){var K=So(L);z.call(K)}}wo(t,L,e,l)}else L=Vd(r,t,e,l,s);return So(L)}Ot=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=wt(t.pendingLanes);r!==0&&(Je(t,r|1),Gr(t,te()),(Pt&6)===0&&(qn=te()+500,Ys()))}break;case 13:Sn(function(){var s=Os(e,1);if(s!==null){var l=Or();ws(s,e,1,l)}}),tl(e,1)}},Zt=function(e){if(e.tag===13){var t=Os(e,134217728);if(t!==null){var r=Or();ws(t,e,134217728,r)}tl(e,134217728)}},mr=function(e){if(e.tag===13){var t=tn(e),r=Os(e,t);if(r!==null){var s=Or();ws(r,e,t,s)}tl(e,t)}},jr=function(){return Me},fs=function(e,t){var r=Me;try{return Me=e,t()}finally{Me=r}},Fr=function(e,t,r){switch(t){case"input":if(Ae(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var s=r[t];if(s!==e&&s.form===e.form){var l=Hi(s);if(!l)throw Error(T(90));Ce(s),Ae(s,l)}}}break;case"textarea":ir(e,r);break;case"select":t=r.value,t!=null&&kt(e,!!r.multiple,t,!1)}},Ls=Ga,hs=Sn;var Gd={usingClientEntryPoint:!1,Events:[di,Nn,Hi,Hr,jt,Ga]},Ei={findFiberByHostInstance:fn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Yd={bundleType:Ei.bundleType,version:Ei.version,rendererPackageName:Ei.rendererPackageName,rendererConfig:Ei.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:f.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ur(e),e===null?null:e.stateNode},findFiberByHostInstance:Ei.findFiberByHostInstance||qd,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bo=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bo.isDisabled&&bo.supportsFiber)try{Ge=bo.inject(Yd),Te=bo}catch{}}return Yr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Gd,Yr.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sl(t))throw Error(T(200));return Kd(e,t,null,r)},Yr.createRoot=function(e,t){if(!sl(e))throw Error(T(299));var r=!1,s="",l=Lu;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(l=t.onRecoverableError)),t=el(e,1,!1,null,null,r,!1,s,l),e[Ms]=t.current,ci(e.nodeType===8?e.parentNode:e),new rl(t)},Yr.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(T(188)):(e=Object.keys(e).join(","),Error(T(268,e)));return e=Ur(t),e=e===null?null:e.stateNode,e},Yr.flushSync=function(e){return Sn(e)},Yr.hydrate=function(e,t,r){if(!Co(t))throw Error(T(200));return ko(null,e,t,!0,r)},Yr.hydrateRoot=function(e,t,r){if(!sl(e))throw Error(T(405));var s=r!=null&&r.hydratedSources||null,l=!1,m="",L=Lu;if(r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(m=r.identifierPrefix),r.onRecoverableError!==void 0&&(L=r.onRecoverableError)),t=Au(t,null,e,1,r??null,l,!1,m,L),e[Ms]=t.current,ci(e),s)for(e=0;e<s.length;e++)r=s[e],l=r._getVersion,l=l(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,l]:t.mutableSourceEagerHydrationData.push(r,l);return new xo(t)},Yr.render=function(e,t,r){if(!Co(t))throw Error(T(200));return ko(null,e,t,!1,r)},Yr.unmountComponentAtNode=function(e){if(!Co(e))throw Error(T(40));return e._reactRootContainer?(Sn(function(){ko(null,null,e,!1,function(){e._reactRootContainer=null,e[Ms]=null})}),!0):!1},Yr.unstable_batchedUpdates=Ga,Yr.unstable_renderSubtreeIntoContainer=function(e,t,r,s){if(!Co(r))throw Error(T(200));if(e==null||e._reactInternals===void 0)throw Error(T(38));return ko(e,t,r,!1,s)},Yr.version="18.3.1-next-f1338f8080-20240426",Yr}var Hu;function sf(){if(Hu)return ol.exports;Hu=1;function p(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(p)}catch(b){console.error(b)}}return p(),ol.exports=rf(),ol.exports}var zu;function nf(){if(zu)return Eo;zu=1;var p=sf();return Eo.createRoot=p.createRoot,Eo.hydrateRoot=p.hydrateRoot,Eo}var of=nf();const af=ch(of);var N=wl();const lf=ch(N);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cf=p=>p.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),uh=(...p)=>p.filter((b,T,I)=>!!b&&I.indexOf(b)===T).join(" ");/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var uf={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hf=N.forwardRef(({color:p="currentColor",size:b=24,strokeWidth:T=2,absoluteStrokeWidth:I,className:$="",children:G,iconNode:q,...c},u)=>N.createElement("svg",{ref:u,...uf,width:b,height:b,stroke:p,strokeWidth:I?Number(T)*24/Number(b):T,className:uh("lucide",$),...c},[...q.map(([g,x])=>N.createElement(g,x)),...Array.isArray(G)?G:[G]]));/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=(p,b)=>{const T=N.forwardRef(({className:I,...$},G)=>N.createElement(hf,{ref:G,iconNode:b,className:uh(`lucide-${cf(p)}`,I),...$}));return T.displayName=`${p}`,T};/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const df=Lt("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ff=Lt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pf=Lt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mf=Lt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _f=Lt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sl=Lt("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gf=Lt("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vf=Lt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yf=Lt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wf=Lt("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sf=Lt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xf=Lt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cf=Lt("FilePen",[["path",{d:"M12 22h6a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v10",key:"x7tsz2"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10.4 12.6a2 2 0 1 1 3 3L8 21l-4 1 1-4Z",key:"o3xyfb"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kf=Lt("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bf=Lt("FolderTree",[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hh=Lt("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dh=Lt("GitMerge",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ef=Lt("GitPullRequest",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pf=Lt("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rf=Lt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Af=Lt("MessageSquareWarning",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v2",key:"stiyo7"}],["path",{d:"M12 13h.01",key:"y0uutt"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tf=Lt("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lf=Lt("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Df=Lt("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vl=Lt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nf=Lt("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mf=Lt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jf=Lt("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bf=Lt("SquareTerminal",[["path",{d:"m7 11 2-2-2-2",key:"1lz0vl"}],["path",{d:"M11 13h4",key:"1p7l4v"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ti=Lt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=Lt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const No=Lt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Gn=p=>Number.isFinite(p)?p<1e3?`${Math.round(p)}`:p<1e6?`${(p/1e3).toFixed(p<1e4?1:0)}k`:`${(p/1e6).toFixed(1)}m`:"n/a",If=p=>Number.isFinite(p)?Math.max(0,Math.min(100,p)):0,cl=p=>Number.isFinite(p)?p<.01?`$${p.toFixed(4)}`:`$${p.toFixed(2)}`:"$0.00",fh=p=>{if(!p)return null;if(typeof p.contextTokens=="number"&&typeof p.contextWindow=="number"&&p.contextWindow>0){const b=If(p.contextTokens/p.contextWindow*100);return`Context ${Gn(p.contextTokens)}/${Gn(p.contextWindow)} (${b.toFixed(1)}%)`}if(typeof p.contextTokens=="number")return`Context ${Gn(p.contextTokens)}`;if(typeof p.totalTokens=="number")return`Tokens ${Gn(p.totalTokens)}`;if(typeof p.promptTokens=="number"||typeof p.completionTokens=="number"){const b=typeof p.promptTokens=="number"?Gn(p.promptTokens):"-",T=typeof p.completionTokens=="number"?Gn(p.completionTokens):"-";return`Input ${b} Output ${T}`}return null},Of=p=>{if(!p)return null;if(typeof p.costUsd=="number")return`Cost ${cl(p.costUsd)}`;if(typeof p.promptCostUsd=="number"||typeof p.completionCostUsd=="number"){const b=typeof p.promptCostUsd=="number"?cl(p.promptCostUsd):"-",T=typeof p.completionCostUsd=="number"?cl(p.completionCostUsd):"-";return`Cost input ${b} output ${T}`}return null},Ff=({tabs:p,activeTab:b,statuses:T,usageByTask:I,width:$,repoWebUrl:G,onSelectTab:q,onOpenRepo:c,onNewTask:u,onDeleteTask:g,onRenameTask:x})=>{const h=$<220,[v,w]=N.useState(null),[k,_]=N.useState(""),o=N.useRef(null),a=S=>S.isReady?S.isBlocked?"Blocked":S.hasCollision?"Collision":S.isDirty?"Dirty":"Clean":"Provisioning",n=N.useCallback(()=>{w(null),_("")},[]),i=N.useCallback((S,C,E)=>{if(E==null||E.preventDefault(),E==null||E.stopPropagation(),h){const y=window.prompt("Rename session",C);if(y===null)return;x(S,y);return}w(S),_(C)},[h,x]),f=N.useCallback(S=>{x(S,k),n()},[n,k,x]);return N.useEffect(()=>{v&&(p.some(S=>S.id===v)||n())},[p,v,n]),N.useEffect(()=>{if(!v)return;const S=requestAnimationFrame(()=>{var C,E;(C=o.current)==null||C.focus(),(E=o.current)==null||E.select()});return()=>cancelAnimationFrame(S)},[v]),d.jsxs("aside",{style:{width:$},className:"shrink-0 app-panel m-2 mr-0 rounded-xl flex flex-col h-[calc(100vh-1rem)] z-10 overflow-hidden min-w-0",children:[d.jsx("div",{className:"px-3 py-2.5 border-b border-[var(--panel-border)]",children:d.jsxs("div",{className:`flex items-center gap-2 ${h?"justify-center":""}`,children:[d.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[d.jsx(Bf,{size:16,className:"text-[var(--text-primary)] shrink-0"}),!h&&d.jsx("h1",{className:"text-xs font-bold text-[var(--text-primary)] tracking-[0.2em] uppercase truncate",children:"Sessions"})]}),d.jsxs("button",{type:"button",onClick:c,title:G?`Open repository in browser: ${G}`:"No repository remote URL available",className:`btn-ghost shrink-0 rounded px-2 py-1 text-[10px] font-mono uppercase tracking-wide ${G?"text-[var(--text-secondary)]":"text-[var(--text-muted)]"}`,children:[d.jsx(Sf,{size:10}),!h&&d.jsx("span",{children:"Repo"})]})]})}),d.jsx("div",{className:"flex-1 overflow-y-auto p-2",children:d.jsxs("div",{className:"space-y-1.5",children:[p.map(S=>{const C=T[S.id]||{isReady:!1,isDirty:!1,hasCollision:!1,isBlocked:!1},E=I[S.id],y=fh(E),P=b===S.id,O=Array.isArray(S.tags)?S.tags:[];return d.jsx("div",{onClick:()=>{v!==S.id&&q(S.id)},className:`group relative rounded-md px-2.5 py-2 cursor-pointer transition-colors border ${P?"border-[var(--input-border-focus)] bg-[var(--panel-strong)]":"border-transparent hover:border-[var(--panel-border)] hover:bg-[var(--panel-subtle)]"}`,children:d.jsxs("div",{className:"flex items-start gap-2",children:[d.jsxs("div",{className:"relative flex-shrink-0 flex items-center justify-center w-5 h-5 mt-0.5",title:`Session state: ${a(C)}`,children:[C.isReady?C.isBlocked?d.jsx(Af,{className:"text-red-500",size:13}):C.hasCollision?d.jsx(Us,{className:"text-yellow-500",size:13}):C.isDirty?d.jsx(Cf,{className:"text-blue-400",size:13}):d.jsx(Sl,{className:"text-emerald-500",size:13}):d.jsx(Rf,{className:"text-[var(--text-muted)] animate-spin",size:13}),C.isBlocked&&d.jsx("div",{className:"absolute -top-0.5 -right-0.5 w-1.5 h-1.5 bg-red-500 rounded-full animate-ping"})]}),!h&&d.jsxs("div",{className:"min-w-0 flex-1",children:[v===S.id?d.jsx("input",{ref:F=>{o.current=F},value:k,onChange:F=>_(F.target.value),onClick:F=>F.stopPropagation(),onKeyDown:F=>{if(F.key==="Enter"){F.preventDefault(),f(S.id);return}F.key==="Escape"&&(F.preventDefault(),n())},onBlur:()=>f(S.id),className:"input-stealth rounded px-2 py-1 text-[12px] font-mono text-[var(--text-primary)] w-full",maxLength:72,"aria-label":`Rename session ${S.name}`}):d.jsx("div",{className:`text-[13px] font-semibold truncate ${C.isBlocked?"text-red-400":P?"text-[var(--text-primary)]":"text-[var(--text-secondary)] group-hover:text-[var(--text-primary)]"}`,onDoubleClick:F=>i(S.id,S.name,F),title:"Double-click to rename session",children:S.name}),d.jsxs("div",{className:"mt-1 flex items-center gap-1.5 flex-wrap",children:[d.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded border border-[var(--panel-border)] bg-[var(--panel-subtle)] text-[var(--text-primary)] uppercase tracking-[0.12em] font-mono truncate",title:`Agent command: ${S.agent}`,children:S.agent}),P&&y&&d.jsx("span",{className:"text-[9px] text-[var(--text-muted)] uppercase tracking-[0.08em] font-mono truncate",children:y})]}),O.length>0&&d.jsxs("div",{className:"mt-1 flex items-center gap-1 flex-wrap",children:[O.slice(0,3).map(F=>d.jsxs("span",{className:"text-[9px] px-1.5 py-0.5 rounded border border-[var(--panel-border)] bg-[var(--panel-subtle)] text-[var(--text-secondary)] font-mono",title:`Tag: ${F}`,children:["#",F]},`${S.id}-tag-${F}`)),O.length>3&&d.jsxs("span",{className:"text-[9px] text-[var(--text-muted)] font-mono",children:["+",O.length-3]})]})]}),d.jsxs("div",{className:`flex items-center gap-1 ${P?"opacity-100":"opacity-0 group-hover:opacity-100"} transition-opacity`,children:[!h&&d.jsx("button",{onClick:F=>i(S.id,S.name,F),className:"btn-ghost btn-icon-sm rounded text-[var(--text-muted)] hover:text-[var(--text-primary)]",title:`Rename ${S.name}`,children:d.jsx(Lf,{size:12})}),d.jsx("button",{onClick:F=>{F.stopPropagation(),g(S.id)},className:"btn-danger btn-icon-sm rounded text-[var(--text-muted)] hover:text-red-100",title:`Delete ${S.name}`,children:d.jsx(Ti,{size:12})})]})]})},S.id)}),p.length===0&&d.jsx("div",{className:"rounded-md border border-dashed border-[var(--panel-border)] bg-[var(--panel)] px-3 py-4 text-[11px] text-[var(--text-tertiary)] font-mono text-center",children:"No sessions yet."})]})}),d.jsx("div",{className:"p-2 border-t border-[var(--panel-border)]",children:d.jsxs("button",{onClick:u,className:"w-full flex items-center justify-center p-2 rounded-md btn-primary text-[11px] uppercase tracking-[0.12em] gap-2",title:"Spawn agent",children:[d.jsx(vl,{size:12}),d.jsx("span",{children:h?"Spawn":"Spawn Agent"})]})})]})};var ul={exports:{}},$u;function Hf(){return $u||($u=1,(function(p,b){(function(T,I){p.exports=I()})(globalThis,(()=>(()=>{var T={4567:function(q,c,u){var g=this&&this.__decorate||function(n,i,f,S){var C,E=arguments.length,y=E<3?i:S===null?S=Object.getOwnPropertyDescriptor(i,f):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(n,i,f,S);else for(var P=n.length-1;P>=0;P--)(C=n[P])&&(y=(E<3?C(y):E>3?C(i,f,y):C(i,f))||y);return E>3&&y&&Object.defineProperty(i,f,y),y},x=this&&this.__param||function(n,i){return function(f,S){i(f,S,n)}};Object.defineProperty(c,"__esModule",{value:!0}),c.AccessibilityManager=void 0;const h=u(9042),v=u(9924),w=u(844),k=u(4725),_=u(2585),o=u(3656);let a=c.AccessibilityManager=class extends w.Disposable{constructor(n,i,f,S){super(),this._terminal=n,this._coreBrowserService=f,this._renderService=S,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let C=0;C<this._terminal.rows;C++)this._rowElements[C]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[C]);if(this._topBoundaryFocusListener=C=>this._handleBoundaryFocus(C,0),this._bottomBoundaryFocusListener=C=>this._handleBoundaryFocus(C,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new v.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize((C=>this._handleResize(C.rows)))),this.register(this._terminal.onRender((C=>this._refreshRows(C.start,C.end)))),this.register(this._terminal.onScroll((()=>this._refreshRows()))),this.register(this._terminal.onA11yChar((C=>this._handleChar(C)))),this.register(this._terminal.onLineFeed((()=>this._handleChar(`
`)))),this.register(this._terminal.onA11yTab((C=>this._handleTab(C)))),this.register(this._terminal.onKey((C=>this._handleKey(C.key)))),this.register(this._terminal.onBlur((()=>this._clearLiveRegion()))),this.register(this._renderService.onDimensionsChange((()=>this._refreshRowsDimensions()))),this.register((0,o.addDisposableDomListener)(document,"selectionchange",(()=>this._handleSelectionChange()))),this.register(this._coreBrowserService.onDprChange((()=>this._refreshRowsDimensions()))),this._refreshRows(),this.register((0,w.toDisposable)((()=>{this._accessibilityContainer.remove(),this._rowElements.length=0})))}_handleTab(n){for(let i=0;i<n;i++)this._handleChar(" ")}_handleChar(n){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==n&&(this._charsToAnnounce+=n):this._charsToAnnounce+=n,n===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=h.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(n){this._clearLiveRegion(),new RegExp("\\p{Control}","u").test(n)||this._charsToConsume.push(n)}_refreshRows(n,i){this._liveRegionDebouncer.refresh(n,i,this._terminal.rows)}_renderRows(n,i){const f=this._terminal.buffer,S=f.lines.length.toString();for(let C=n;C<=i;C++){const E=f.lines.get(f.ydisp+C),y=[],P=(E==null?void 0:E.translateToString(!0,void 0,void 0,y))||"",O=(f.ydisp+C+1).toString(),F=this._rowElements[C];F&&(P.length===0?(F.innerText="",this._rowColumns.set(F,[0,1])):(F.textContent=P,this._rowColumns.set(F,y)),F.setAttribute("aria-posinset",O),F.setAttribute("aria-setsize",S))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(n,i){const f=n.target,S=this._rowElements[i===0?1:this._rowElements.length-2];if(f.getAttribute("aria-posinset")===(i===0?"1":`${this._terminal.buffer.lines.length}`)||n.relatedTarget!==S)return;let C,E;if(i===0?(C=f,E=this._rowElements.pop(),this._rowContainer.removeChild(E)):(C=this._rowElements.shift(),E=f,this._rowContainer.removeChild(C)),C.removeEventListener("focus",this._topBoundaryFocusListener),E.removeEventListener("focus",this._bottomBoundaryFocusListener),i===0){const y=this._createAccessibilityTreeNode();this._rowElements.unshift(y),this._rowContainer.insertAdjacentElement("afterbegin",y)}else{const y=this._createAccessibilityTreeNode();this._rowElements.push(y),this._rowContainer.appendChild(y)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(i===0?-1:1),this._rowElements[i===0?1:this._rowElements.length-2].focus(),n.preventDefault(),n.stopImmediatePropagation()}_handleSelectionChange(){var P;if(this._rowElements.length===0)return;const n=document.getSelection();if(!n)return;if(n.isCollapsed)return void(this._rowContainer.contains(n.anchorNode)&&this._terminal.clearSelection());if(!n.anchorNode||!n.focusNode)return void console.error("anchorNode and/or focusNode are null");let i={node:n.anchorNode,offset:n.anchorOffset},f={node:n.focusNode,offset:n.focusOffset};if((i.node.compareDocumentPosition(f.node)&Node.DOCUMENT_POSITION_PRECEDING||i.node===f.node&&i.offset>f.offset)&&([i,f]=[f,i]),i.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(i={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(i.node))return;const S=this._rowElements.slice(-1)[0];if(f.node.compareDocumentPosition(S)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(f={node:S,offset:((P=S.textContent)==null?void 0:P.length)??0}),!this._rowContainer.contains(f.node))return;const C=({node:O,offset:F})=>{const U=O instanceof Text?O.parentNode:O;let B=parseInt(U==null?void 0:U.getAttribute("aria-posinset"),10)-1;if(isNaN(B))return console.warn("row is invalid. Race condition?"),null;const J=this._rowColumns.get(U);if(!J)return console.warn("columns is null. Race condition?"),null;let ie=F<J.length?J[F]:J.slice(-1)[0]+1;return ie>=this._terminal.cols&&(++B,ie=0),{row:B,column:ie}},E=C(i),y=C(f);if(E&&y){if(E.row>y.row||E.row===y.row&&E.column>=y.column)throw new Error("invalid range");this._terminal.select(E.column,E.row,(y.row-E.row)*this._terminal.cols-E.column+y.column)}}_handleResize(n){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let i=this._rowContainer.children.length;i<this._terminal.rows;i++)this._rowElements[i]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[i]);for(;this._rowElements.length>n;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const n=this._coreBrowserService.mainDocument.createElement("div");return n.setAttribute("role","listitem"),n.tabIndex=-1,this._refreshRowDimensions(n),n}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let n=0;n<this._terminal.rows;n++)this._refreshRowDimensions(this._rowElements[n])}}_refreshRowDimensions(n){n.style.height=`${this._renderService.dimensions.css.cell.height}px`}};c.AccessibilityManager=a=g([x(1,_.IInstantiationService),x(2,k.ICoreBrowserService),x(3,k.IRenderService)],a)},3614:(q,c)=>{function u(v){return v.replace(/\r?\n/g,"\r")}function g(v,w){return w?"\x1B[200~"+v+"\x1B[201~":v}function x(v,w,k,_){v=g(v=u(v),k.decPrivateModes.bracketedPasteMode&&_.rawOptions.ignoreBracketedPasteMode!==!0),k.triggerDataEvent(v,!0),w.value=""}function h(v,w,k){const _=k.getBoundingClientRect(),o=v.clientX-_.left-10,a=v.clientY-_.top-10;w.style.width="20px",w.style.height="20px",w.style.left=`${o}px`,w.style.top=`${a}px`,w.style.zIndex="1000",w.focus()}Object.defineProperty(c,"__esModule",{value:!0}),c.rightClickHandler=c.moveTextAreaUnderMouseCursor=c.paste=c.handlePasteEvent=c.copyHandler=c.bracketTextForPaste=c.prepareTextForTerminal=void 0,c.prepareTextForTerminal=u,c.bracketTextForPaste=g,c.copyHandler=function(v,w){v.clipboardData&&v.clipboardData.setData("text/plain",w.selectionText),v.preventDefault()},c.handlePasteEvent=function(v,w,k,_){v.stopPropagation(),v.clipboardData&&x(v.clipboardData.getData("text/plain"),w,k,_)},c.paste=x,c.moveTextAreaUnderMouseCursor=h,c.rightClickHandler=function(v,w,k,_,o){h(v,w,k),o&&_.rightClickSelect(v),w.value=_.selectionText,w.select()}},7239:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ColorContrastCache=void 0;const g=u(1505);c.ColorContrastCache=class{constructor(){this._color=new g.TwoKeyMap,this._css=new g.TwoKeyMap}setCss(x,h,v){this._css.set(x,h,v)}getCss(x,h){return this._css.get(x,h)}setColor(x,h,v){this._color.set(x,h,v)}getColor(x,h){return this._color.get(x,h)}clear(){this._color.clear(),this._css.clear()}}},3656:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.addDisposableDomListener=void 0,c.addDisposableDomListener=function(u,g,x,h){u.addEventListener(g,x,h);let v=!1;return{dispose:()=>{v||(v=!0,u.removeEventListener(g,x,h))}}}},3551:function(q,c,u){var g=this&&this.__decorate||function(a,n,i,f){var S,C=arguments.length,E=C<3?n:f===null?f=Object.getOwnPropertyDescriptor(n,i):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(a,n,i,f);else for(var y=a.length-1;y>=0;y--)(S=a[y])&&(E=(C<3?S(E):C>3?S(n,i,E):S(n,i))||E);return C>3&&E&&Object.defineProperty(n,i,E),E},x=this&&this.__param||function(a,n){return function(i,f){n(i,f,a)}};Object.defineProperty(c,"__esModule",{value:!0}),c.Linkifier=void 0;const h=u(3656),v=u(8460),w=u(844),k=u(2585),_=u(4725);let o=c.Linkifier=class extends w.Disposable{get currentLink(){return this._currentLink}constructor(a,n,i,f,S){super(),this._element=a,this._mouseService=n,this._renderService=i,this._bufferService=f,this._linkProviderService=S,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new v.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new v.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,w.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,w.toDisposable)((()=>{var C;this._lastMouseEvent=void 0,(C=this._activeProviderReplies)==null||C.clear()}))),this.register(this._bufferService.onResize((()=>{this._clearCurrentLink(),this._wasResized=!0}))),this.register((0,h.addDisposableDomListener)(this._element,"mouseleave",(()=>{this._isMouseOut=!0,this._clearCurrentLink()}))),this.register((0,h.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,h.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,h.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(a){this._lastMouseEvent=a;const n=this._positionFromMouseEvent(a,this._element,this._mouseService);if(!n)return;this._isMouseOut=!1;const i=a.composedPath();for(let f=0;f<i.length;f++){const S=i[f];if(S.classList.contains("xterm"))break;if(S.classList.contains("xterm-hover"))return}this._lastBufferCell&&n.x===this._lastBufferCell.x&&n.y===this._lastBufferCell.y||(this._handleHover(n),this._lastBufferCell=n)}_handleHover(a){if(this._activeLine!==a.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(a,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,a)||(this._clearCurrentLink(),this._askForLink(a,!0))}_askForLink(a,n){var f,S;this._activeProviderReplies&&n||((f=this._activeProviderReplies)==null||f.forEach((C=>{C==null||C.forEach((E=>{E.link.dispose&&E.link.dispose()}))})),this._activeProviderReplies=new Map,this._activeLine=a.y);let i=!1;for(const[C,E]of this._linkProviderService.linkProviders.entries())n?(S=this._activeProviderReplies)!=null&&S.get(C)&&(i=this._checkLinkProviderResult(C,a,i)):E.provideLinks(a.y,(y=>{var O,F;if(this._isMouseOut)return;const P=y==null?void 0:y.map((U=>({link:U})));(O=this._activeProviderReplies)==null||O.set(C,P),i=this._checkLinkProviderResult(C,a,i),((F=this._activeProviderReplies)==null?void 0:F.size)===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(a.y,this._activeProviderReplies)}))}_removeIntersectingLinks(a,n){const i=new Set;for(let f=0;f<n.size;f++){const S=n.get(f);if(S)for(let C=0;C<S.length;C++){const E=S[C],y=E.link.range.start.y<a?0:E.link.range.start.x,P=E.link.range.end.y>a?this._bufferService.cols:E.link.range.end.x;for(let O=y;O<=P;O++){if(i.has(O)){S.splice(C--,1);break}i.add(O)}}}}_checkLinkProviderResult(a,n,i){var C;if(!this._activeProviderReplies)return i;const f=this._activeProviderReplies.get(a);let S=!1;for(let E=0;E<a;E++)this._activeProviderReplies.has(E)&&!this._activeProviderReplies.get(E)||(S=!0);if(!S&&f){const E=f.find((y=>this._linkAtPosition(y.link,n)));E&&(i=!0,this._handleNewLink(E))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!i)for(let E=0;E<this._activeProviderReplies.size;E++){const y=(C=this._activeProviderReplies.get(E))==null?void 0:C.find((P=>this._linkAtPosition(P.link,n)));if(y){i=!0,this._handleNewLink(y);break}}return i}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(a){if(!this._currentLink)return;const n=this._positionFromMouseEvent(a,this._element,this._mouseService);n&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,n)&&this._currentLink.link.activate(a,this._currentLink.link.text)}_clearCurrentLink(a,n){this._currentLink&&this._lastMouseEvent&&(!a||!n||this._currentLink.link.range.start.y>=a&&this._currentLink.link.range.end.y<=n)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,w.disposeArray)(this._linkCacheDisposables))}_handleNewLink(a){if(!this._lastMouseEvent)return;const n=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);n&&this._linkAtPosition(a.link,n)&&(this._currentLink=a,this._currentLink.state={decorations:{underline:a.link.decorations===void 0||a.link.decorations.underline,pointerCursor:a.link.decorations===void 0||a.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,a.link,this._lastMouseEvent),a.link.decorations={},Object.defineProperties(a.link.decorations,{pointerCursor:{get:()=>{var i,f;return(f=(i=this._currentLink)==null?void 0:i.state)==null?void 0:f.decorations.pointerCursor},set:i=>{var f;(f=this._currentLink)!=null&&f.state&&this._currentLink.state.decorations.pointerCursor!==i&&(this._currentLink.state.decorations.pointerCursor=i,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",i))}},underline:{get:()=>{var i,f;return(f=(i=this._currentLink)==null?void 0:i.state)==null?void 0:f.decorations.underline},set:i=>{var f,S,C;(f=this._currentLink)!=null&&f.state&&((C=(S=this._currentLink)==null?void 0:S.state)==null?void 0:C.decorations.underline)!==i&&(this._currentLink.state.decorations.underline=i,this._currentLink.state.isHovered&&this._fireUnderlineEvent(a.link,i))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange((i=>{if(!this._currentLink)return;const f=i.start===0?0:i.start+1+this._bufferService.buffer.ydisp,S=this._bufferService.buffer.ydisp+1+i.end;if(this._currentLink.link.range.start.y>=f&&this._currentLink.link.range.end.y<=S&&(this._clearCurrentLink(f,S),this._lastMouseEvent)){const C=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);C&&this._askForLink(C,!1)}}))))}_linkHover(a,n,i){var f;(f=this._currentLink)!=null&&f.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(n,!0),this._currentLink.state.decorations.pointerCursor&&a.classList.add("xterm-cursor-pointer")),n.hover&&n.hover(i,n.text)}_fireUnderlineEvent(a,n){const i=a.range,f=this._bufferService.buffer.ydisp,S=this._createLinkUnderlineEvent(i.start.x-1,i.start.y-f-1,i.end.x,i.end.y-f-1,void 0);(n?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(S)}_linkLeave(a,n,i){var f;(f=this._currentLink)!=null&&f.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(n,!1),this._currentLink.state.decorations.pointerCursor&&a.classList.remove("xterm-cursor-pointer")),n.leave&&n.leave(i,n.text)}_linkAtPosition(a,n){const i=a.range.start.y*this._bufferService.cols+a.range.start.x,f=a.range.end.y*this._bufferService.cols+a.range.end.x,S=n.y*this._bufferService.cols+n.x;return i<=S&&S<=f}_positionFromMouseEvent(a,n,i){const f=i.getCoords(a,n,this._bufferService.cols,this._bufferService.rows);if(f)return{x:f[0],y:f[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(a,n,i,f,S){return{x1:a,y1:n,x2:i,y2:f,cols:this._bufferService.cols,fg:S}}};c.Linkifier=o=g([x(1,_.IMouseService),x(2,_.IRenderService),x(3,k.IBufferService),x(4,_.ILinkProviderService)],o)},9042:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.tooMuchOutput=c.promptLabel=void 0,c.promptLabel="Terminal input",c.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(q,c,u){var g=this&&this.__decorate||function(_,o,a,n){var i,f=arguments.length,S=f<3?o:n===null?n=Object.getOwnPropertyDescriptor(o,a):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(_,o,a,n);else for(var C=_.length-1;C>=0;C--)(i=_[C])&&(S=(f<3?i(S):f>3?i(o,a,S):i(o,a))||S);return f>3&&S&&Object.defineProperty(o,a,S),S},x=this&&this.__param||function(_,o){return function(a,n){o(a,n,_)}};Object.defineProperty(c,"__esModule",{value:!0}),c.OscLinkProvider=void 0;const h=u(511),v=u(2585);let w=c.OscLinkProvider=class{constructor(_,o,a){this._bufferService=_,this._optionsService=o,this._oscLinkService=a}provideLinks(_,o){var P;const a=this._bufferService.buffer.lines.get(_-1);if(!a)return void o(void 0);const n=[],i=this._optionsService.rawOptions.linkHandler,f=new h.CellData,S=a.getTrimmedLength();let C=-1,E=-1,y=!1;for(let O=0;O<S;O++)if(E!==-1||a.hasContent(O)){if(a.loadCell(O,f),f.hasExtendedAttrs()&&f.extended.urlId){if(E===-1){E=O,C=f.extended.urlId;continue}y=f.extended.urlId!==C}else E!==-1&&(y=!0);if(y||E!==-1&&O===S-1){const F=(P=this._oscLinkService.getLinkData(C))==null?void 0:P.uri;if(F){const U={start:{x:E+1,y:_},end:{x:O+(y||O!==S-1?0:1),y:_}};let B=!1;if(!(i!=null&&i.allowNonHttpProtocols))try{const J=new URL(F);["http:","https:"].includes(J.protocol)||(B=!0)}catch{B=!0}B||n.push({text:F,range:U,activate:(J,ie)=>i?i.activate(J,ie,U):k(0,ie),hover:(J,ie)=>{var fe;return(fe=i==null?void 0:i.hover)==null?void 0:fe.call(i,J,ie,U)},leave:(J,ie)=>{var fe;return(fe=i==null?void 0:i.leave)==null?void 0:fe.call(i,J,ie,U)}})}y=!1,f.hasExtendedAttrs()&&f.extended.urlId?(E=O,C=f.extended.urlId):(E=-1,C=-1)}}o(n)}};function k(_,o){if(confirm(`Do you want to navigate to ${o}?

WARNING: This link could potentially be dangerous`)){const a=window.open();if(a){try{a.opener=null}catch{}a.location.href=o}else console.warn("Opening link blocked as opener could not be cleared")}}c.OscLinkProvider=w=g([x(0,v.IBufferService),x(1,v.IOptionsService),x(2,v.IOscLinkService)],w)},6193:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.RenderDebouncer=void 0,c.RenderDebouncer=class{constructor(u,g){this._renderCallback=u,this._coreBrowserService=g,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(u){return this._refreshCallbacks.push(u),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._innerRefresh()))),this._animationFrame}refresh(u,g,x){this._rowCount=x,u=u!==void 0?u:0,g=g!==void 0?g:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,u):u,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,g):g,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._innerRefresh())))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const u=Math.max(this._rowStart,0),g=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(u,g),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const u of this._refreshCallbacks)u(0);this._refreshCallbacks=[]}}},3236:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Terminal=void 0;const g=u(3614),x=u(3656),h=u(3551),v=u(9042),w=u(3730),k=u(1680),_=u(3107),o=u(5744),a=u(2950),n=u(1296),i=u(428),f=u(4269),S=u(5114),C=u(8934),E=u(3230),y=u(9312),P=u(4725),O=u(6731),F=u(8055),U=u(8969),B=u(8460),J=u(844),ie=u(6114),fe=u(8437),_e=u(2584),Y=u(7399),R=u(5941),M=u(9074),A=u(2585),j=u(5435),Z=u(4567),he=u(779);class me extends U.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(W={}){super(W),this.browser=ie,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new J.MutableDisposable),this._onCursorMove=this.register(new B.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new B.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new B.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new B.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new B.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new B.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new B.EventEmitter),this._onBlur=this.register(new B.EventEmitter),this._onA11yCharEmitter=this.register(new B.EventEmitter),this._onA11yTabEmitter=this.register(new B.EventEmitter),this._onWillOpen=this.register(new B.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance(M.DecorationService),this._instantiationService.setService(A.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(he.LinkProviderService),this._instantiationService.setService(P.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(w.OscLinkProvider)),this.register(this._inputHandler.onRequestBell((()=>this._onBell.fire()))),this.register(this._inputHandler.onRequestRefreshRows(((D,oe)=>this.refresh(D,oe)))),this.register(this._inputHandler.onRequestSendFocus((()=>this._reportFocus()))),this.register(this._inputHandler.onRequestReset((()=>this.reset()))),this.register(this._inputHandler.onRequestWindowsOptionsReport((D=>this._reportWindowsOptions(D)))),this.register(this._inputHandler.onColor((D=>this._handleColorEvent(D)))),this.register((0,B.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,B.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,B.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,B.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize((D=>this._afterResize(D.cols,D.rows)))),this.register((0,J.toDisposable)((()=>{var D,oe;this._customKeyEventHandler=void 0,(oe=(D=this.element)==null?void 0:D.parentNode)==null||oe.removeChild(this.element)})))}_handleColorEvent(W){if(this._themeService)for(const D of W){let oe,ee="";switch(D.index){case 256:oe="foreground",ee="10";break;case 257:oe="background",ee="11";break;case 258:oe="cursor",ee="12";break;default:oe="ansi",ee="4;"+D.index}switch(D.type){case 0:const xe=F.color.toColorRGB(oe==="ansi"?this._themeService.colors.ansi[D.index]:this._themeService.colors[oe]);this.coreService.triggerDataEvent(`${_e.C0.ESC}]${ee};${(0,R.toRgbString)(xe)}${_e.C1_ESCAPED.ST}`);break;case 1:if(oe==="ansi")this._themeService.modifyColors((Ce=>Ce.ansi[D.index]=F.channels.toColor(...D.color)));else{const Ce=oe;this._themeService.modifyColors((Ke=>Ke[Ce]=F.channels.toColor(...D.color)))}break;case 2:this._themeService.restoreColor(D.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(W){W?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(Z.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(W){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(_e.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var W;return(W=this.textarea)==null?void 0:W.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(_e.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const W=this.buffer.ybase+this.buffer.y,D=this.buffer.lines.get(W);if(!D)return;const oe=Math.min(this.buffer.x,this.cols-1),ee=this._renderService.dimensions.css.cell.height,xe=D.getWidth(oe),Ce=this._renderService.dimensions.css.cell.width*xe,Ke=this.buffer.y*this._renderService.dimensions.css.cell.height,Xe=oe*this._renderService.dimensions.css.cell.width;this.textarea.style.left=Xe+"px",this.textarea.style.top=Ke+"px",this.textarea.style.width=Ce+"px",this.textarea.style.height=ee+"px",this.textarea.style.lineHeight=ee+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,x.addDisposableDomListener)(this.element,"copy",(D=>{this.hasSelection()&&(0,g.copyHandler)(D,this._selectionService)})));const W=D=>(0,g.handlePasteEvent)(D,this.textarea,this.coreService,this.optionsService);this.register((0,x.addDisposableDomListener)(this.textarea,"paste",W)),this.register((0,x.addDisposableDomListener)(this.element,"paste",W)),ie.isFirefox?this.register((0,x.addDisposableDomListener)(this.element,"mousedown",(D=>{D.button===2&&(0,g.rightClickHandler)(D,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)}))):this.register((0,x.addDisposableDomListener)(this.element,"contextmenu",(D=>{(0,g.rightClickHandler)(D,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)}))),ie.isLinux&&this.register((0,x.addDisposableDomListener)(this.element,"auxclick",(D=>{D.button===1&&(0,g.moveTextAreaUnderMouseCursor)(D,this.textarea,this.screenElement)})))}_bindKeys(){this.register((0,x.addDisposableDomListener)(this.textarea,"keyup",(W=>this._keyUp(W)),!0)),this.register((0,x.addDisposableDomListener)(this.textarea,"keydown",(W=>this._keyDown(W)),!0)),this.register((0,x.addDisposableDomListener)(this.textarea,"keypress",(W=>this._keyPress(W)),!0)),this.register((0,x.addDisposableDomListener)(this.textarea,"compositionstart",(()=>this._compositionHelper.compositionstart()))),this.register((0,x.addDisposableDomListener)(this.textarea,"compositionupdate",(W=>this._compositionHelper.compositionupdate(W)))),this.register((0,x.addDisposableDomListener)(this.textarea,"compositionend",(()=>this._compositionHelper.compositionend()))),this.register((0,x.addDisposableDomListener)(this.textarea,"input",(W=>this._inputEvent(W)),!0)),this.register(this.onRender((()=>this._compositionHelper.updateCompositionElements())))}open(W){var oe;if(!W)throw new Error("Terminal requires a parent element.");if(W.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),((oe=this.element)==null?void 0:oe.ownerDocument.defaultView)&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=W.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),W.appendChild(this.element);const D=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),D.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,x.addDisposableDomListener)(this.screenElement,"mousemove",(ee=>this.updateCursorStyle(ee)))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),D.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",v.promptLabel),ie.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(S.CoreBrowserService,this.textarea,W.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(P.ICoreBrowserService,this._coreBrowserService),this.register((0,x.addDisposableDomListener)(this.textarea,"focus",(ee=>this._handleTextAreaFocus(ee)))),this.register((0,x.addDisposableDomListener)(this.textarea,"blur",(()=>this._handleTextAreaBlur()))),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(i.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(P.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(O.ThemeService),this._instantiationService.setService(P.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(f.CharacterJoinerService),this._instantiationService.setService(P.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(E.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(P.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange((ee=>this._onRender.fire(ee)))),this.onResize((ee=>this._renderService.resize(ee.cols,ee.rows))),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(a.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(C.MouseService),this._instantiationService.setService(P.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(h.Linkifier,this.screenElement)),this.element.appendChild(D);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(k.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines((ee=>this.scrollLines(ee.amount,ee.suppressScrollEvent,1))),this.register(this._inputHandler.onRequestSyncScrollBar((()=>this.viewport.syncScrollArea()))),this.register(this.viewport),this.register(this.onCursorMove((()=>{this._renderService.handleCursorMove(),this._syncTextArea()}))),this.register(this.onResize((()=>this._renderService.handleResize(this.cols,this.rows)))),this.register(this.onBlur((()=>this._renderService.handleBlur()))),this.register(this.onFocus((()=>this._renderService.handleFocus()))),this.register(this._renderService.onDimensionsChange((()=>this.viewport.syncScrollArea()))),this._selectionService=this.register(this._instantiationService.createInstance(y.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(P.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines((ee=>this.scrollLines(ee.amount,ee.suppressScrollEvent)))),this.register(this._selectionService.onSelectionChange((()=>this._onSelectionChange.fire()))),this.register(this._selectionService.onRequestRedraw((ee=>this._renderService.handleSelectionChanged(ee.start,ee.end,ee.columnSelectMode)))),this.register(this._selectionService.onLinuxMouseSelection((ee=>{this.textarea.value=ee,this.textarea.focus(),this.textarea.select()}))),this.register(this._onScroll.event((ee=>{this.viewport.syncScrollArea(),this._selectionService.refresh()}))),this.register((0,x.addDisposableDomListener)(this._viewportElement,"scroll",(()=>this._selectionService.refresh()))),this.register(this._instantiationService.createInstance(_.BufferDecorationRenderer,this.screenElement)),this.register((0,x.addDisposableDomListener)(this.element,"mousedown",(ee=>this._selectionService.handleMouseDown(ee)))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(Z.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",(ee=>this._handleScreenReaderModeOptionChange(ee)))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(o.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",(ee=>{!this._overviewRulerRenderer&&ee&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(o.OverviewRulerRenderer,this._viewportElement,this.screenElement)))})),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(n.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const W=this,D=this.element;function oe(Ce){const Ke=W._mouseService.getMouseReportCoords(Ce,W.screenElement);if(!Ke)return!1;let Xe,ft;switch(Ce.overrideType||Ce.type){case"mousemove":ft=32,Ce.buttons===void 0?(Xe=3,Ce.button!==void 0&&(Xe=Ce.button<3?Ce.button:3)):Xe=1&Ce.buttons?0:4&Ce.buttons?1:2&Ce.buttons?2:3;break;case"mouseup":ft=0,Xe=Ce.button<3?Ce.button:3;break;case"mousedown":ft=1,Xe=Ce.button<3?Ce.button:3;break;case"wheel":if(W._customWheelEventHandler&&W._customWheelEventHandler(Ce)===!1||W.viewport.getLinesScrolled(Ce)===0)return!1;ft=Ce.deltaY<0?0:1,Xe=4;break;default:return!1}return!(ft===void 0||Xe===void 0||Xe>4)&&W.coreMouseService.triggerMouseEvent({col:Ke.col,row:Ke.row,x:Ke.x,y:Ke.y,button:Xe,action:ft,ctrl:Ce.ctrlKey,alt:Ce.altKey,shift:Ce.shiftKey})}const ee={mouseup:null,wheel:null,mousedrag:null,mousemove:null},xe={mouseup:Ce=>(oe(Ce),Ce.buttons||(this._document.removeEventListener("mouseup",ee.mouseup),ee.mousedrag&&this._document.removeEventListener("mousemove",ee.mousedrag)),this.cancel(Ce)),wheel:Ce=>(oe(Ce),this.cancel(Ce,!0)),mousedrag:Ce=>{Ce.buttons&&oe(Ce)},mousemove:Ce=>{Ce.buttons||oe(Ce)}};this.register(this.coreMouseService.onProtocolChange((Ce=>{Ce?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(Ce)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&Ce?ee.mousemove||(D.addEventListener("mousemove",xe.mousemove),ee.mousemove=xe.mousemove):(D.removeEventListener("mousemove",ee.mousemove),ee.mousemove=null),16&Ce?ee.wheel||(D.addEventListener("wheel",xe.wheel,{passive:!1}),ee.wheel=xe.wheel):(D.removeEventListener("wheel",ee.wheel),ee.wheel=null),2&Ce?ee.mouseup||(ee.mouseup=xe.mouseup):(this._document.removeEventListener("mouseup",ee.mouseup),ee.mouseup=null),4&Ce?ee.mousedrag||(ee.mousedrag=xe.mousedrag):(this._document.removeEventListener("mousemove",ee.mousedrag),ee.mousedrag=null)}))),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,x.addDisposableDomListener)(D,"mousedown",(Ce=>{if(Ce.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(Ce))return oe(Ce),ee.mouseup&&this._document.addEventListener("mouseup",ee.mouseup),ee.mousedrag&&this._document.addEventListener("mousemove",ee.mousedrag),this.cancel(Ce)}))),this.register((0,x.addDisposableDomListener)(D,"wheel",(Ce=>{if(!ee.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(Ce)===!1)return!1;if(!this.buffer.hasScrollback){const Ke=this.viewport.getLinesScrolled(Ce);if(Ke===0)return;const Xe=_e.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(Ce.deltaY<0?"A":"B");let ft="";for(let gt=0;gt<Math.abs(Ke);gt++)ft+=Xe;return this.coreService.triggerDataEvent(ft,!0),this.cancel(Ce,!0)}return this.viewport.handleWheel(Ce)?this.cancel(Ce):void 0}}),{passive:!1})),this.register((0,x.addDisposableDomListener)(D,"touchstart",(Ce=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(Ce),this.cancel(Ce)}),{passive:!0})),this.register((0,x.addDisposableDomListener)(D,"touchmove",(Ce=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(Ce)?void 0:this.cancel(Ce)}),{passive:!1}))}refresh(W,D){var oe;(oe=this._renderService)==null||oe.refreshRows(W,D)}updateCursorStyle(W){var D;(D=this._selectionService)!=null&&D.shouldColumnSelect(W)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(W,D,oe=0){var ee;oe===1?(super.scrollLines(W,D,oe),this.refresh(0,this.rows-1)):(ee=this.viewport)==null||ee.scrollLines(W)}paste(W){(0,g.paste)(W,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(W){this._customKeyEventHandler=W}attachCustomWheelEventHandler(W){this._customWheelEventHandler=W}registerLinkProvider(W){return this._linkProviderService.registerLinkProvider(W)}registerCharacterJoiner(W){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const D=this._characterJoinerService.register(W);return this.refresh(0,this.rows-1),D}deregisterCharacterJoiner(W){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(W)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(W){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+W)}registerDecoration(W){return this._decorationService.registerDecoration(W)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(W,D,oe){this._selectionService.setSelection(W,D,oe)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var W;(W=this._selectionService)==null||W.clearSelection()}selectAll(){var W;(W=this._selectionService)==null||W.selectAll()}selectLines(W,D){var oe;(oe=this._selectionService)==null||oe.selectLines(W,D)}_keyDown(W){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(W)===!1)return!1;const D=this.browser.isMac&&this.options.macOptionIsMeta&&W.altKey;if(!D&&!this._compositionHelper.keydown(W))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;D||W.key!=="Dead"&&W.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const oe=(0,Y.evaluateKeyboardEvent)(W,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(W),oe.type===3||oe.type===2){const ee=this.rows-1;return this.scrollLines(oe.type===2?-ee:ee),this.cancel(W,!0)}return oe.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,W)||(oe.cancel&&this.cancel(W,!0),!oe.key||!!(W.key&&!W.ctrlKey&&!W.altKey&&!W.metaKey&&W.key.length===1&&W.key.charCodeAt(0)>=65&&W.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(oe.key!==_e.C0.ETX&&oe.key!==_e.C0.CR||(this.textarea.value=""),this._onKey.fire({key:oe.key,domEvent:W}),this._showCursor(),this.coreService.triggerDataEvent(oe.key,!0),!this.optionsService.rawOptions.screenReaderMode||W.altKey||W.ctrlKey?this.cancel(W,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(W,D){const oe=W.isMac&&!this.options.macOptionIsMeta&&D.altKey&&!D.ctrlKey&&!D.metaKey||W.isWindows&&D.altKey&&D.ctrlKey&&!D.metaKey||W.isWindows&&D.getModifierState("AltGraph");return D.type==="keypress"?oe:oe&&(!D.keyCode||D.keyCode>47)}_keyUp(W){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(W)===!1||((function(D){return D.keyCode===16||D.keyCode===17||D.keyCode===18})(W)||this.focus(),this.updateCursorStyle(W),this._keyPressHandled=!1)}_keyPress(W){let D;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(W)===!1)return!1;if(this.cancel(W),W.charCode)D=W.charCode;else if(W.which===null||W.which===void 0)D=W.keyCode;else{if(W.which===0||W.charCode===0)return!1;D=W.which}return!(!D||(W.altKey||W.ctrlKey||W.metaKey)&&!this._isThirdLevelShift(this.browser,W)||(D=String.fromCharCode(D),this._onKey.fire({key:D,domEvent:W}),this._showCursor(),this.coreService.triggerDataEvent(D,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(W){if(W.data&&W.inputType==="insertText"&&(!W.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const D=W.data;return this.coreService.triggerDataEvent(D,!0),this.cancel(W),!0}return!1}resize(W,D){W!==this.cols||D!==this.rows?super.resize(W,D):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(W,D){var oe,ee;(oe=this._charSizeService)==null||oe.measure(),(ee=this.viewport)==null||ee.syncScrollArea(!0)}clear(){var W;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let D=1;D<this.rows;D++)this.buffer.lines.push(this.buffer.getBlankLine(fe.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(W=this.viewport)==null||W.reset(),this.refresh(0,this.rows-1)}}reset(){var D,oe;this.options.rows=this.rows,this.options.cols=this.cols;const W=this._customKeyEventHandler;this._setup(),super.reset(),(D=this._selectionService)==null||D.reset(),this._decorationService.reset(),(oe=this.viewport)==null||oe.reset(),this._customKeyEventHandler=W,this.refresh(0,this.rows-1)}clearTextureAtlas(){var W;(W=this._renderService)==null||W.clearTextureAtlas()}_reportFocus(){var W;(W=this.element)!=null&&W.classList.contains("focus")?this.coreService.triggerDataEvent(_e.C0.ESC+"[I"):this.coreService.triggerDataEvent(_e.C0.ESC+"[O")}_reportWindowsOptions(W){if(this._renderService)switch(W){case j.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const D=this._renderService.dimensions.css.canvas.width.toFixed(0),oe=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${_e.C0.ESC}[4;${oe};${D}t`);break;case j.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const ee=this._renderService.dimensions.css.cell.width.toFixed(0),xe=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${_e.C0.ESC}[6;${xe};${ee}t`)}}cancel(W,D){if(this.options.cancelEvents||D)return W.preventDefault(),W.stopPropagation(),!1}}c.Terminal=me},9924:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TimeBasedDebouncer=void 0,c.TimeBasedDebouncer=class{constructor(u,g=1e3){this._renderCallback=u,this._debounceThresholdMS=g,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(u,g,x){this._rowCount=x,u=u!==void 0?u:0,g=g!==void 0?g:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,u):u,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,g):g;const h=Date.now();if(h-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=h,this._innerRefresh();else if(!this._additionalRefreshRequested){const v=h-this._lastRefreshMs,w=this._debounceThresholdMS-v;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout((()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0}),w)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const u=Math.max(this._rowStart,0),g=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(u,g)}}},1680:function(q,c,u){var g=this&&this.__decorate||function(a,n,i,f){var S,C=arguments.length,E=C<3?n:f===null?f=Object.getOwnPropertyDescriptor(n,i):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(a,n,i,f);else for(var y=a.length-1;y>=0;y--)(S=a[y])&&(E=(C<3?S(E):C>3?S(n,i,E):S(n,i))||E);return C>3&&E&&Object.defineProperty(n,i,E),E},x=this&&this.__param||function(a,n){return function(i,f){n(i,f,a)}};Object.defineProperty(c,"__esModule",{value:!0}),c.Viewport=void 0;const h=u(3656),v=u(4725),w=u(8460),k=u(844),_=u(2585);let o=c.Viewport=class extends k.Disposable{constructor(a,n,i,f,S,C,E,y){super(),this._viewportElement=a,this._scrollArea=n,this._bufferService=i,this._optionsService=f,this._charSizeService=S,this._renderService=C,this._coreBrowserService=E,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new w.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,h.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate((P=>this._activeBuffer=P.activeBuffer))),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange((P=>this._renderDimensions=P))),this._handleThemeChange(y.colors),this.register(y.onChangeColors((P=>this._handleThemeChange(P)))),this.register(this._optionsService.onSpecificOptionChange("scrollback",(()=>this.syncScrollArea()))),setTimeout((()=>this.syncScrollArea()))}_handleThemeChange(a){this._viewportElement.style.backgroundColor=a.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame((()=>this.syncScrollArea()))}_refresh(a){if(a)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._innerRefresh())))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const n=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==n&&(this._lastRecordedBufferHeight=n,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const a=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==a&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=a),this._refreshAnimationFrame=null}syncScrollArea(a=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(a);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(a)}_handleScroll(a){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const n=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:n,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const a=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(a*(this._smoothScrollState.target-this._smoothScrollState.origin)),a<1?this._coreBrowserService.window.requestAnimationFrame((()=>this._smoothScroll())):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(a,n){const i=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(n<0&&this._viewportElement.scrollTop!==0||n>0&&i<this._lastRecordedBufferHeight)||(a.cancelable&&a.preventDefault(),!1)}handleWheel(a){const n=this._getPixelsScrolled(a);return n!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+n:this._smoothScrollState.target+=n,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=n,this._bubbleScroll(a,n))}scrollLines(a){if(a!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const n=a*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+n,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:a,suppressScrollEvent:!1})}_getPixelsScrolled(a){if(a.deltaY===0||a.shiftKey)return 0;let n=this._applyScrollModifier(a.deltaY,a);return a.deltaMode===WheelEvent.DOM_DELTA_LINE?n*=this._currentRowHeight:a.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(n*=this._currentRowHeight*this._bufferService.rows),n}getBufferElements(a,n){var y;let i,f="";const S=[],C=n??this._bufferService.buffer.lines.length,E=this._bufferService.buffer.lines;for(let P=a;P<C;P++){const O=E.get(P);if(!O)continue;const F=(y=E.get(P+1))==null?void 0:y.isWrapped;if(f+=O.translateToString(!F),!F||P===E.length-1){const U=document.createElement("div");U.textContent=f,S.push(U),f.length>0&&(i=U),f=""}}return{bufferElements:S,cursorElement:i}}getLinesScrolled(a){if(a.deltaY===0||a.shiftKey)return 0;let n=this._applyScrollModifier(a.deltaY,a);return a.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(n/=this._currentRowHeight+0,this._wheelPartialScroll+=n,n=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):a.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(n*=this._bufferService.rows),n}_applyScrollModifier(a,n){const i=this._optionsService.rawOptions.fastScrollModifier;return i==="alt"&&n.altKey||i==="ctrl"&&n.ctrlKey||i==="shift"&&n.shiftKey?a*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:a*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(a){this._lastTouchY=a.touches[0].pageY}handleTouchMove(a){const n=this._lastTouchY-a.touches[0].pageY;return this._lastTouchY=a.touches[0].pageY,n!==0&&(this._viewportElement.scrollTop+=n,this._bubbleScroll(a,n))}};c.Viewport=o=g([x(2,_.IBufferService),x(3,_.IOptionsService),x(4,v.ICharSizeService),x(5,v.IRenderService),x(6,v.ICoreBrowserService),x(7,v.IThemeService)],o)},3107:function(q,c,u){var g=this&&this.__decorate||function(_,o,a,n){var i,f=arguments.length,S=f<3?o:n===null?n=Object.getOwnPropertyDescriptor(o,a):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(_,o,a,n);else for(var C=_.length-1;C>=0;C--)(i=_[C])&&(S=(f<3?i(S):f>3?i(o,a,S):i(o,a))||S);return f>3&&S&&Object.defineProperty(o,a,S),S},x=this&&this.__param||function(_,o){return function(a,n){o(a,n,_)}};Object.defineProperty(c,"__esModule",{value:!0}),c.BufferDecorationRenderer=void 0;const h=u(4725),v=u(844),w=u(2585);let k=c.BufferDecorationRenderer=class extends v.Disposable{constructor(_,o,a,n,i){super(),this._screenElement=_,this._bufferService=o,this._coreBrowserService=a,this._decorationService=n,this._renderService=i,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange((()=>this._doRefreshDecorations()))),this.register(this._renderService.onDimensionsChange((()=>{this._dimensionsChanged=!0,this._queueRefresh()}))),this.register(this._coreBrowserService.onDprChange((()=>this._queueRefresh()))),this.register(this._bufferService.buffers.onBufferActivate((()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt}))),this.register(this._decorationService.onDecorationRegistered((()=>this._queueRefresh()))),this.register(this._decorationService.onDecorationRemoved((f=>this._removeDecoration(f)))),this.register((0,v.toDisposable)((()=>{this._container.remove(),this._decorationElements.clear()})))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback((()=>{this._doRefreshDecorations(),this._animationFrame=void 0})))}_doRefreshDecorations(){for(const _ of this._decorationService.decorations)this._renderDecoration(_);this._dimensionsChanged=!1}_renderDecoration(_){this._refreshStyle(_),this._dimensionsChanged&&this._refreshXPosition(_)}_createElement(_){var n;const o=this._coreBrowserService.mainDocument.createElement("div");o.classList.add("xterm-decoration"),o.classList.toggle("xterm-decoration-top-layer",((n=_==null?void 0:_.options)==null?void 0:n.layer)==="top"),o.style.width=`${Math.round((_.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,o.style.height=(_.options.height||1)*this._renderService.dimensions.css.cell.height+"px",o.style.top=(_.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",o.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const a=_.options.x??0;return a&&a>this._bufferService.cols&&(o.style.display="none"),this._refreshXPosition(_,o),o}_refreshStyle(_){const o=_.marker.line-this._bufferService.buffers.active.ydisp;if(o<0||o>=this._bufferService.rows)_.element&&(_.element.style.display="none",_.onRenderEmitter.fire(_.element));else{let a=this._decorationElements.get(_);a||(a=this._createElement(_),_.element=a,this._decorationElements.set(_,a),this._container.appendChild(a),_.onDispose((()=>{this._decorationElements.delete(_),a.remove()}))),a.style.top=o*this._renderService.dimensions.css.cell.height+"px",a.style.display=this._altBufferIsActive?"none":"block",_.onRenderEmitter.fire(a)}}_refreshXPosition(_,o=_.element){if(!o)return;const a=_.options.x??0;(_.options.anchor||"left")==="right"?o.style.right=a?a*this._renderService.dimensions.css.cell.width+"px":"":o.style.left=a?a*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(_){var o;(o=this._decorationElements.get(_))==null||o.remove(),this._decorationElements.delete(_),_.dispose()}};c.BufferDecorationRenderer=k=g([x(1,w.IBufferService),x(2,h.ICoreBrowserService),x(3,w.IDecorationService),x(4,h.IRenderService)],k)},5871:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ColorZoneStore=void 0,c.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(u){if(u.options.overviewRulerOptions){for(const g of this._zones)if(g.color===u.options.overviewRulerOptions.color&&g.position===u.options.overviewRulerOptions.position){if(this._lineIntersectsZone(g,u.marker.line))return;if(this._lineAdjacentToZone(g,u.marker.line,u.options.overviewRulerOptions.position))return void this._addLineToZone(g,u.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=u.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=u.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=u.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=u.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:u.options.overviewRulerOptions.color,position:u.options.overviewRulerOptions.position,startBufferLine:u.marker.line,endBufferLine:u.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(u){this._linePadding=u}_lineIntersectsZone(u,g){return g>=u.startBufferLine&&g<=u.endBufferLine}_lineAdjacentToZone(u,g,x){return g>=u.startBufferLine-this._linePadding[x||"full"]&&g<=u.endBufferLine+this._linePadding[x||"full"]}_addLineToZone(u,g){u.startBufferLine=Math.min(u.startBufferLine,g),u.endBufferLine=Math.max(u.endBufferLine,g)}}},5744:function(q,c,u){var g=this&&this.__decorate||function(i,f,S,C){var E,y=arguments.length,P=y<3?f:C===null?C=Object.getOwnPropertyDescriptor(f,S):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(i,f,S,C);else for(var O=i.length-1;O>=0;O--)(E=i[O])&&(P=(y<3?E(P):y>3?E(f,S,P):E(f,S))||P);return y>3&&P&&Object.defineProperty(f,S,P),P},x=this&&this.__param||function(i,f){return function(S,C){f(S,C,i)}};Object.defineProperty(c,"__esModule",{value:!0}),c.OverviewRulerRenderer=void 0;const h=u(5871),v=u(4725),w=u(844),k=u(2585),_={full:0,left:0,center:0,right:0},o={full:0,left:0,center:0,right:0},a={full:0,left:0,center:0,right:0};let n=c.OverviewRulerRenderer=class extends w.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(i,f,S,C,E,y,P){var F;super(),this._viewportElement=i,this._screenElement=f,this._bufferService=S,this._decorationService=C,this._renderService=E,this._optionsService=y,this._coreBrowserService=P,this._colorZoneStore=new h.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(F=this._viewportElement.parentElement)==null||F.insertBefore(this._canvas,this._viewportElement);const O=this._canvas.getContext("2d");if(!O)throw new Error("Ctx cannot be null");this._ctx=O,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,w.toDisposable)((()=>{var U;(U=this._canvas)==null||U.remove()})))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered((()=>this._queueRefresh(void 0,!0)))),this.register(this._decorationService.onDecorationRemoved((()=>this._queueRefresh(void 0,!0))))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange((()=>this._queueRefresh()))),this.register(this._bufferService.buffers.onBufferActivate((()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"}))),this.register(this._bufferService.onScroll((()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())})))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender((()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)}))),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",(()=>this._queueRefresh(!0)))),this.register(this._coreBrowserService.onDprChange((()=>this._queueRefresh(!0)))),this._queueRefresh(!0)}_refreshDrawConstants(){const i=Math.floor(this._canvas.width/3),f=Math.ceil(this._canvas.width/3);o.full=this._canvas.width,o.left=i,o.center=f,o.right=i,this._refreshDrawHeightConstants(),a.full=0,a.left=0,a.center=o.left,a.right=o.left+o.center}_refreshDrawHeightConstants(){_.full=Math.round(2*this._coreBrowserService.dpr);const i=this._canvas.height/this._bufferService.buffer.lines.length,f=Math.round(Math.max(Math.min(i,12),6)*this._coreBrowserService.dpr);_.left=f,_.center=f,_.right=f}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const f of this._decorationService.decorations)this._colorZoneStore.addDecoration(f);this._ctx.lineWidth=1;const i=this._colorZoneStore.zones;for(const f of i)f.position!=="full"&&this._renderColorZone(f);for(const f of i)f.position==="full"&&this._renderColorZone(f);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(i){this._ctx.fillStyle=i.color,this._ctx.fillRect(a[i.position||"full"],Math.round((this._canvas.height-1)*(i.startBufferLine/this._bufferService.buffers.active.lines.length)-_[i.position||"full"]/2),o[i.position||"full"],Math.round((this._canvas.height-1)*((i.endBufferLine-i.startBufferLine)/this._bufferService.buffers.active.lines.length)+_[i.position||"full"]))}_queueRefresh(i,f){this._shouldUpdateDimensions=i||this._shouldUpdateDimensions,this._shouldUpdateAnchor=f||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>{this._refreshDecorations(),this._animationFrame=void 0})))}};c.OverviewRulerRenderer=n=g([x(2,k.IBufferService),x(3,k.IDecorationService),x(4,v.IRenderService),x(5,k.IOptionsService),x(6,v.ICoreBrowserService)],n)},2950:function(q,c,u){var g=this&&this.__decorate||function(_,o,a,n){var i,f=arguments.length,S=f<3?o:n===null?n=Object.getOwnPropertyDescriptor(o,a):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(_,o,a,n);else for(var C=_.length-1;C>=0;C--)(i=_[C])&&(S=(f<3?i(S):f>3?i(o,a,S):i(o,a))||S);return f>3&&S&&Object.defineProperty(o,a,S),S},x=this&&this.__param||function(_,o){return function(a,n){o(a,n,_)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CompositionHelper=void 0;const h=u(4725),v=u(2585),w=u(2584);let k=c.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(_,o,a,n,i,f){this._textarea=_,this._compositionView=o,this._bufferService=a,this._optionsService=n,this._coreService=i,this._renderService=f,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(_){this._compositionView.textContent=_.data,this.updateCompositionElements(),setTimeout((()=>{this._compositionPosition.end=this._textarea.value.length}),0)}compositionend(){this._finalizeComposition(!0)}keydown(_){if(this._isComposing||this._isSendingComposition){if(_.keyCode===229||_.keyCode===16||_.keyCode===17||_.keyCode===18)return!1;this._finalizeComposition(!1)}return _.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(_){if(this._compositionView.classList.remove("active"),this._isComposing=!1,_){const o={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout((()=>{if(this._isSendingComposition){let a;this._isSendingComposition=!1,o.start+=this._dataAlreadySent.length,a=this._isComposing?this._textarea.value.substring(o.start,o.end):this._textarea.value.substring(o.start),a.length>0&&this._coreService.triggerDataEvent(a,!0)}}),0)}else{this._isSendingComposition=!1;const o=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(o,!0)}}_handleAnyTextareaChanges(){const _=this._textarea.value;setTimeout((()=>{if(!this._isComposing){const o=this._textarea.value,a=o.replace(_,"");this._dataAlreadySent=a,o.length>_.length?this._coreService.triggerDataEvent(a,!0):o.length<_.length?this._coreService.triggerDataEvent(`${w.C0.DEL}`,!0):o.length===_.length&&o!==_&&this._coreService.triggerDataEvent(o,!0)}}),0)}updateCompositionElements(_){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const o=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),a=this._renderService.dimensions.css.cell.height,n=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,i=o*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=i+"px",this._compositionView.style.top=n+"px",this._compositionView.style.height=a+"px",this._compositionView.style.lineHeight=a+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const f=this._compositionView.getBoundingClientRect();this._textarea.style.left=i+"px",this._textarea.style.top=n+"px",this._textarea.style.width=Math.max(f.width,1)+"px",this._textarea.style.height=Math.max(f.height,1)+"px",this._textarea.style.lineHeight=f.height+"px"}_||setTimeout((()=>this.updateCompositionElements(!0)),0)}}};c.CompositionHelper=k=g([x(2,v.IBufferService),x(3,v.IOptionsService),x(4,v.ICoreService),x(5,h.IRenderService)],k)},9806:(q,c)=>{function u(g,x,h){const v=h.getBoundingClientRect(),w=g.getComputedStyle(h),k=parseInt(w.getPropertyValue("padding-left")),_=parseInt(w.getPropertyValue("padding-top"));return[x.clientX-v.left-k,x.clientY-v.top-_]}Object.defineProperty(c,"__esModule",{value:!0}),c.getCoords=c.getCoordsRelativeToElement=void 0,c.getCoordsRelativeToElement=u,c.getCoords=function(g,x,h,v,w,k,_,o,a){if(!k)return;const n=u(g,x,h);return n?(n[0]=Math.ceil((n[0]+(a?_/2:0))/_),n[1]=Math.ceil(n[1]/o),n[0]=Math.min(Math.max(n[0],1),v+(a?1:0)),n[1]=Math.min(Math.max(n[1],1),w),n):void 0}},9504:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.moveToCellSequence=void 0;const g=u(2584);function x(o,a,n,i){const f=o-h(o,n),S=a-h(a,n),C=Math.abs(f-S)-(function(E,y,P){let O=0;const F=E-h(E,P),U=y-h(y,P);for(let B=0;B<Math.abs(F-U);B++){const J=v(E,y)==="A"?-1:1,ie=P.buffer.lines.get(F+J*B);ie!=null&&ie.isWrapped&&O++}return O})(o,a,n);return _(C,k(v(o,a),i))}function h(o,a){let n=0,i=a.buffer.lines.get(o),f=i==null?void 0:i.isWrapped;for(;f&&o>=0&&o<a.rows;)n++,i=a.buffer.lines.get(--o),f=i==null?void 0:i.isWrapped;return n}function v(o,a){return o>a?"A":"B"}function w(o,a,n,i,f,S){let C=o,E=a,y="";for(;C!==n||E!==i;)C+=f?1:-1,f&&C>S.cols-1?(y+=S.buffer.translateBufferLineToString(E,!1,o,C),C=0,o=0,E++):!f&&C<0&&(y+=S.buffer.translateBufferLineToString(E,!1,0,o+1),C=S.cols-1,o=C,E--);return y+S.buffer.translateBufferLineToString(E,!1,o,C)}function k(o,a){const n=a?"O":"[";return g.C0.ESC+n+o}function _(o,a){o=Math.floor(o);let n="";for(let i=0;i<o;i++)n+=a;return n}c.moveToCellSequence=function(o,a,n,i){const f=n.buffer.x,S=n.buffer.y;if(!n.buffer.hasScrollback)return(function(y,P,O,F,U,B){return x(P,F,U,B).length===0?"":_(w(y,P,y,P-h(P,U),!1,U).length,k("D",B))})(f,S,0,a,n,i)+x(S,a,n,i)+(function(y,P,O,F,U,B){let J;J=x(P,F,U,B).length>0?F-h(F,U):P;const ie=F,fe=(function(_e,Y,R,M,A,j){let Z;return Z=x(R,M,A,j).length>0?M-h(M,A):Y,_e<R&&Z<=M||_e>=R&&Z<M?"C":"D"})(y,P,O,F,U,B);return _(w(y,J,O,ie,fe==="C",U).length,k(fe,B))})(f,S,o,a,n,i);let C;if(S===a)return C=f>o?"D":"C",_(Math.abs(f-o),k(C,i));C=S>a?"D":"C";const E=Math.abs(S-a);return _((function(y,P){return P.cols-y})(S>a?o:f,n)+(E-1)*n.cols+1+((S>a?f:o)-1),k(C,i))}},1296:function(q,c,u){var g=this&&this.__decorate||function(B,J,ie,fe){var _e,Y=arguments.length,R=Y<3?J:fe===null?fe=Object.getOwnPropertyDescriptor(J,ie):fe;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(B,J,ie,fe);else for(var M=B.length-1;M>=0;M--)(_e=B[M])&&(R=(Y<3?_e(R):Y>3?_e(J,ie,R):_e(J,ie))||R);return Y>3&&R&&Object.defineProperty(J,ie,R),R},x=this&&this.__param||function(B,J){return function(ie,fe){J(ie,fe,B)}};Object.defineProperty(c,"__esModule",{value:!0}),c.DomRenderer=void 0;const h=u(3787),v=u(2550),w=u(2223),k=u(6171),_=u(6052),o=u(4725),a=u(8055),n=u(8460),i=u(844),f=u(2585),S="xterm-dom-renderer-owner-",C="xterm-rows",E="xterm-fg-",y="xterm-bg-",P="xterm-focus",O="xterm-selection";let F=1,U=c.DomRenderer=class extends i.Disposable{constructor(B,J,ie,fe,_e,Y,R,M,A,j,Z,he,me){super(),this._terminal=B,this._document=J,this._element=ie,this._screenElement=fe,this._viewportElement=_e,this._helperContainer=Y,this._linkifier2=R,this._charSizeService=A,this._optionsService=j,this._bufferService=Z,this._coreBrowserService=he,this._themeService=me,this._terminalClass=F++,this._rowElements=[],this._selectionRenderModel=(0,_.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new n.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(C),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(O),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,k.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange((()=>this._handleOptionsChanged()))),this.register(this._themeService.onChangeColors((ve=>this._injectCss(ve)))),this._injectCss(this._themeService.colors),this._rowFactory=M.createInstance(h.DomRendererRowFactory,document),this._element.classList.add(S+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline((ve=>this._handleLinkHover(ve)))),this.register(this._linkifier2.onHideLinkUnderline((ve=>this._handleLinkLeave(ve)))),this.register((0,i.toDisposable)((()=>{this._element.classList.remove(S+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()}))),this._widthCache=new v.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const B=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*B,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*B),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/B),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/B),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const ie of this._rowElements)ie.style.width=`${this.dimensions.css.canvas.width}px`,ie.style.height=`${this.dimensions.css.cell.height}px`,ie.style.lineHeight=`${this.dimensions.css.cell.height}px`,ie.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const J=`${this._terminalSelector} .${C} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=J,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(B){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let J=`${this._terminalSelector} .${C} { color: ${B.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;J+=`${this._terminalSelector} .${C} .xterm-dim { color: ${a.color.multiplyOpacity(B.foreground,.5).css};}`,J+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const ie=`blink_underline_${this._terminalClass}`,fe=`blink_bar_${this._terminalClass}`,_e=`blink_block_${this._terminalClass}`;J+=`@keyframes ${ie} { 50% {  border-bottom-style: hidden; }}`,J+=`@keyframes ${fe} { 50% {  box-shadow: none; }}`,J+=`@keyframes ${_e} { 0% {  background-color: ${B.cursor.css};  color: ${B.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${B.cursor.css}; }}`,J+=`${this._terminalSelector} .${C}.${P} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${ie} 1s step-end infinite;}${this._terminalSelector} .${C}.${P} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${fe} 1s step-end infinite;}${this._terminalSelector} .${C}.${P} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${_e} 1s step-end infinite;}${this._terminalSelector} .${C} .xterm-cursor.xterm-cursor-block { background-color: ${B.cursor.css}; color: ${B.cursorAccent.css};}${this._terminalSelector} .${C} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${B.cursor.css} !important; color: ${B.cursorAccent.css} !important;}${this._terminalSelector} .${C} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${B.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${C} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${B.cursor.css} inset;}${this._terminalSelector} .${C} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${B.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,J+=`${this._terminalSelector} .${O} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${O} div { position: absolute; background-color: ${B.selectionBackgroundOpaque.css};}${this._terminalSelector} .${O} div { position: absolute; background-color: ${B.selectionInactiveBackgroundOpaque.css};}`;for(const[Y,R]of B.ansi.entries())J+=`${this._terminalSelector} .${E}${Y} { color: ${R.css}; }${this._terminalSelector} .${E}${Y}.xterm-dim { color: ${a.color.multiplyOpacity(R,.5).css}; }${this._terminalSelector} .${y}${Y} { background-color: ${R.css}; }`;J+=`${this._terminalSelector} .${E}${w.INVERTED_DEFAULT_COLOR} { color: ${a.color.opaque(B.background).css}; }${this._terminalSelector} .${E}${w.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${a.color.multiplyOpacity(a.color.opaque(B.background),.5).css}; }${this._terminalSelector} .${y}${w.INVERTED_DEFAULT_COLOR} { background-color: ${B.foreground.css}; }`,this._themeStyleElement.textContent=J}_setDefaultSpacing(){const B=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${B}px`,this._rowFactory.defaultSpacing=B}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(B,J){for(let ie=this._rowElements.length;ie<=J;ie++){const fe=this._document.createElement("div");this._rowContainer.appendChild(fe),this._rowElements.push(fe)}for(;this._rowElements.length>J;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(B,J){this._refreshRowElements(B,J),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(P),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(P),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(B,J,ie){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(B,J,ie),this.renderRows(0,this._bufferService.rows-1),!B||!J)return;this._selectionRenderModel.update(this._terminal,B,J,ie);const fe=this._selectionRenderModel.viewportStartRow,_e=this._selectionRenderModel.viewportEndRow,Y=this._selectionRenderModel.viewportCappedStartRow,R=this._selectionRenderModel.viewportCappedEndRow;if(Y>=this._bufferService.rows||R<0)return;const M=this._document.createDocumentFragment();if(ie){const A=B[0]>J[0];M.appendChild(this._createSelectionElement(Y,A?J[0]:B[0],A?B[0]:J[0],R-Y+1))}else{const A=fe===Y?B[0]:0,j=Y===_e?J[0]:this._bufferService.cols;M.appendChild(this._createSelectionElement(Y,A,j));const Z=R-Y-1;if(M.appendChild(this._createSelectionElement(Y+1,0,this._bufferService.cols,Z)),Y!==R){const he=_e===R?J[0]:this._bufferService.cols;M.appendChild(this._createSelectionElement(R,0,he))}}this._selectionContainer.appendChild(M)}_createSelectionElement(B,J,ie,fe=1){const _e=this._document.createElement("div"),Y=J*this.dimensions.css.cell.width;let R=this.dimensions.css.cell.width*(ie-J);return Y+R>this.dimensions.css.canvas.width&&(R=this.dimensions.css.canvas.width-Y),_e.style.height=fe*this.dimensions.css.cell.height+"px",_e.style.top=B*this.dimensions.css.cell.height+"px",_e.style.left=`${Y}px`,_e.style.width=`${R}px`,_e}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const B of this._rowElements)B.replaceChildren()}renderRows(B,J){const ie=this._bufferService.buffer,fe=ie.ybase+ie.y,_e=Math.min(ie.x,this._bufferService.cols-1),Y=this._optionsService.rawOptions.cursorBlink,R=this._optionsService.rawOptions.cursorStyle,M=this._optionsService.rawOptions.cursorInactiveStyle;for(let A=B;A<=J;A++){const j=A+ie.ydisp,Z=this._rowElements[A],he=ie.lines.get(j);if(!Z||!he)break;Z.replaceChildren(...this._rowFactory.createRow(he,j,j===fe,R,M,_e,Y,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${S}${this._terminalClass}`}_handleLinkHover(B){this._setCellUnderline(B.x1,B.x2,B.y1,B.y2,B.cols,!0)}_handleLinkLeave(B){this._setCellUnderline(B.x1,B.x2,B.y1,B.y2,B.cols,!1)}_setCellUnderline(B,J,ie,fe,_e,Y){ie<0&&(B=0),fe<0&&(J=0);const R=this._bufferService.rows-1;ie=Math.max(Math.min(ie,R),0),fe=Math.max(Math.min(fe,R),0),_e=Math.min(_e,this._bufferService.cols);const M=this._bufferService.buffer,A=M.ybase+M.y,j=Math.min(M.x,_e-1),Z=this._optionsService.rawOptions.cursorBlink,he=this._optionsService.rawOptions.cursorStyle,me=this._optionsService.rawOptions.cursorInactiveStyle;for(let ve=ie;ve<=fe;++ve){const W=ve+M.ydisp,D=this._rowElements[ve],oe=M.lines.get(W);if(!D||!oe)break;D.replaceChildren(...this._rowFactory.createRow(oe,W,W===A,he,me,j,Z,this.dimensions.css.cell.width,this._widthCache,Y?ve===ie?B:0:-1,Y?(ve===fe?J:_e)-1:-1))}}};c.DomRenderer=U=g([x(7,f.IInstantiationService),x(8,o.ICharSizeService),x(9,f.IOptionsService),x(10,f.IBufferService),x(11,o.ICoreBrowserService),x(12,o.IThemeService)],U)},3787:function(q,c,u){var g=this&&this.__decorate||function(C,E,y,P){var O,F=arguments.length,U=F<3?E:P===null?P=Object.getOwnPropertyDescriptor(E,y):P;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(C,E,y,P);else for(var B=C.length-1;B>=0;B--)(O=C[B])&&(U=(F<3?O(U):F>3?O(E,y,U):O(E,y))||U);return F>3&&U&&Object.defineProperty(E,y,U),U},x=this&&this.__param||function(C,E){return function(y,P){E(y,P,C)}};Object.defineProperty(c,"__esModule",{value:!0}),c.DomRendererRowFactory=void 0;const h=u(2223),v=u(643),w=u(511),k=u(2585),_=u(8055),o=u(4725),a=u(4269),n=u(6171),i=u(3734);let f=c.DomRendererRowFactory=class{constructor(C,E,y,P,O,F,U){this._document=C,this._characterJoinerService=E,this._optionsService=y,this._coreBrowserService=P,this._coreService=O,this._decorationService=F,this._themeService=U,this._workCell=new w.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(C,E,y){this._selectionStart=C,this._selectionEnd=E,this._columnSelectMode=y}createRow(C,E,y,P,O,F,U,B,J,ie,fe){const _e=[],Y=this._characterJoinerService.getJoinedCharacters(E),R=this._themeService.colors;let M,A=C.getNoBgTrimmedLength();y&&A<F+1&&(A=F+1);let j=0,Z="",he=0,me=0,ve=0,W=!1,D=0,oe=!1,ee=0;const xe=[],Ce=ie!==-1&&fe!==-1;for(let Ke=0;Ke<A;Ke++){C.loadCell(Ke,this._workCell);let Xe=this._workCell.getWidth();if(Xe===0)continue;let ft=!1,gt=Ke,Ae=this._workCell;if(Y.length>0&&Ke===Y[0][0]){ft=!0;const nt=Y.shift();Ae=new a.JoinedCellData(this._workCell,C.translateToString(!0,nt[0],nt[1]),nt[1]-nt[0]),gt=nt[1]-1,Xe=Ae.getWidth()}const Ht=this._isCellInSelection(Ke,E),Nt=y&&Ke===F,sr=Ce&&Ke>=ie&&Ke<=fe;let kt=!1;this._decorationService.forEachDecorationAtCell(Ke,E,void 0,(nt=>{kt=!0}));let De=Ae.getChars()||v.WHITESPACE_CELL_CHAR;if(De===" "&&(Ae.isUnderline()||Ae.isOverline())&&(De=""),ee=Xe*B-J.get(De,Ae.isBold(),Ae.isItalic()),M){if(j&&(Ht&&oe||!Ht&&!oe&&Ae.bg===he)&&(Ht&&oe&&R.selectionForeground||Ae.fg===me)&&Ae.extended.ext===ve&&sr===W&&ee===D&&!Nt&&!ft&&!kt){Ae.isInvisible()?Z+=v.WHITESPACE_CELL_CHAR:Z+=De,j++;continue}j&&(M.textContent=Z),M=this._document.createElement("span"),j=0,Z=""}else M=this._document.createElement("span");if(he=Ae.bg,me=Ae.fg,ve=Ae.extended.ext,W=sr,D=ee,oe=Ht,ft&&F>=Ke&&F<=gt&&(F=Ke),!this._coreService.isCursorHidden&&Nt&&this._coreService.isCursorInitialized){if(xe.push("xterm-cursor"),this._coreBrowserService.isFocused)U&&xe.push("xterm-cursor-blink"),xe.push(P==="bar"?"xterm-cursor-bar":P==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(O)switch(O){case"outline":xe.push("xterm-cursor-outline");break;case"block":xe.push("xterm-cursor-block");break;case"bar":xe.push("xterm-cursor-bar");break;case"underline":xe.push("xterm-cursor-underline")}}if(Ae.isBold()&&xe.push("xterm-bold"),Ae.isItalic()&&xe.push("xterm-italic"),Ae.isDim()&&xe.push("xterm-dim"),Z=Ae.isInvisible()?v.WHITESPACE_CELL_CHAR:Ae.getChars()||v.WHITESPACE_CELL_CHAR,Ae.isUnderline()&&(xe.push(`xterm-underline-${Ae.extended.underlineStyle}`),Z===" "&&(Z=""),!Ae.isUnderlineColorDefault()))if(Ae.isUnderlineColorRGB())M.style.textDecorationColor=`rgb(${i.AttributeData.toColorRGB(Ae.getUnderlineColor()).join(",")})`;else{let nt=Ae.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&Ae.isBold()&&nt<8&&(nt+=8),M.style.textDecorationColor=R.ansi[nt].css}Ae.isOverline()&&(xe.push("xterm-overline"),Z===" "&&(Z="")),Ae.isStrikethrough()&&xe.push("xterm-strikethrough"),sr&&(M.style.textDecoration="underline");let Qe=Ae.getFgColor(),ir=Ae.getFgColorMode(),Mt=Ae.getBgColor(),or=Ae.getBgColorMode();const Re=!!Ae.isInverse();if(Re){const nt=Qe;Qe=Mt,Mt=nt;const Qt=ir;ir=or,or=Qt}let ct,mt,Ue,ut=!1;switch(this._decorationService.forEachDecorationAtCell(Ke,E,void 0,(nt=>{nt.options.layer!=="top"&&ut||(nt.backgroundColorRGB&&(or=50331648,Mt=nt.backgroundColorRGB.rgba>>8&16777215,ct=nt.backgroundColorRGB),nt.foregroundColorRGB&&(ir=50331648,Qe=nt.foregroundColorRGB.rgba>>8&16777215,mt=nt.foregroundColorRGB),ut=nt.options.layer==="top")})),!ut&&Ht&&(ct=this._coreBrowserService.isFocused?R.selectionBackgroundOpaque:R.selectionInactiveBackgroundOpaque,Mt=ct.rgba>>8&16777215,or=50331648,ut=!0,R.selectionForeground&&(ir=50331648,Qe=R.selectionForeground.rgba>>8&16777215,mt=R.selectionForeground)),ut&&xe.push("xterm-decoration-top"),or){case 16777216:case 33554432:Ue=R.ansi[Mt],xe.push(`xterm-bg-${Mt}`);break;case 50331648:Ue=_.channels.toColor(Mt>>16,Mt>>8&255,255&Mt),this._addStyle(M,`background-color:#${S((Mt>>>0).toString(16),"0",6)}`);break;default:Re?(Ue=R.foreground,xe.push(`xterm-bg-${h.INVERTED_DEFAULT_COLOR}`)):Ue=R.background}switch(ct||Ae.isDim()&&(ct=_.color.multiplyOpacity(Ue,.5)),ir){case 16777216:case 33554432:Ae.isBold()&&Qe<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(Qe+=8),this._applyMinimumContrast(M,Ue,R.ansi[Qe],Ae,ct,void 0)||xe.push(`xterm-fg-${Qe}`);break;case 50331648:const nt=_.channels.toColor(Qe>>16&255,Qe>>8&255,255&Qe);this._applyMinimumContrast(M,Ue,nt,Ae,ct,mt)||this._addStyle(M,`color:#${S(Qe.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(M,Ue,R.foreground,Ae,ct,mt)||Re&&xe.push(`xterm-fg-${h.INVERTED_DEFAULT_COLOR}`)}xe.length&&(M.className=xe.join(" "),xe.length=0),Nt||ft||kt?M.textContent=Z:j++,ee!==this.defaultSpacing&&(M.style.letterSpacing=`${ee}px`),_e.push(M),Ke=gt}return M&&j&&(M.textContent=Z),_e}_applyMinimumContrast(C,E,y,P,O,F){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,n.treatGlyphAsBackgroundColor)(P.getCode()))return!1;const U=this._getContrastCache(P);let B;if(O||F||(B=U.getColor(E.rgba,y.rgba)),B===void 0){const J=this._optionsService.rawOptions.minimumContrastRatio/(P.isDim()?2:1);B=_.color.ensureContrastRatio(O||E,F||y,J),U.setColor((O||E).rgba,(F||y).rgba,B??null)}return!!B&&(this._addStyle(C,`color:${B.css}`),!0)}_getContrastCache(C){return C.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(C,E){C.setAttribute("style",`${C.getAttribute("style")||""}${E};`)}_isCellInSelection(C,E){const y=this._selectionStart,P=this._selectionEnd;return!(!y||!P)&&(this._columnSelectMode?y[0]<=P[0]?C>=y[0]&&E>=y[1]&&C<P[0]&&E<=P[1]:C<y[0]&&E>=y[1]&&C>=P[0]&&E<=P[1]:E>y[1]&&E<P[1]||y[1]===P[1]&&E===y[1]&&C>=y[0]&&C<P[0]||y[1]<P[1]&&E===P[1]&&C<P[0]||y[1]<P[1]&&E===y[1]&&C>=y[0])}};function S(C,E,y){for(;C.length<y;)C=E+C;return C}c.DomRendererRowFactory=f=g([x(1,o.ICharacterJoinerService),x(2,k.IOptionsService),x(3,o.ICoreBrowserService),x(4,k.ICoreService),x(5,k.IDecorationService),x(6,o.IThemeService)],f)},2550:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.WidthCache=void 0,c.WidthCache=class{constructor(u,g){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=u.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const x=u.createElement("span");x.classList.add("xterm-char-measure-element");const h=u.createElement("span");h.classList.add("xterm-char-measure-element"),h.style.fontWeight="bold";const v=u.createElement("span");v.classList.add("xterm-char-measure-element"),v.style.fontStyle="italic";const w=u.createElement("span");w.classList.add("xterm-char-measure-element"),w.style.fontWeight="bold",w.style.fontStyle="italic",this._measureElements=[x,h,v,w],this._container.appendChild(x),this._container.appendChild(h),this._container.appendChild(v),this._container.appendChild(w),g.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(u,g,x,h){u===this._font&&g===this._fontSize&&x===this._weight&&h===this._weightBold||(this._font=u,this._fontSize=g,this._weight=x,this._weightBold=h,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${x}`,this._measureElements[1].style.fontWeight=`${h}`,this._measureElements[2].style.fontWeight=`${x}`,this._measureElements[3].style.fontWeight=`${h}`,this.clear())}get(u,g,x){let h=0;if(!g&&!x&&u.length===1&&(h=u.charCodeAt(0))<256){if(this._flat[h]!==-9999)return this._flat[h];const k=this._measure(u,0);return k>0&&(this._flat[h]=k),k}let v=u;g&&(v+="B"),x&&(v+="I");let w=this._holey.get(v);if(w===void 0){let k=0;g&&(k|=1),x&&(k|=2),w=this._measure(u,k),w>0&&this._holey.set(v,w)}return w}_measure(u,g){const x=this._measureElements[g];return x.textContent=u.repeat(32),x.offsetWidth/32}}},2223:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.TEXT_BASELINE=c.DIM_OPACITY=c.INVERTED_DEFAULT_COLOR=void 0;const g=u(6114);c.INVERTED_DEFAULT_COLOR=257,c.DIM_OPACITY=.5,c.TEXT_BASELINE=g.isFirefox||g.isLegacyEdge?"bottom":"ideographic"},6171:(q,c)=>{function u(x){return 57508<=x&&x<=57558}function g(x){return x>=128512&&x<=128591||x>=127744&&x<=128511||x>=128640&&x<=128767||x>=9728&&x<=9983||x>=9984&&x<=10175||x>=65024&&x<=65039||x>=129280&&x<=129535||x>=127462&&x<=127487}Object.defineProperty(c,"__esModule",{value:!0}),c.computeNextVariantOffset=c.createRenderDimensions=c.treatGlyphAsBackgroundColor=c.allowRescaling=c.isEmoji=c.isRestrictedPowerlineGlyph=c.isPowerlineGlyph=c.throwIfFalsy=void 0,c.throwIfFalsy=function(x){if(!x)throw new Error("value must not be falsy");return x},c.isPowerlineGlyph=u,c.isRestrictedPowerlineGlyph=function(x){return 57520<=x&&x<=57527},c.isEmoji=g,c.allowRescaling=function(x,h,v,w){return h===1&&v>Math.ceil(1.5*w)&&x!==void 0&&x>255&&!g(x)&&!u(x)&&!(function(k){return 57344<=k&&k<=63743})(x)},c.treatGlyphAsBackgroundColor=function(x){return u(x)||(function(h){return 9472<=h&&h<=9631})(x)},c.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},c.computeNextVariantOffset=function(x,h,v=0){return(x-(2*Math.round(h)-v))%(2*Math.round(h))}},6052:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.createSelectionRenderModel=void 0;class u{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(x,h,v,w=!1){if(this.selectionStart=h,this.selectionEnd=v,!h||!v||h[0]===v[0]&&h[1]===v[1])return void this.clear();const k=x.buffers.active.ydisp,_=h[1]-k,o=v[1]-k,a=Math.max(_,0),n=Math.min(o,x.rows-1);a>=x.rows||n<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=w,this.viewportStartRow=_,this.viewportEndRow=o,this.viewportCappedStartRow=a,this.viewportCappedEndRow=n,this.startCol=h[0],this.endCol=v[0])}isCellSelected(x,h,v){return!!this.hasSelection&&(v-=x.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?h>=this.startCol&&v>=this.viewportCappedStartRow&&h<this.endCol&&v<=this.viewportCappedEndRow:h<this.startCol&&v>=this.viewportCappedStartRow&&h>=this.endCol&&v<=this.viewportCappedEndRow:v>this.viewportStartRow&&v<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&v===this.viewportStartRow&&h>=this.startCol&&h<this.endCol||this.viewportStartRow<this.viewportEndRow&&v===this.viewportEndRow&&h<this.endCol||this.viewportStartRow<this.viewportEndRow&&v===this.viewportStartRow&&h>=this.startCol)}}c.createSelectionRenderModel=function(){return new u}},456:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SelectionModel=void 0,c.SelectionModel=class{constructor(u){this._bufferService=u,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const u=this.selectionStart[0]+this.selectionStartLength;return u>this._bufferService.cols?u%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(u/this._bufferService.cols)-1]:[u%this._bufferService.cols,this.selectionStart[1]+Math.floor(u/this._bufferService.cols)]:[u,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const u=this.selectionStart[0]+this.selectionStartLength;return u>this._bufferService.cols?[u%this._bufferService.cols,this.selectionStart[1]+Math.floor(u/this._bufferService.cols)]:[Math.max(u,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const u=this.selectionStart,g=this.selectionEnd;return!(!u||!g)&&(u[1]>g[1]||u[1]===g[1]&&u[0]>g[0])}handleTrim(u){return this.selectionStart&&(this.selectionStart[1]-=u),this.selectionEnd&&(this.selectionEnd[1]-=u),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(q,c,u){var g=this&&this.__decorate||function(n,i,f,S){var C,E=arguments.length,y=E<3?i:S===null?S=Object.getOwnPropertyDescriptor(i,f):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(n,i,f,S);else for(var P=n.length-1;P>=0;P--)(C=n[P])&&(y=(E<3?C(y):E>3?C(i,f,y):C(i,f))||y);return E>3&&y&&Object.defineProperty(i,f,y),y},x=this&&this.__param||function(n,i){return function(f,S){i(f,S,n)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CharSizeService=void 0;const h=u(2585),v=u(8460),w=u(844);let k=c.CharSizeService=class extends w.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(n,i,f){super(),this._optionsService=f,this.width=0,this.height=0,this._onCharSizeChange=this.register(new v.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new a(this._optionsService))}catch{this._measureStrategy=this.register(new o(n,i,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],(()=>this.measure())))}measure(){const n=this._measureStrategy.measure();n.width===this.width&&n.height===this.height||(this.width=n.width,this.height=n.height,this._onCharSizeChange.fire())}};c.CharSizeService=k=g([x(2,h.IOptionsService)],k);class _ extends w.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(i,f){i!==void 0&&i>0&&f!==void 0&&f>0&&(this._result.width=i,this._result.height=f)}}class o extends _{constructor(i,f,S){super(),this._document=i,this._parentElement=f,this._optionsService=S,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class a extends _{constructor(i){super(),this._optionsService=i,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const f=this._ctx.measureText("W");if(!("width"in f&&"fontBoundingBoxAscent"in f&&"fontBoundingBoxDescent"in f))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const i=this._ctx.measureText("W");return this._validateAndSet(i.width,i.fontBoundingBoxAscent+i.fontBoundingBoxDescent),this._result}}},4269:function(q,c,u){var g=this&&this.__decorate||function(a,n,i,f){var S,C=arguments.length,E=C<3?n:f===null?f=Object.getOwnPropertyDescriptor(n,i):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(a,n,i,f);else for(var y=a.length-1;y>=0;y--)(S=a[y])&&(E=(C<3?S(E):C>3?S(n,i,E):S(n,i))||E);return C>3&&E&&Object.defineProperty(n,i,E),E},x=this&&this.__param||function(a,n){return function(i,f){n(i,f,a)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CharacterJoinerService=c.JoinedCellData=void 0;const h=u(3734),v=u(643),w=u(511),k=u(2585);class _ extends h.AttributeData{constructor(n,i,f){super(),this.content=0,this.combinedData="",this.fg=n.fg,this.bg=n.bg,this.combinedData=i,this._width=f}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(n){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}c.JoinedCellData=_;let o=c.CharacterJoinerService=class ph{constructor(n){this._bufferService=n,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new w.CellData}register(n){const i={id:this._nextCharacterJoinerId++,handler:n};return this._characterJoiners.push(i),i.id}deregister(n){for(let i=0;i<this._characterJoiners.length;i++)if(this._characterJoiners[i].id===n)return this._characterJoiners.splice(i,1),!0;return!1}getJoinedCharacters(n){if(this._characterJoiners.length===0)return[];const i=this._bufferService.buffer.lines.get(n);if(!i||i.length===0)return[];const f=[],S=i.translateToString(!0);let C=0,E=0,y=0,P=i.getFg(0),O=i.getBg(0);for(let F=0;F<i.getTrimmedLength();F++)if(i.loadCell(F,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==P||this._workCell.bg!==O){if(F-C>1){const U=this._getJoinedRanges(S,y,E,i,C);for(let B=0;B<U.length;B++)f.push(U[B])}C=F,y=E,P=this._workCell.fg,O=this._workCell.bg}E+=this._workCell.getChars().length||v.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-C>1){const F=this._getJoinedRanges(S,y,E,i,C);for(let U=0;U<F.length;U++)f.push(F[U])}return f}_getJoinedRanges(n,i,f,S,C){const E=n.substring(i,f);let y=[];try{y=this._characterJoiners[0].handler(E)}catch(P){console.error(P)}for(let P=1;P<this._characterJoiners.length;P++)try{const O=this._characterJoiners[P].handler(E);for(let F=0;F<O.length;F++)ph._mergeRanges(y,O[F])}catch(O){console.error(O)}return this._stringRangesToCellRanges(y,S,C),y}_stringRangesToCellRanges(n,i,f){let S=0,C=!1,E=0,y=n[S];if(y){for(let P=f;P<this._bufferService.cols;P++){const O=i.getWidth(P),F=i.getString(P).length||v.WHITESPACE_CELL_CHAR.length;if(O!==0){if(!C&&y[0]<=E&&(y[0]=P,C=!0),y[1]<=E){if(y[1]=P,y=n[++S],!y)break;y[0]<=E?(y[0]=P,C=!0):C=!1}E+=F}}y&&(y[1]=this._bufferService.cols)}}static _mergeRanges(n,i){let f=!1;for(let S=0;S<n.length;S++){const C=n[S];if(f){if(i[1]<=C[0])return n[S-1][1]=i[1],n;if(i[1]<=C[1])return n[S-1][1]=Math.max(i[1],C[1]),n.splice(S,1),n;n.splice(S,1),S--}else{if(i[1]<=C[0])return n.splice(S,0,i),n;if(i[1]<=C[1])return C[0]=Math.min(i[0],C[0]),n;i[0]<C[1]&&(C[0]=Math.min(i[0],C[0]),f=!0)}}return f?n[n.length-1][1]=i[1]:n.push(i),n}};c.CharacterJoinerService=o=g([x(0,k.IBufferService)],o)},5114:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CoreBrowserService=void 0;const g=u(844),x=u(8460),h=u(3656);class v extends g.Disposable{constructor(_,o,a){super(),this._textarea=_,this._window=o,this.mainDocument=a,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new w(this._window),this._onDprChange=this.register(new x.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new x.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange((n=>this._screenDprMonitor.setWindow(n)))),this.register((0,x.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",(()=>this._isFocused=!0)),this._textarea.addEventListener("blur",(()=>this._isFocused=!1))}get window(){return this._window}set window(_){this._window!==_&&(this._window=_,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask((()=>this._cachedIsFocused=void 0))),this._cachedIsFocused}}c.CoreBrowserService=v;class w extends g.Disposable{constructor(_){super(),this._parentWindow=_,this._windowResizeListener=this.register(new g.MutableDisposable),this._onDprChange=this.register(new x.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,g.toDisposable)((()=>this.clearListener())))}setWindow(_){this._parentWindow=_,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,h.addDisposableDomListener)(this._parentWindow,"resize",(()=>this._setDprAndFireIfDiffers()))}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){var _;this._outerListener&&((_=this._resolutionMediaMatchList)==null||_.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.LinkProviderService=void 0;const g=u(844);class x extends g.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,g.toDisposable)((()=>this.linkProviders.length=0)))}registerLinkProvider(v){return this.linkProviders.push(v),{dispose:()=>{const w=this.linkProviders.indexOf(v);w!==-1&&this.linkProviders.splice(w,1)}}}}c.LinkProviderService=x},8934:function(q,c,u){var g=this&&this.__decorate||function(k,_,o,a){var n,i=arguments.length,f=i<3?_:a===null?a=Object.getOwnPropertyDescriptor(_,o):a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(k,_,o,a);else for(var S=k.length-1;S>=0;S--)(n=k[S])&&(f=(i<3?n(f):i>3?n(_,o,f):n(_,o))||f);return i>3&&f&&Object.defineProperty(_,o,f),f},x=this&&this.__param||function(k,_){return function(o,a){_(o,a,k)}};Object.defineProperty(c,"__esModule",{value:!0}),c.MouseService=void 0;const h=u(4725),v=u(9806);let w=c.MouseService=class{constructor(k,_){this._renderService=k,this._charSizeService=_}getCoords(k,_,o,a,n){return(0,v.getCoords)(window,k,_,o,a,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,n)}getMouseReportCoords(k,_){const o=(0,v.getCoordsRelativeToElement)(window,k,_);if(this._charSizeService.hasValidSize)return o[0]=Math.min(Math.max(o[0],0),this._renderService.dimensions.css.canvas.width-1),o[1]=Math.min(Math.max(o[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(o[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(o[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(o[0]),y:Math.floor(o[1])}}};c.MouseService=w=g([x(0,h.IRenderService),x(1,h.ICharSizeService)],w)},3230:function(q,c,u){var g=this&&this.__decorate||function(n,i,f,S){var C,E=arguments.length,y=E<3?i:S===null?S=Object.getOwnPropertyDescriptor(i,f):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(n,i,f,S);else for(var P=n.length-1;P>=0;P--)(C=n[P])&&(y=(E<3?C(y):E>3?C(i,f,y):C(i,f))||y);return E>3&&y&&Object.defineProperty(i,f,y),y},x=this&&this.__param||function(n,i){return function(f,S){i(f,S,n)}};Object.defineProperty(c,"__esModule",{value:!0}),c.RenderService=void 0;const h=u(6193),v=u(4725),w=u(8460),k=u(844),_=u(7226),o=u(2585);let a=c.RenderService=class extends k.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(n,i,f,S,C,E,y,P){super(),this._rowCount=n,this._charSizeService=S,this._renderer=this.register(new k.MutableDisposable),this._pausedResizeTask=new _.DebouncedIdleTask,this._observerDisposable=this.register(new k.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new w.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new w.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new w.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new w.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new h.RenderDebouncer(((O,F)=>this._renderRows(O,F)),y),this.register(this._renderDebouncer),this.register(y.onDprChange((()=>this.handleDevicePixelRatioChange()))),this.register(E.onResize((()=>this._fullRefresh()))),this.register(E.buffers.onBufferActivate((()=>{var O;return(O=this._renderer.value)==null?void 0:O.clear()}))),this.register(f.onOptionChange((()=>this._handleOptionsChanged()))),this.register(this._charSizeService.onCharSizeChange((()=>this.handleCharSizeChanged()))),this.register(C.onDecorationRegistered((()=>this._fullRefresh()))),this.register(C.onDecorationRemoved((()=>this._fullRefresh()))),this.register(f.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],(()=>{this.clear(),this.handleResize(E.cols,E.rows),this._fullRefresh()}))),this.register(f.onMultipleOptionChange(["cursorBlink","cursorStyle"],(()=>this.refreshRows(E.buffer.y,E.buffer.y,!0)))),this.register(P.onChangeColors((()=>this._fullRefresh()))),this._registerIntersectionObserver(y.window,i),this.register(y.onWindowChange((O=>this._registerIntersectionObserver(O,i))))}_registerIntersectionObserver(n,i){if("IntersectionObserver"in n){const f=new n.IntersectionObserver((S=>this._handleIntersectionChange(S[S.length-1])),{threshold:0});f.observe(i),this._observerDisposable.value=(0,k.toDisposable)((()=>f.disconnect()))}}_handleIntersectionChange(n){this._isPaused=n.isIntersecting===void 0?n.intersectionRatio===0:!n.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(n,i,f=!1){this._isPaused?this._needsFullRefresh=!0:(f||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(n,i,this._rowCount))}_renderRows(n,i){this._renderer.value&&(n=Math.min(n,this._rowCount-1),i=Math.min(i,this._rowCount-1),this._renderer.value.renderRows(n,i),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:n,end:i}),this._onRender.fire({start:n,end:i}),this._isNextRenderRedrawOnly=!0)}resize(n,i){this._rowCount=i,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(n){this._renderer.value=n,this._renderer.value&&(this._renderer.value.onRequestRedraw((i=>this.refreshRows(i.start,i.end,!0))),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(n){return this._renderDebouncer.addRefreshCallback(n)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var n,i;this._renderer.value&&((i=(n=this._renderer.value).clearTextureAtlas)==null||i.call(n),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(n,i){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set((()=>{var f;return(f=this._renderer.value)==null?void 0:f.handleResize(n,i)})):this._renderer.value.handleResize(n,i),this._fullRefresh())}handleCharSizeChanged(){var n;(n=this._renderer.value)==null||n.handleCharSizeChanged()}handleBlur(){var n;(n=this._renderer.value)==null||n.handleBlur()}handleFocus(){var n;(n=this._renderer.value)==null||n.handleFocus()}handleSelectionChanged(n,i,f){var S;this._selectionState.start=n,this._selectionState.end=i,this._selectionState.columnSelectMode=f,(S=this._renderer.value)==null||S.handleSelectionChanged(n,i,f)}handleCursorMove(){var n;(n=this._renderer.value)==null||n.handleCursorMove()}clear(){var n;(n=this._renderer.value)==null||n.clear()}};c.RenderService=a=g([x(2,o.IOptionsService),x(3,v.ICharSizeService),x(4,o.IDecorationService),x(5,o.IBufferService),x(6,v.ICoreBrowserService),x(7,v.IThemeService)],a)},9312:function(q,c,u){var g=this&&this.__decorate||function(y,P,O,F){var U,B=arguments.length,J=B<3?P:F===null?F=Object.getOwnPropertyDescriptor(P,O):F;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")J=Reflect.decorate(y,P,O,F);else for(var ie=y.length-1;ie>=0;ie--)(U=y[ie])&&(J=(B<3?U(J):B>3?U(P,O,J):U(P,O))||J);return B>3&&J&&Object.defineProperty(P,O,J),J},x=this&&this.__param||function(y,P){return function(O,F){P(O,F,y)}};Object.defineProperty(c,"__esModule",{value:!0}),c.SelectionService=void 0;const h=u(9806),v=u(9504),w=u(456),k=u(4725),_=u(8460),o=u(844),a=u(6114),n=u(4841),i=u(511),f=u(2585),S="",C=new RegExp(S,"g");let E=c.SelectionService=class extends o.Disposable{constructor(y,P,O,F,U,B,J,ie,fe){super(),this._element=y,this._screenElement=P,this._linkifier=O,this._bufferService=F,this._coreService=U,this._mouseService=B,this._optionsService=J,this._renderService=ie,this._coreBrowserService=fe,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new i.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new _.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new _.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new _.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new _.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=_e=>this._handleMouseMove(_e),this._mouseUpListener=_e=>this._handleMouseUp(_e),this._coreService.onUserInput((()=>{this.hasSelection&&this.clearSelection()})),this._trimListener=this._bufferService.buffer.lines.onTrim((_e=>this._handleTrim(_e))),this.register(this._bufferService.buffers.onBufferActivate((_e=>this._handleBufferActivate(_e)))),this.enable(),this._model=new w.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,o.toDisposable)((()=>{this._removeMouseDownListeners()})))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const y=this._model.finalSelectionStart,P=this._model.finalSelectionEnd;return!(!y||!P||y[0]===P[0]&&y[1]===P[1])}get selectionText(){const y=this._model.finalSelectionStart,P=this._model.finalSelectionEnd;if(!y||!P)return"";const O=this._bufferService.buffer,F=[];if(this._activeSelectionMode===3){if(y[0]===P[0])return"";const U=y[0]<P[0]?y[0]:P[0],B=y[0]<P[0]?P[0]:y[0];for(let J=y[1];J<=P[1];J++){const ie=O.translateBufferLineToString(J,!0,U,B);F.push(ie)}}else{const U=y[1]===P[1]?P[0]:void 0;F.push(O.translateBufferLineToString(y[1],!0,y[0],U));for(let B=y[1]+1;B<=P[1]-1;B++){const J=O.lines.get(B),ie=O.translateBufferLineToString(B,!0);J!=null&&J.isWrapped?F[F.length-1]+=ie:F.push(ie)}if(y[1]!==P[1]){const B=O.lines.get(P[1]),J=O.translateBufferLineToString(P[1],!0,0,P[0]);B&&B.isWrapped?F[F.length-1]+=J:F.push(J)}}return F.map((U=>U.replace(C," "))).join(a.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(y){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame((()=>this._refresh()))),a.isLinux&&y&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(y){const P=this._getMouseBufferCoords(y),O=this._model.finalSelectionStart,F=this._model.finalSelectionEnd;return!!(O&&F&&P)&&this._areCoordsInSelection(P,O,F)}isCellInSelection(y,P){const O=this._model.finalSelectionStart,F=this._model.finalSelectionEnd;return!(!O||!F)&&this._areCoordsInSelection([y,P],O,F)}_areCoordsInSelection(y,P,O){return y[1]>P[1]&&y[1]<O[1]||P[1]===O[1]&&y[1]===P[1]&&y[0]>=P[0]&&y[0]<O[0]||P[1]<O[1]&&y[1]===O[1]&&y[0]<O[0]||P[1]<O[1]&&y[1]===P[1]&&y[0]>=P[0]}_selectWordAtCursor(y,P){var U,B;const O=(B=(U=this._linkifier.currentLink)==null?void 0:U.link)==null?void 0:B.range;if(O)return this._model.selectionStart=[O.start.x-1,O.start.y-1],this._model.selectionStartLength=(0,n.getRangeLength)(O,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const F=this._getMouseBufferCoords(y);return!!F&&(this._selectWordAt(F,P),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(y,P){this._model.clearSelection(),y=Math.max(y,0),P=Math.min(P,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,y],this._model.selectionEnd=[this._bufferService.cols,P],this.refresh(),this._onSelectionChange.fire()}_handleTrim(y){this._model.handleTrim(y)&&this.refresh()}_getMouseBufferCoords(y){const P=this._mouseService.getCoords(y,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(P)return P[0]--,P[1]--,P[1]+=this._bufferService.buffer.ydisp,P}_getMouseEventScrollAmount(y){let P=(0,h.getCoordsRelativeToElement)(this._coreBrowserService.window,y,this._screenElement)[1];const O=this._renderService.dimensions.css.canvas.height;return P>=0&&P<=O?0:(P>O&&(P-=O),P=Math.min(Math.max(P,-50),50),P/=50,P/Math.abs(P)+Math.round(14*P))}shouldForceSelection(y){return a.isMac?y.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:y.shiftKey}handleMouseDown(y){if(this._mouseDownTimeStamp=y.timeStamp,(y.button!==2||!this.hasSelection)&&y.button===0){if(!this._enabled){if(!this.shouldForceSelection(y))return;y.stopPropagation()}y.preventDefault(),this._dragScrollAmount=0,this._enabled&&y.shiftKey?this._handleIncrementalClick(y):y.detail===1?this._handleSingleClick(y):y.detail===2?this._handleDoubleClick(y):y.detail===3&&this._handleTripleClick(y),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval((()=>this._dragScroll()),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(y){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(y))}_handleSingleClick(y){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(y)?3:0,this._model.selectionStart=this._getMouseBufferCoords(y),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const P=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);P&&P.length!==this._model.selectionStart[0]&&P.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(y){this._selectWordAtCursor(y,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(y){const P=this._getMouseBufferCoords(y);P&&(this._activeSelectionMode=2,this._selectLineAt(P[1]))}shouldColumnSelect(y){return y.altKey&&!(a.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(y){if(y.stopImmediatePropagation(),!this._model.selectionStart)return;const P=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(y),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(y),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const O=this._bufferService.buffer;if(this._model.selectionEnd[1]<O.lines.length){const F=O.lines.get(this._model.selectionEnd[1]);F&&F.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}P&&P[0]===this._model.selectionEnd[0]&&P[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const y=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(y.ydisp+this._bufferService.rows,y.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=y.ydisp),this.refresh()}}_handleMouseUp(y){const P=y.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&P<500&&y.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const O=this._mouseService.getCoords(y,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(O&&O[0]!==void 0&&O[1]!==void 0){const F=(0,v.moveToCellSequence)(O[0]-1,O[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(F,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const y=this._model.finalSelectionStart,P=this._model.finalSelectionEnd,O=!(!y||!P||y[0]===P[0]&&y[1]===P[1]);O?y&&P&&(this._oldSelectionStart&&this._oldSelectionEnd&&y[0]===this._oldSelectionStart[0]&&y[1]===this._oldSelectionStart[1]&&P[0]===this._oldSelectionEnd[0]&&P[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(y,P,O)):this._oldHasSelection&&this._fireOnSelectionChange(y,P,O)}_fireOnSelectionChange(y,P,O){this._oldSelectionStart=y,this._oldSelectionEnd=P,this._oldHasSelection=O,this._onSelectionChange.fire()}_handleBufferActivate(y){this.clearSelection(),this._trimListener.dispose(),this._trimListener=y.activeBuffer.lines.onTrim((P=>this._handleTrim(P)))}_convertViewportColToCharacterIndex(y,P){let O=P;for(let F=0;P>=F;F++){const U=y.loadCell(F,this._workCell).getChars().length;this._workCell.getWidth()===0?O--:U>1&&P!==F&&(O+=U-1)}return O}setSelection(y,P,O){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[y,P],this._model.selectionStartLength=O,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(y){this._isClickInSelection(y)||(this._selectWordAtCursor(y,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(y,P,O=!0,F=!0){if(y[0]>=this._bufferService.cols)return;const U=this._bufferService.buffer,B=U.lines.get(y[1]);if(!B)return;const J=U.translateBufferLineToString(y[1],!1);let ie=this._convertViewportColToCharacterIndex(B,y[0]),fe=ie;const _e=y[0]-ie;let Y=0,R=0,M=0,A=0;if(J.charAt(ie)===" "){for(;ie>0&&J.charAt(ie-1)===" ";)ie--;for(;fe<J.length&&J.charAt(fe+1)===" ";)fe++}else{let he=y[0],me=y[0];B.getWidth(he)===0&&(Y++,he--),B.getWidth(me)===2&&(R++,me++);const ve=B.getString(me).length;for(ve>1&&(A+=ve-1,fe+=ve-1);he>0&&ie>0&&!this._isCharWordSeparator(B.loadCell(he-1,this._workCell));){B.loadCell(he-1,this._workCell);const W=this._workCell.getChars().length;this._workCell.getWidth()===0?(Y++,he--):W>1&&(M+=W-1,ie-=W-1),ie--,he--}for(;me<B.length&&fe+1<J.length&&!this._isCharWordSeparator(B.loadCell(me+1,this._workCell));){B.loadCell(me+1,this._workCell);const W=this._workCell.getChars().length;this._workCell.getWidth()===2?(R++,me++):W>1&&(A+=W-1,fe+=W-1),fe++,me++}}fe++;let j=ie+_e-Y+M,Z=Math.min(this._bufferService.cols,fe-ie+Y+R-M-A);if(P||J.slice(ie,fe).trim()!==""){if(O&&j===0&&B.getCodePoint(0)!==32){const he=U.lines.get(y[1]-1);if(he&&B.isWrapped&&he.getCodePoint(this._bufferService.cols-1)!==32){const me=this._getWordAt([this._bufferService.cols-1,y[1]-1],!1,!0,!1);if(me){const ve=this._bufferService.cols-me.start;j-=ve,Z+=ve}}}if(F&&j+Z===this._bufferService.cols&&B.getCodePoint(this._bufferService.cols-1)!==32){const he=U.lines.get(y[1]+1);if(he!=null&&he.isWrapped&&he.getCodePoint(0)!==32){const me=this._getWordAt([0,y[1]+1],!1,!1,!0);me&&(Z+=me.length)}}return{start:j,length:Z}}}_selectWordAt(y,P){const O=this._getWordAt(y,P);if(O){for(;O.start<0;)O.start+=this._bufferService.cols,y[1]--;this._model.selectionStart=[O.start,y[1]],this._model.selectionStartLength=O.length}}_selectToWordAt(y){const P=this._getWordAt(y,!0);if(P){let O=y[1];for(;P.start<0;)P.start+=this._bufferService.cols,O--;if(!this._model.areSelectionValuesReversed())for(;P.start+P.length>this._bufferService.cols;)P.length-=this._bufferService.cols,O++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?P.start:P.start+P.length,O]}}_isCharWordSeparator(y){return y.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(y.getChars())>=0}_selectLineAt(y){const P=this._bufferService.buffer.getWrappedRangeForLine(y),O={start:{x:0,y:P.first},end:{x:this._bufferService.cols-1,y:P.last}};this._model.selectionStart=[0,P.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,n.getRangeLength)(O,this._bufferService.cols)}};c.SelectionService=E=g([x(3,f.IBufferService),x(4,f.ICoreService),x(5,k.IMouseService),x(6,f.IOptionsService),x(7,k.IRenderService),x(8,k.ICoreBrowserService)],E)},4725:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ILinkProviderService=c.IThemeService=c.ICharacterJoinerService=c.ISelectionService=c.IRenderService=c.IMouseService=c.ICoreBrowserService=c.ICharSizeService=void 0;const g=u(8343);c.ICharSizeService=(0,g.createDecorator)("CharSizeService"),c.ICoreBrowserService=(0,g.createDecorator)("CoreBrowserService"),c.IMouseService=(0,g.createDecorator)("MouseService"),c.IRenderService=(0,g.createDecorator)("RenderService"),c.ISelectionService=(0,g.createDecorator)("SelectionService"),c.ICharacterJoinerService=(0,g.createDecorator)("CharacterJoinerService"),c.IThemeService=(0,g.createDecorator)("ThemeService"),c.ILinkProviderService=(0,g.createDecorator)("LinkProviderService")},6731:function(q,c,u){var g=this&&this.__decorate||function(E,y,P,O){var F,U=arguments.length,B=U<3?y:O===null?O=Object.getOwnPropertyDescriptor(y,P):O;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(E,y,P,O);else for(var J=E.length-1;J>=0;J--)(F=E[J])&&(B=(U<3?F(B):U>3?F(y,P,B):F(y,P))||B);return U>3&&B&&Object.defineProperty(y,P,B),B},x=this&&this.__param||function(E,y){return function(P,O){y(P,O,E)}};Object.defineProperty(c,"__esModule",{value:!0}),c.ThemeService=c.DEFAULT_ANSI_COLORS=void 0;const h=u(7239),v=u(8055),w=u(8460),k=u(844),_=u(2585),o=v.css.toColor("#ffffff"),a=v.css.toColor("#000000"),n=v.css.toColor("#ffffff"),i=v.css.toColor("#000000"),f={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};c.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const E=[v.css.toColor("#2e3436"),v.css.toColor("#cc0000"),v.css.toColor("#4e9a06"),v.css.toColor("#c4a000"),v.css.toColor("#3465a4"),v.css.toColor("#75507b"),v.css.toColor("#06989a"),v.css.toColor("#d3d7cf"),v.css.toColor("#555753"),v.css.toColor("#ef2929"),v.css.toColor("#8ae234"),v.css.toColor("#fce94f"),v.css.toColor("#729fcf"),v.css.toColor("#ad7fa8"),v.css.toColor("#34e2e2"),v.css.toColor("#eeeeec")],y=[0,95,135,175,215,255];for(let P=0;P<216;P++){const O=y[P/36%6|0],F=y[P/6%6|0],U=y[P%6];E.push({css:v.channels.toCss(O,F,U),rgba:v.channels.toRgba(O,F,U)})}for(let P=0;P<24;P++){const O=8+10*P;E.push({css:v.channels.toCss(O,O,O),rgba:v.channels.toRgba(O,O,O)})}return E})());let S=c.ThemeService=class extends k.Disposable{get colors(){return this._colors}constructor(E){super(),this._optionsService=E,this._contrastCache=new h.ColorContrastCache,this._halfContrastCache=new h.ColorContrastCache,this._onChangeColors=this.register(new w.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:o,background:a,cursor:n,cursorAccent:i,selectionForeground:void 0,selectionBackgroundTransparent:f,selectionBackgroundOpaque:v.color.blend(a,f),selectionInactiveBackgroundTransparent:f,selectionInactiveBackgroundOpaque:v.color.blend(a,f),ansi:c.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",(()=>this._contrastCache.clear()))),this.register(this._optionsService.onSpecificOptionChange("theme",(()=>this._setTheme(this._optionsService.rawOptions.theme))))}_setTheme(E={}){const y=this._colors;if(y.foreground=C(E.foreground,o),y.background=C(E.background,a),y.cursor=C(E.cursor,n),y.cursorAccent=C(E.cursorAccent,i),y.selectionBackgroundTransparent=C(E.selectionBackground,f),y.selectionBackgroundOpaque=v.color.blend(y.background,y.selectionBackgroundTransparent),y.selectionInactiveBackgroundTransparent=C(E.selectionInactiveBackground,y.selectionBackgroundTransparent),y.selectionInactiveBackgroundOpaque=v.color.blend(y.background,y.selectionInactiveBackgroundTransparent),y.selectionForeground=E.selectionForeground?C(E.selectionForeground,v.NULL_COLOR):void 0,y.selectionForeground===v.NULL_COLOR&&(y.selectionForeground=void 0),v.color.isOpaque(y.selectionBackgroundTransparent)&&(y.selectionBackgroundTransparent=v.color.opacity(y.selectionBackgroundTransparent,.3)),v.color.isOpaque(y.selectionInactiveBackgroundTransparent)&&(y.selectionInactiveBackgroundTransparent=v.color.opacity(y.selectionInactiveBackgroundTransparent,.3)),y.ansi=c.DEFAULT_ANSI_COLORS.slice(),y.ansi[0]=C(E.black,c.DEFAULT_ANSI_COLORS[0]),y.ansi[1]=C(E.red,c.DEFAULT_ANSI_COLORS[1]),y.ansi[2]=C(E.green,c.DEFAULT_ANSI_COLORS[2]),y.ansi[3]=C(E.yellow,c.DEFAULT_ANSI_COLORS[3]),y.ansi[4]=C(E.blue,c.DEFAULT_ANSI_COLORS[4]),y.ansi[5]=C(E.magenta,c.DEFAULT_ANSI_COLORS[5]),y.ansi[6]=C(E.cyan,c.DEFAULT_ANSI_COLORS[6]),y.ansi[7]=C(E.white,c.DEFAULT_ANSI_COLORS[7]),y.ansi[8]=C(E.brightBlack,c.DEFAULT_ANSI_COLORS[8]),y.ansi[9]=C(E.brightRed,c.DEFAULT_ANSI_COLORS[9]),y.ansi[10]=C(E.brightGreen,c.DEFAULT_ANSI_COLORS[10]),y.ansi[11]=C(E.brightYellow,c.DEFAULT_ANSI_COLORS[11]),y.ansi[12]=C(E.brightBlue,c.DEFAULT_ANSI_COLORS[12]),y.ansi[13]=C(E.brightMagenta,c.DEFAULT_ANSI_COLORS[13]),y.ansi[14]=C(E.brightCyan,c.DEFAULT_ANSI_COLORS[14]),y.ansi[15]=C(E.brightWhite,c.DEFAULT_ANSI_COLORS[15]),E.extendedAnsi){const P=Math.min(y.ansi.length-16,E.extendedAnsi.length);for(let O=0;O<P;O++)y.ansi[O+16]=C(E.extendedAnsi[O],c.DEFAULT_ANSI_COLORS[O+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(E){this._restoreColor(E),this._onChangeColors.fire(this.colors)}_restoreColor(E){if(E!==void 0)switch(E){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[E]=this._restoreColors.ansi[E]}else for(let y=0;y<this._restoreColors.ansi.length;++y)this._colors.ansi[y]=this._restoreColors.ansi[y]}modifyColors(E){E(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function C(E,y){if(E!==void 0)try{return v.css.toColor(E)}catch{}return y}c.ThemeService=S=g([x(0,_.IOptionsService)],S)},6349:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CircularList=void 0;const g=u(8460),x=u(844);class h extends x.Disposable{constructor(w){super(),this._maxLength=w,this.onDeleteEmitter=this.register(new g.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new g.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new g.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(w){if(this._maxLength===w)return;const k=new Array(w);for(let _=0;_<Math.min(w,this.length);_++)k[_]=this._array[this._getCyclicIndex(_)];this._array=k,this._maxLength=w,this._startIndex=0}get length(){return this._length}set length(w){if(w>this._length)for(let k=this._length;k<w;k++)this._array[k]=void 0;this._length=w}get(w){return this._array[this._getCyclicIndex(w)]}set(w,k){this._array[this._getCyclicIndex(w)]=k}push(w){this._array[this._getCyclicIndex(this._length)]=w,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(w,k,..._){if(k){for(let o=w;o<this._length-k;o++)this._array[this._getCyclicIndex(o)]=this._array[this._getCyclicIndex(o+k)];this._length-=k,this.onDeleteEmitter.fire({index:w,amount:k})}for(let o=this._length-1;o>=w;o--)this._array[this._getCyclicIndex(o+_.length)]=this._array[this._getCyclicIndex(o)];for(let o=0;o<_.length;o++)this._array[this._getCyclicIndex(w+o)]=_[o];if(_.length&&this.onInsertEmitter.fire({index:w,amount:_.length}),this._length+_.length>this._maxLength){const o=this._length+_.length-this._maxLength;this._startIndex+=o,this._length=this._maxLength,this.onTrimEmitter.fire(o)}else this._length+=_.length}trimStart(w){w>this._length&&(w=this._length),this._startIndex+=w,this._length-=w,this.onTrimEmitter.fire(w)}shiftElements(w,k,_){if(!(k<=0)){if(w<0||w>=this._length)throw new Error("start argument out of range");if(w+_<0)throw new Error("Cannot shift elements in list beyond index 0");if(_>0){for(let a=k-1;a>=0;a--)this.set(w+a+_,this.get(w+a));const o=w+k+_-this._length;if(o>0)for(this._length+=o;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let o=0;o<k;o++)this.set(w+o+_,this.get(w+o))}}_getCyclicIndex(w){return(this._startIndex+w)%this._maxLength}}c.CircularList=h},1439:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.clone=void 0,c.clone=function u(g,x=5){if(typeof g!="object")return g;const h=Array.isArray(g)?[]:{};for(const v in g)h[v]=x<=1?g[v]:g[v]&&u(g[v],x-1);return h}},8055:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.contrastRatio=c.toPaddedHex=c.rgba=c.rgb=c.css=c.color=c.channels=c.NULL_COLOR=void 0;let u=0,g=0,x=0,h=0;var v,w,k,_,o;function a(i){const f=i.toString(16);return f.length<2?"0"+f:f}function n(i,f){return i<f?(f+.05)/(i+.05):(i+.05)/(f+.05)}c.NULL_COLOR={css:"#00000000",rgba:0},(function(i){i.toCss=function(f,S,C,E){return E!==void 0?`#${a(f)}${a(S)}${a(C)}${a(E)}`:`#${a(f)}${a(S)}${a(C)}`},i.toRgba=function(f,S,C,E=255){return(f<<24|S<<16|C<<8|E)>>>0},i.toColor=function(f,S,C,E){return{css:i.toCss(f,S,C,E),rgba:i.toRgba(f,S,C,E)}}})(v||(c.channels=v={})),(function(i){function f(S,C){return h=Math.round(255*C),[u,g,x]=o.toChannels(S.rgba),{css:v.toCss(u,g,x,h),rgba:v.toRgba(u,g,x,h)}}i.blend=function(S,C){if(h=(255&C.rgba)/255,h===1)return{css:C.css,rgba:C.rgba};const E=C.rgba>>24&255,y=C.rgba>>16&255,P=C.rgba>>8&255,O=S.rgba>>24&255,F=S.rgba>>16&255,U=S.rgba>>8&255;return u=O+Math.round((E-O)*h),g=F+Math.round((y-F)*h),x=U+Math.round((P-U)*h),{css:v.toCss(u,g,x),rgba:v.toRgba(u,g,x)}},i.isOpaque=function(S){return(255&S.rgba)==255},i.ensureContrastRatio=function(S,C,E){const y=o.ensureContrastRatio(S.rgba,C.rgba,E);if(y)return v.toColor(y>>24&255,y>>16&255,y>>8&255)},i.opaque=function(S){const C=(255|S.rgba)>>>0;return[u,g,x]=o.toChannels(C),{css:v.toCss(u,g,x),rgba:C}},i.opacity=f,i.multiplyOpacity=function(S,C){return h=255&S.rgba,f(S,h*C/255)},i.toColorRGB=function(S){return[S.rgba>>24&255,S.rgba>>16&255,S.rgba>>8&255]}})(w||(c.color=w={})),(function(i){let f,S;try{const C=document.createElement("canvas");C.width=1,C.height=1;const E=C.getContext("2d",{willReadFrequently:!0});E&&(f=E,f.globalCompositeOperation="copy",S=f.createLinearGradient(0,0,1,1))}catch{}i.toColor=function(C){if(C.match(/#[\da-f]{3,8}/i))switch(C.length){case 4:return u=parseInt(C.slice(1,2).repeat(2),16),g=parseInt(C.slice(2,3).repeat(2),16),x=parseInt(C.slice(3,4).repeat(2),16),v.toColor(u,g,x);case 5:return u=parseInt(C.slice(1,2).repeat(2),16),g=parseInt(C.slice(2,3).repeat(2),16),x=parseInt(C.slice(3,4).repeat(2),16),h=parseInt(C.slice(4,5).repeat(2),16),v.toColor(u,g,x,h);case 7:return{css:C,rgba:(parseInt(C.slice(1),16)<<8|255)>>>0};case 9:return{css:C,rgba:parseInt(C.slice(1),16)>>>0}}const E=C.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(E)return u=parseInt(E[1]),g=parseInt(E[2]),x=parseInt(E[3]),h=Math.round(255*(E[5]===void 0?1:parseFloat(E[5]))),v.toColor(u,g,x,h);if(!f||!S)throw new Error("css.toColor: Unsupported css format");if(f.fillStyle=S,f.fillStyle=C,typeof f.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(f.fillRect(0,0,1,1),[u,g,x,h]=f.getImageData(0,0,1,1).data,h!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:v.toRgba(u,g,x,h),css:C}}})(k||(c.css=k={})),(function(i){function f(S,C,E){const y=S/255,P=C/255,O=E/255;return .2126*(y<=.03928?y/12.92:Math.pow((y+.055)/1.055,2.4))+.7152*(P<=.03928?P/12.92:Math.pow((P+.055)/1.055,2.4))+.0722*(O<=.03928?O/12.92:Math.pow((O+.055)/1.055,2.4))}i.relativeLuminance=function(S){return f(S>>16&255,S>>8&255,255&S)},i.relativeLuminance2=f})(_||(c.rgb=_={})),(function(i){function f(C,E,y){const P=C>>24&255,O=C>>16&255,F=C>>8&255;let U=E>>24&255,B=E>>16&255,J=E>>8&255,ie=n(_.relativeLuminance2(U,B,J),_.relativeLuminance2(P,O,F));for(;ie<y&&(U>0||B>0||J>0);)U-=Math.max(0,Math.ceil(.1*U)),B-=Math.max(0,Math.ceil(.1*B)),J-=Math.max(0,Math.ceil(.1*J)),ie=n(_.relativeLuminance2(U,B,J),_.relativeLuminance2(P,O,F));return(U<<24|B<<16|J<<8|255)>>>0}function S(C,E,y){const P=C>>24&255,O=C>>16&255,F=C>>8&255;let U=E>>24&255,B=E>>16&255,J=E>>8&255,ie=n(_.relativeLuminance2(U,B,J),_.relativeLuminance2(P,O,F));for(;ie<y&&(U<255||B<255||J<255);)U=Math.min(255,U+Math.ceil(.1*(255-U))),B=Math.min(255,B+Math.ceil(.1*(255-B))),J=Math.min(255,J+Math.ceil(.1*(255-J))),ie=n(_.relativeLuminance2(U,B,J),_.relativeLuminance2(P,O,F));return(U<<24|B<<16|J<<8|255)>>>0}i.blend=function(C,E){if(h=(255&E)/255,h===1)return E;const y=E>>24&255,P=E>>16&255,O=E>>8&255,F=C>>24&255,U=C>>16&255,B=C>>8&255;return u=F+Math.round((y-F)*h),g=U+Math.round((P-U)*h),x=B+Math.round((O-B)*h),v.toRgba(u,g,x)},i.ensureContrastRatio=function(C,E,y){const P=_.relativeLuminance(C>>8),O=_.relativeLuminance(E>>8);if(n(P,O)<y){if(O<P){const B=f(C,E,y),J=n(P,_.relativeLuminance(B>>8));if(J<y){const ie=S(C,E,y);return J>n(P,_.relativeLuminance(ie>>8))?B:ie}return B}const F=S(C,E,y),U=n(P,_.relativeLuminance(F>>8));if(U<y){const B=f(C,E,y);return U>n(P,_.relativeLuminance(B>>8))?F:B}return F}},i.reduceLuminance=f,i.increaseLuminance=S,i.toChannels=function(C){return[C>>24&255,C>>16&255,C>>8&255,255&C]}})(o||(c.rgba=o={})),c.toPaddedHex=a,c.contrastRatio=n},8969:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CoreTerminal=void 0;const g=u(844),x=u(2585),h=u(4348),v=u(7866),w=u(744),k=u(7302),_=u(6975),o=u(8460),a=u(1753),n=u(1480),i=u(7994),f=u(9282),S=u(5435),C=u(5981),E=u(2660);let y=!1;class P extends g.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new o.EventEmitter),this._onScroll.event((F=>{var U;(U=this._onScrollApi)==null||U.fire(F.position)}))),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(F){for(const U in F)this.optionsService.options[U]=F[U]}constructor(F){super(),this._windowsWrappingHeuristics=this.register(new g.MutableDisposable),this._onBinary=this.register(new o.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new o.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new o.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new o.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new o.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new o.EventEmitter),this._instantiationService=new h.InstantiationService,this.optionsService=this.register(new k.OptionsService(F)),this._instantiationService.setService(x.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(w.BufferService)),this._instantiationService.setService(x.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(v.LogService)),this._instantiationService.setService(x.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(_.CoreService)),this._instantiationService.setService(x.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(a.CoreMouseService)),this._instantiationService.setService(x.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(n.UnicodeService)),this._instantiationService.setService(x.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(i.CharsetService),this._instantiationService.setService(x.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(E.OscLinkService),this._instantiationService.setService(x.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new S.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,o.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,o.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,o.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,o.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom((()=>this.scrollToBottom()))),this.register(this.coreService.onUserInput((()=>this._writeBuffer.handleUserInput()))),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],(()=>this._handleWindowsPtyOptionChange()))),this.register(this._bufferService.onScroll((U=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)}))),this.register(this._inputHandler.onScroll((U=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)}))),this._writeBuffer=this.register(new C.WriteBuffer(((U,B)=>this._inputHandler.parse(U,B)))),this.register((0,o.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(F,U){this._writeBuffer.write(F,U)}writeSync(F,U){this._logService.logLevel<=x.LogLevelEnum.WARN&&!y&&(this._logService.warn("writeSync is unreliable and will be removed soon."),y=!0),this._writeBuffer.writeSync(F,U)}input(F,U=!0){this.coreService.triggerDataEvent(F,U)}resize(F,U){isNaN(F)||isNaN(U)||(F=Math.max(F,w.MINIMUM_COLS),U=Math.max(U,w.MINIMUM_ROWS),this._bufferService.resize(F,U))}scroll(F,U=!1){this._bufferService.scroll(F,U)}scrollLines(F,U,B){this._bufferService.scrollLines(F,U,B)}scrollPages(F){this.scrollLines(F*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(F){const U=F-this._bufferService.buffer.ydisp;U!==0&&this.scrollLines(U)}registerEscHandler(F,U){return this._inputHandler.registerEscHandler(F,U)}registerDcsHandler(F,U){return this._inputHandler.registerDcsHandler(F,U)}registerCsiHandler(F,U){return this._inputHandler.registerCsiHandler(F,U)}registerOscHandler(F,U){return this._inputHandler.registerOscHandler(F,U)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let F=!1;const U=this.optionsService.rawOptions.windowsPty;U&&U.buildNumber!==void 0&&U.buildNumber!==void 0?F=U.backend==="conpty"&&U.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(F=!0),F?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const F=[];F.push(this.onLineFeed(f.updateWindowsModeWrappedState.bind(null,this._bufferService))),F.push(this.registerCsiHandler({final:"H"},(()=>((0,f.updateWindowsModeWrappedState)(this._bufferService),!1)))),this._windowsWrappingHeuristics.value=(0,g.toDisposable)((()=>{for(const U of F)U.dispose()}))}}}c.CoreTerminal=P},8460:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.runAndSubscribe=c.forwardEvent=c.EventEmitter=void 0,c.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=u=>(this._listeners.push(u),{dispose:()=>{if(!this._disposed){for(let g=0;g<this._listeners.length;g++)if(this._listeners[g]===u)return void this._listeners.splice(g,1)}}})),this._event}fire(u,g){const x=[];for(let h=0;h<this._listeners.length;h++)x.push(this._listeners[h]);for(let h=0;h<x.length;h++)x[h].call(void 0,u,g)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},c.forwardEvent=function(u,g){return u((x=>g.fire(x)))},c.runAndSubscribe=function(u,g){return g(void 0),u((x=>g(x)))}},5435:function(q,c,u){var g=this&&this.__decorate||function(Y,R,M,A){var j,Z=arguments.length,he=Z<3?R:A===null?A=Object.getOwnPropertyDescriptor(R,M):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")he=Reflect.decorate(Y,R,M,A);else for(var me=Y.length-1;me>=0;me--)(j=Y[me])&&(he=(Z<3?j(he):Z>3?j(R,M,he):j(R,M))||he);return Z>3&&he&&Object.defineProperty(R,M,he),he},x=this&&this.__param||function(Y,R){return function(M,A){R(M,A,Y)}};Object.defineProperty(c,"__esModule",{value:!0}),c.InputHandler=c.WindowsOptionsReportType=void 0;const h=u(2584),v=u(7116),w=u(2015),k=u(844),_=u(482),o=u(8437),a=u(8460),n=u(643),i=u(511),f=u(3734),S=u(2585),C=u(1480),E=u(6242),y=u(6351),P=u(5941),O={"(":0,")":1,"*":2,"+":3,"-":1,".":2},F=131072;function U(Y,R){if(Y>24)return R.setWinLines||!1;switch(Y){case 1:return!!R.restoreWin;case 2:return!!R.minimizeWin;case 3:return!!R.setWinPosition;case 4:return!!R.setWinSizePixels;case 5:return!!R.raiseWin;case 6:return!!R.lowerWin;case 7:return!!R.refreshWin;case 8:return!!R.setWinSizeChars;case 9:return!!R.maximizeWin;case 10:return!!R.fullscreenWin;case 11:return!!R.getWinState;case 13:return!!R.getWinPosition;case 14:return!!R.getWinSizePixels;case 15:return!!R.getScreenSizePixels;case 16:return!!R.getCellSizePixels;case 18:return!!R.getWinSizeChars;case 19:return!!R.getScreenSizeChars;case 20:return!!R.getIconTitle;case 21:return!!R.getWinTitle;case 22:return!!R.pushTitle;case 23:return!!R.popTitle;case 24:return!!R.setWinLines}return!1}var B;(function(Y){Y[Y.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",Y[Y.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(B||(c.WindowsOptionsReportType=B={}));let J=0;class ie extends k.Disposable{getAttrData(){return this._curAttrData}constructor(R,M,A,j,Z,he,me,ve,W=new w.EscapeSequenceParser){super(),this._bufferService=R,this._charsetService=M,this._coreService=A,this._logService=j,this._optionsService=Z,this._oscLinkService=he,this._coreMouseService=me,this._unicodeService=ve,this._parser=W,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new _.StringToUtf32,this._utf8Decoder=new _.Utf8ToUtf32,this._workCell=new i.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=o.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=o.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new a.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new a.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new a.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new a.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new a.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new a.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new a.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new a.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new a.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new a.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new a.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new a.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new a.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new fe(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate((D=>this._activeBuffer=D.activeBuffer))),this._parser.setCsiHandlerFallback(((D,oe)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(D),params:oe.toArray()})})),this._parser.setEscHandlerFallback((D=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(D)})})),this._parser.setExecuteHandlerFallback((D=>{this._logService.debug("Unknown EXECUTE code: ",{code:D})})),this._parser.setOscHandlerFallback(((D,oe,ee)=>{this._logService.debug("Unknown OSC code: ",{identifier:D,action:oe,data:ee})})),this._parser.setDcsHandlerFallback(((D,oe,ee)=>{oe==="HOOK"&&(ee=ee.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(D),action:oe,payload:ee})})),this._parser.setPrintHandler(((D,oe,ee)=>this.print(D,oe,ee))),this._parser.registerCsiHandler({final:"@"},(D=>this.insertChars(D))),this._parser.registerCsiHandler({intermediates:" ",final:"@"},(D=>this.scrollLeft(D))),this._parser.registerCsiHandler({final:"A"},(D=>this.cursorUp(D))),this._parser.registerCsiHandler({intermediates:" ",final:"A"},(D=>this.scrollRight(D))),this._parser.registerCsiHandler({final:"B"},(D=>this.cursorDown(D))),this._parser.registerCsiHandler({final:"C"},(D=>this.cursorForward(D))),this._parser.registerCsiHandler({final:"D"},(D=>this.cursorBackward(D))),this._parser.registerCsiHandler({final:"E"},(D=>this.cursorNextLine(D))),this._parser.registerCsiHandler({final:"F"},(D=>this.cursorPrecedingLine(D))),this._parser.registerCsiHandler({final:"G"},(D=>this.cursorCharAbsolute(D))),this._parser.registerCsiHandler({final:"H"},(D=>this.cursorPosition(D))),this._parser.registerCsiHandler({final:"I"},(D=>this.cursorForwardTab(D))),this._parser.registerCsiHandler({final:"J"},(D=>this.eraseInDisplay(D,!1))),this._parser.registerCsiHandler({prefix:"?",final:"J"},(D=>this.eraseInDisplay(D,!0))),this._parser.registerCsiHandler({final:"K"},(D=>this.eraseInLine(D,!1))),this._parser.registerCsiHandler({prefix:"?",final:"K"},(D=>this.eraseInLine(D,!0))),this._parser.registerCsiHandler({final:"L"},(D=>this.insertLines(D))),this._parser.registerCsiHandler({final:"M"},(D=>this.deleteLines(D))),this._parser.registerCsiHandler({final:"P"},(D=>this.deleteChars(D))),this._parser.registerCsiHandler({final:"S"},(D=>this.scrollUp(D))),this._parser.registerCsiHandler({final:"T"},(D=>this.scrollDown(D))),this._parser.registerCsiHandler({final:"X"},(D=>this.eraseChars(D))),this._parser.registerCsiHandler({final:"Z"},(D=>this.cursorBackwardTab(D))),this._parser.registerCsiHandler({final:"`"},(D=>this.charPosAbsolute(D))),this._parser.registerCsiHandler({final:"a"},(D=>this.hPositionRelative(D))),this._parser.registerCsiHandler({final:"b"},(D=>this.repeatPrecedingCharacter(D))),this._parser.registerCsiHandler({final:"c"},(D=>this.sendDeviceAttributesPrimary(D))),this._parser.registerCsiHandler({prefix:">",final:"c"},(D=>this.sendDeviceAttributesSecondary(D))),this._parser.registerCsiHandler({final:"d"},(D=>this.linePosAbsolute(D))),this._parser.registerCsiHandler({final:"e"},(D=>this.vPositionRelative(D))),this._parser.registerCsiHandler({final:"f"},(D=>this.hVPosition(D))),this._parser.registerCsiHandler({final:"g"},(D=>this.tabClear(D))),this._parser.registerCsiHandler({final:"h"},(D=>this.setMode(D))),this._parser.registerCsiHandler({prefix:"?",final:"h"},(D=>this.setModePrivate(D))),this._parser.registerCsiHandler({final:"l"},(D=>this.resetMode(D))),this._parser.registerCsiHandler({prefix:"?",final:"l"},(D=>this.resetModePrivate(D))),this._parser.registerCsiHandler({final:"m"},(D=>this.charAttributes(D))),this._parser.registerCsiHandler({final:"n"},(D=>this.deviceStatus(D))),this._parser.registerCsiHandler({prefix:"?",final:"n"},(D=>this.deviceStatusPrivate(D))),this._parser.registerCsiHandler({intermediates:"!",final:"p"},(D=>this.softReset(D))),this._parser.registerCsiHandler({intermediates:" ",final:"q"},(D=>this.setCursorStyle(D))),this._parser.registerCsiHandler({final:"r"},(D=>this.setScrollRegion(D))),this._parser.registerCsiHandler({final:"s"},(D=>this.saveCursor(D))),this._parser.registerCsiHandler({final:"t"},(D=>this.windowOptions(D))),this._parser.registerCsiHandler({final:"u"},(D=>this.restoreCursor(D))),this._parser.registerCsiHandler({intermediates:"'",final:"}"},(D=>this.insertColumns(D))),this._parser.registerCsiHandler({intermediates:"'",final:"~"},(D=>this.deleteColumns(D))),this._parser.registerCsiHandler({intermediates:'"',final:"q"},(D=>this.selectProtected(D))),this._parser.registerCsiHandler({intermediates:"$",final:"p"},(D=>this.requestMode(D,!0))),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},(D=>this.requestMode(D,!1))),this._parser.setExecuteHandler(h.C0.BEL,(()=>this.bell())),this._parser.setExecuteHandler(h.C0.LF,(()=>this.lineFeed())),this._parser.setExecuteHandler(h.C0.VT,(()=>this.lineFeed())),this._parser.setExecuteHandler(h.C0.FF,(()=>this.lineFeed())),this._parser.setExecuteHandler(h.C0.CR,(()=>this.carriageReturn())),this._parser.setExecuteHandler(h.C0.BS,(()=>this.backspace())),this._parser.setExecuteHandler(h.C0.HT,(()=>this.tab())),this._parser.setExecuteHandler(h.C0.SO,(()=>this.shiftOut())),this._parser.setExecuteHandler(h.C0.SI,(()=>this.shiftIn())),this._parser.setExecuteHandler(h.C1.IND,(()=>this.index())),this._parser.setExecuteHandler(h.C1.NEL,(()=>this.nextLine())),this._parser.setExecuteHandler(h.C1.HTS,(()=>this.tabSet())),this._parser.registerOscHandler(0,new E.OscHandler((D=>(this.setTitle(D),this.setIconName(D),!0)))),this._parser.registerOscHandler(1,new E.OscHandler((D=>this.setIconName(D)))),this._parser.registerOscHandler(2,new E.OscHandler((D=>this.setTitle(D)))),this._parser.registerOscHandler(4,new E.OscHandler((D=>this.setOrReportIndexedColor(D)))),this._parser.registerOscHandler(8,new E.OscHandler((D=>this.setHyperlink(D)))),this._parser.registerOscHandler(10,new E.OscHandler((D=>this.setOrReportFgColor(D)))),this._parser.registerOscHandler(11,new E.OscHandler((D=>this.setOrReportBgColor(D)))),this._parser.registerOscHandler(12,new E.OscHandler((D=>this.setOrReportCursorColor(D)))),this._parser.registerOscHandler(104,new E.OscHandler((D=>this.restoreIndexedColor(D)))),this._parser.registerOscHandler(110,new E.OscHandler((D=>this.restoreFgColor(D)))),this._parser.registerOscHandler(111,new E.OscHandler((D=>this.restoreBgColor(D)))),this._parser.registerOscHandler(112,new E.OscHandler((D=>this.restoreCursorColor(D)))),this._parser.registerEscHandler({final:"7"},(()=>this.saveCursor())),this._parser.registerEscHandler({final:"8"},(()=>this.restoreCursor())),this._parser.registerEscHandler({final:"D"},(()=>this.index())),this._parser.registerEscHandler({final:"E"},(()=>this.nextLine())),this._parser.registerEscHandler({final:"H"},(()=>this.tabSet())),this._parser.registerEscHandler({final:"M"},(()=>this.reverseIndex())),this._parser.registerEscHandler({final:"="},(()=>this.keypadApplicationMode())),this._parser.registerEscHandler({final:">"},(()=>this.keypadNumericMode())),this._parser.registerEscHandler({final:"c"},(()=>this.fullReset())),this._parser.registerEscHandler({final:"n"},(()=>this.setgLevel(2))),this._parser.registerEscHandler({final:"o"},(()=>this.setgLevel(3))),this._parser.registerEscHandler({final:"|"},(()=>this.setgLevel(3))),this._parser.registerEscHandler({final:"}"},(()=>this.setgLevel(2))),this._parser.registerEscHandler({final:"~"},(()=>this.setgLevel(1))),this._parser.registerEscHandler({intermediates:"%",final:"@"},(()=>this.selectDefaultCharset())),this._parser.registerEscHandler({intermediates:"%",final:"G"},(()=>this.selectDefaultCharset()));for(const D in v.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:D},(()=>this.selectCharset("("+D))),this._parser.registerEscHandler({intermediates:")",final:D},(()=>this.selectCharset(")"+D))),this._parser.registerEscHandler({intermediates:"*",final:D},(()=>this.selectCharset("*"+D))),this._parser.registerEscHandler({intermediates:"+",final:D},(()=>this.selectCharset("+"+D))),this._parser.registerEscHandler({intermediates:"-",final:D},(()=>this.selectCharset("-"+D))),this._parser.registerEscHandler({intermediates:".",final:D},(()=>this.selectCharset("."+D))),this._parser.registerEscHandler({intermediates:"/",final:D},(()=>this.selectCharset("/"+D)));this._parser.registerEscHandler({intermediates:"#",final:"8"},(()=>this.screenAlignmentPattern())),this._parser.setErrorHandler((D=>(this._logService.error("Parsing error: ",D),D))),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new y.DcsHandler(((D,oe)=>this.requestStatusString(D,oe))))}_preserveStack(R,M,A,j){this._parseStack.paused=!0,this._parseStack.cursorStartX=R,this._parseStack.cursorStartY=M,this._parseStack.decodedLength=A,this._parseStack.position=j}_logSlowResolvingAsync(R){this._logService.logLevel<=S.LogLevelEnum.WARN&&Promise.race([R,new Promise(((M,A)=>setTimeout((()=>A("#SLOW_TIMEOUT")),5e3)))]).catch((M=>{if(M!=="#SLOW_TIMEOUT")throw M;console.warn("async parser handler taking longer than 5000 ms")}))}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(R,M){let A,j=this._activeBuffer.x,Z=this._activeBuffer.y,he=0;const me=this._parseStack.paused;if(me){if(A=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,M))return this._logSlowResolvingAsync(A),A;j=this._parseStack.cursorStartX,Z=this._parseStack.cursorStartY,this._parseStack.paused=!1,R.length>F&&(he=this._parseStack.position+F)}if(this._logService.logLevel<=S.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof R=="string"?` "${R}"`:` "${Array.prototype.map.call(R,(D=>String.fromCharCode(D))).join("")}"`),typeof R=="string"?R.split("").map((D=>D.charCodeAt(0))):R),this._parseBuffer.length<R.length&&this._parseBuffer.length<F&&(this._parseBuffer=new Uint32Array(Math.min(R.length,F))),me||this._dirtyRowTracker.clearRange(),R.length>F)for(let D=he;D<R.length;D+=F){const oe=D+F<R.length?D+F:R.length,ee=typeof R=="string"?this._stringDecoder.decode(R.substring(D,oe),this._parseBuffer):this._utf8Decoder.decode(R.subarray(D,oe),this._parseBuffer);if(A=this._parser.parse(this._parseBuffer,ee))return this._preserveStack(j,Z,ee,D),this._logSlowResolvingAsync(A),A}else if(!me){const D=typeof R=="string"?this._stringDecoder.decode(R,this._parseBuffer):this._utf8Decoder.decode(R,this._parseBuffer);if(A=this._parser.parse(this._parseBuffer,D))return this._preserveStack(j,Z,D,0),this._logSlowResolvingAsync(A),A}this._activeBuffer.x===j&&this._activeBuffer.y===Z||this._onCursorMove.fire();const ve=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),W=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);W<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(W,this._bufferService.rows-1),Math.min(ve,this._bufferService.rows-1))}print(R,M,A){let j,Z;const he=this._charsetService.charset,me=this._optionsService.rawOptions.screenReaderMode,ve=this._bufferService.cols,W=this._coreService.decPrivateModes.wraparound,D=this._coreService.modes.insertMode,oe=this._curAttrData;let ee=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&A-M>0&&ee.getWidth(this._activeBuffer.x-1)===2&&ee.setCellFromCodepoint(this._activeBuffer.x-1,0,1,oe);let xe=this._parser.precedingJoinState;for(let Ce=M;Ce<A;++Ce){if(j=R[Ce],j<127&&he){const gt=he[String.fromCharCode(j)];gt&&(j=gt.charCodeAt(0))}const Ke=this._unicodeService.charProperties(j,xe);Z=C.UnicodeService.extractWidth(Ke);const Xe=C.UnicodeService.extractShouldJoin(Ke),ft=Xe?C.UnicodeService.extractWidth(xe):0;if(xe=Ke,me&&this._onA11yChar.fire((0,_.stringFromCodePoint)(j)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+Z-ft>ve){if(W){const gt=ee;let Ae=this._activeBuffer.x-ft;for(this._activeBuffer.x=ft,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),ee=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),ft>0&&ee instanceof o.BufferLine&&ee.copyCellsFrom(gt,Ae,0,ft,!1);Ae<ve;)gt.setCellFromCodepoint(Ae++,0,1,oe)}else if(this._activeBuffer.x=ve-1,Z===2)continue}if(Xe&&this._activeBuffer.x){const gt=ee.getWidth(this._activeBuffer.x-1)?1:2;ee.addCodepointToCell(this._activeBuffer.x-gt,j,Z);for(let Ae=Z-ft;--Ae>=0;)ee.setCellFromCodepoint(this._activeBuffer.x++,0,0,oe)}else if(D&&(ee.insertCells(this._activeBuffer.x,Z-ft,this._activeBuffer.getNullCell(oe)),ee.getWidth(ve-1)===2&&ee.setCellFromCodepoint(ve-1,n.NULL_CELL_CODE,n.NULL_CELL_WIDTH,oe)),ee.setCellFromCodepoint(this._activeBuffer.x++,j,Z,oe),Z>0)for(;--Z;)ee.setCellFromCodepoint(this._activeBuffer.x++,0,0,oe)}this._parser.precedingJoinState=xe,this._activeBuffer.x<ve&&A-M>0&&ee.getWidth(this._activeBuffer.x)===0&&!ee.hasContent(this._activeBuffer.x)&&ee.setCellFromCodepoint(this._activeBuffer.x,0,1,oe),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(R,M){return R.final!=="t"||R.prefix||R.intermediates?this._parser.registerCsiHandler(R,M):this._parser.registerCsiHandler(R,(A=>!U(A.params[0],this._optionsService.rawOptions.windowOptions)||M(A)))}registerDcsHandler(R,M){return this._parser.registerDcsHandler(R,new y.DcsHandler(M))}registerEscHandler(R,M){return this._parser.registerEscHandler(R,M)}registerOscHandler(R,M){return this._parser.registerOscHandler(R,new E.OscHandler(M))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var R;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&((R=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))!=null&&R.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);M.hasWidth(this._activeBuffer.x)&&!M.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const R=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-R),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(R=this._bufferService.cols-1){this._activeBuffer.x=Math.min(R,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(R,M){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=R,this._activeBuffer.y=this._activeBuffer.scrollTop+M):(this._activeBuffer.x=R,this._activeBuffer.y=M),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(R,M){this._restrictCursor(),this._setCursor(this._activeBuffer.x+R,this._activeBuffer.y+M)}cursorUp(R){const M=this._activeBuffer.y-this._activeBuffer.scrollTop;return M>=0?this._moveCursor(0,-Math.min(M,R.params[0]||1)):this._moveCursor(0,-(R.params[0]||1)),!0}cursorDown(R){const M=this._activeBuffer.scrollBottom-this._activeBuffer.y;return M>=0?this._moveCursor(0,Math.min(M,R.params[0]||1)):this._moveCursor(0,R.params[0]||1),!0}cursorForward(R){return this._moveCursor(R.params[0]||1,0),!0}cursorBackward(R){return this._moveCursor(-(R.params[0]||1),0),!0}cursorNextLine(R){return this.cursorDown(R),this._activeBuffer.x=0,!0}cursorPrecedingLine(R){return this.cursorUp(R),this._activeBuffer.x=0,!0}cursorCharAbsolute(R){return this._setCursor((R.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(R){return this._setCursor(R.length>=2?(R.params[1]||1)-1:0,(R.params[0]||1)-1),!0}charPosAbsolute(R){return this._setCursor((R.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(R){return this._moveCursor(R.params[0]||1,0),!0}linePosAbsolute(R){return this._setCursor(this._activeBuffer.x,(R.params[0]||1)-1),!0}vPositionRelative(R){return this._moveCursor(0,R.params[0]||1),!0}hVPosition(R){return this.cursorPosition(R),!0}tabClear(R){const M=R.params[0];return M===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:M===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(R){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let M=R.params[0]||1;for(;M--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(R){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let M=R.params[0]||1;for(;M--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(R){const M=R.params[0];return M===1&&(this._curAttrData.bg|=536870912),M!==2&&M!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(R,M,A,j=!1,Z=!1){const he=this._activeBuffer.lines.get(this._activeBuffer.ybase+R);he.replaceCells(M,A,this._activeBuffer.getNullCell(this._eraseAttrData()),Z),j&&(he.isWrapped=!1)}_resetBufferLine(R,M=!1){const A=this._activeBuffer.lines.get(this._activeBuffer.ybase+R);A&&(A.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),M),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+R),A.isWrapped=!1)}eraseInDisplay(R,M=!1){let A;switch(this._restrictCursor(this._bufferService.cols),R.params[0]){case 0:for(A=this._activeBuffer.y,this._dirtyRowTracker.markDirty(A),this._eraseInBufferLine(A++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,M);A<this._bufferService.rows;A++)this._resetBufferLine(A,M);this._dirtyRowTracker.markDirty(A);break;case 1:for(A=this._activeBuffer.y,this._dirtyRowTracker.markDirty(A),this._eraseInBufferLine(A,0,this._activeBuffer.x+1,!0,M),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(A+1).isWrapped=!1);A--;)this._resetBufferLine(A,M);this._dirtyRowTracker.markDirty(0);break;case 2:for(A=this._bufferService.rows,this._dirtyRowTracker.markDirty(A-1);A--;)this._resetBufferLine(A,M);this._dirtyRowTracker.markDirty(0);break;case 3:const j=this._activeBuffer.lines.length-this._bufferService.rows;j>0&&(this._activeBuffer.lines.trimStart(j),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-j,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-j,0),this._onScroll.fire(0))}return!0}eraseInLine(R,M=!1){switch(this._restrictCursor(this._bufferService.cols),R.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,M);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,M);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,M)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(R){this._restrictCursor();let M=R.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const A=this._activeBuffer.ybase+this._activeBuffer.y,j=this._bufferService.rows-1-this._activeBuffer.scrollBottom,Z=this._bufferService.rows-1+this._activeBuffer.ybase-j+1;for(;M--;)this._activeBuffer.lines.splice(Z-1,1),this._activeBuffer.lines.splice(A,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(R){this._restrictCursor();let M=R.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const A=this._activeBuffer.ybase+this._activeBuffer.y;let j;for(j=this._bufferService.rows-1-this._activeBuffer.scrollBottom,j=this._bufferService.rows-1+this._activeBuffer.ybase-j;M--;)this._activeBuffer.lines.splice(A,1),this._activeBuffer.lines.splice(j,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(R){this._restrictCursor();const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return M&&(M.insertCells(this._activeBuffer.x,R.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(R){this._restrictCursor();const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return M&&(M.deleteCells(this._activeBuffer.x,R.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(R){let M=R.params[0]||1;for(;M--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(R){let M=R.params[0]||1;for(;M--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(o.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const M=R.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);j.deleteCells(0,M,this._activeBuffer.getNullCell(this._eraseAttrData())),j.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const M=R.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);j.insertCells(0,M,this._activeBuffer.getNullCell(this._eraseAttrData())),j.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const M=R.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);j.insertCells(this._activeBuffer.x,M,this._activeBuffer.getNullCell(this._eraseAttrData())),j.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const M=R.params[0]||1;for(let A=this._activeBuffer.scrollTop;A<=this._activeBuffer.scrollBottom;++A){const j=this._activeBuffer.lines.get(this._activeBuffer.ybase+A);j.deleteCells(this._activeBuffer.x,M,this._activeBuffer.getNullCell(this._eraseAttrData())),j.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(R){this._restrictCursor();const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return M&&(M.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(R.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(R){const M=this._parser.precedingJoinState;if(!M)return!0;const A=R.params[0]||1,j=C.UnicodeService.extractWidth(M),Z=this._activeBuffer.x-j,he=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(Z),me=new Uint32Array(he.length*A);let ve=0;for(let D=0;D<he.length;){const oe=he.codePointAt(D)||0;me[ve++]=oe,D+=oe>65535?2:1}let W=ve;for(let D=1;D<A;++D)me.copyWithin(W,0,ve),W+=ve;return this.print(me,0,W),!0}sendDeviceAttributesPrimary(R){return R.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(h.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(h.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(R){return R.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(h.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(h.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(R.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(h.C0.ESC+"[>83;40003;0c")),!0}_is(R){return(this._optionsService.rawOptions.termName+"").indexOf(R)===0}setMode(R){for(let M=0;M<R.length;M++)switch(R.params[M]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(R){for(let M=0;M<R.length;M++)switch(R.params[M]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,v.DEFAULT_CHARSET),this._charsetService.setgCharset(1,v.DEFAULT_CHARSET),this._charsetService.setgCharset(2,v.DEFAULT_CHARSET),this._charsetService.setgCharset(3,v.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(R){for(let M=0;M<R.length;M++)switch(R.params[M]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(R){for(let M=0;M<R.length;M++)switch(R.params[M]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),R.params[M]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(R,M){const A=this._coreService.decPrivateModes,{activeProtocol:j,activeEncoding:Z}=this._coreMouseService,he=this._coreService,{buffers:me,cols:ve}=this._bufferService,{active:W,alt:D}=me,oe=this._optionsService.rawOptions,ee=Xe=>Xe?1:2,xe=R.params[0];return Ce=xe,Ke=M?xe===2?4:xe===4?ee(he.modes.insertMode):xe===12?3:xe===20?ee(oe.convertEol):0:xe===1?ee(A.applicationCursorKeys):xe===3?oe.windowOptions.setWinLines?ve===80?2:ve===132?1:0:0:xe===6?ee(A.origin):xe===7?ee(A.wraparound):xe===8?3:xe===9?ee(j==="X10"):xe===12?ee(oe.cursorBlink):xe===25?ee(!he.isCursorHidden):xe===45?ee(A.reverseWraparound):xe===66?ee(A.applicationKeypad):xe===67?4:xe===1e3?ee(j==="VT200"):xe===1002?ee(j==="DRAG"):xe===1003?ee(j==="ANY"):xe===1004?ee(A.sendFocus):xe===1005?4:xe===1006?ee(Z==="SGR"):xe===1015?4:xe===1016?ee(Z==="SGR_PIXELS"):xe===1048?1:xe===47||xe===1047||xe===1049?ee(W===D):xe===2004?ee(A.bracketedPasteMode):0,he.triggerDataEvent(`${h.C0.ESC}[${M?"":"?"}${Ce};${Ke}$y`),!0;var Ce,Ke}_updateAttrColor(R,M,A,j,Z){return M===2?(R|=50331648,R&=-16777216,R|=f.AttributeData.fromColorRGB([A,j,Z])):M===5&&(R&=-50331904,R|=33554432|255&A),R}_extractColor(R,M,A){const j=[0,0,-1,0,0,0];let Z=0,he=0;do{if(j[he+Z]=R.params[M+he],R.hasSubParams(M+he)){const me=R.getSubParams(M+he);let ve=0;do j[1]===5&&(Z=1),j[he+ve+1+Z]=me[ve];while(++ve<me.length&&ve+he+1+Z<j.length);break}if(j[1]===5&&he+Z>=2||j[1]===2&&he+Z>=5)break;j[1]&&(Z=1)}while(++he+M<R.length&&he+Z<j.length);for(let me=2;me<j.length;++me)j[me]===-1&&(j[me]=0);switch(j[0]){case 38:A.fg=this._updateAttrColor(A.fg,j[1],j[3],j[4],j[5]);break;case 48:A.bg=this._updateAttrColor(A.bg,j[1],j[3],j[4],j[5]);break;case 58:A.extended=A.extended.clone(),A.extended.underlineColor=this._updateAttrColor(A.extended.underlineColor,j[1],j[3],j[4],j[5])}return he}_processUnderline(R,M){M.extended=M.extended.clone(),(!~R||R>5)&&(R=1),M.extended.underlineStyle=R,M.fg|=268435456,R===0&&(M.fg&=-268435457),M.updateExtended()}_processSGR0(R){R.fg=o.DEFAULT_ATTR_DATA.fg,R.bg=o.DEFAULT_ATTR_DATA.bg,R.extended=R.extended.clone(),R.extended.underlineStyle=0,R.extended.underlineColor&=-67108864,R.updateExtended()}charAttributes(R){if(R.length===1&&R.params[0]===0)return this._processSGR0(this._curAttrData),!0;const M=R.length;let A;const j=this._curAttrData;for(let Z=0;Z<M;Z++)A=R.params[Z],A>=30&&A<=37?(j.fg&=-50331904,j.fg|=16777216|A-30):A>=40&&A<=47?(j.bg&=-50331904,j.bg|=16777216|A-40):A>=90&&A<=97?(j.fg&=-50331904,j.fg|=16777224|A-90):A>=100&&A<=107?(j.bg&=-50331904,j.bg|=16777224|A-100):A===0?this._processSGR0(j):A===1?j.fg|=134217728:A===3?j.bg|=67108864:A===4?(j.fg|=268435456,this._processUnderline(R.hasSubParams(Z)?R.getSubParams(Z)[0]:1,j)):A===5?j.fg|=536870912:A===7?j.fg|=67108864:A===8?j.fg|=1073741824:A===9?j.fg|=2147483648:A===2?j.bg|=134217728:A===21?this._processUnderline(2,j):A===22?(j.fg&=-134217729,j.bg&=-134217729):A===23?j.bg&=-67108865:A===24?(j.fg&=-268435457,this._processUnderline(0,j)):A===25?j.fg&=-536870913:A===27?j.fg&=-67108865:A===28?j.fg&=-1073741825:A===29?j.fg&=2147483647:A===39?(j.fg&=-67108864,j.fg|=16777215&o.DEFAULT_ATTR_DATA.fg):A===49?(j.bg&=-67108864,j.bg|=16777215&o.DEFAULT_ATTR_DATA.bg):A===38||A===48||A===58?Z+=this._extractColor(R,Z,j):A===53?j.bg|=1073741824:A===55?j.bg&=-1073741825:A===59?(j.extended=j.extended.clone(),j.extended.underlineColor=-1,j.updateExtended()):A===100?(j.fg&=-67108864,j.fg|=16777215&o.DEFAULT_ATTR_DATA.fg,j.bg&=-67108864,j.bg|=16777215&o.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",A);return!0}deviceStatus(R){switch(R.params[0]){case 5:this._coreService.triggerDataEvent(`${h.C0.ESC}[0n`);break;case 6:const M=this._activeBuffer.y+1,A=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${h.C0.ESC}[${M};${A}R`)}return!0}deviceStatusPrivate(R){if(R.params[0]===6){const M=this._activeBuffer.y+1,A=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${h.C0.ESC}[?${M};${A}R`)}return!0}softReset(R){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=o.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(R){const M=R.params[0]||1;switch(M){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const A=M%2==1;return this._optionsService.options.cursorBlink=A,!0}setScrollRegion(R){const M=R.params[0]||1;let A;return(R.length<2||(A=R.params[1])>this._bufferService.rows||A===0)&&(A=this._bufferService.rows),A>M&&(this._activeBuffer.scrollTop=M-1,this._activeBuffer.scrollBottom=A-1,this._setCursor(0,0)),!0}windowOptions(R){if(!U(R.params[0],this._optionsService.rawOptions.windowOptions))return!0;const M=R.length>1?R.params[1]:0;switch(R.params[0]){case 14:M!==2&&this._onRequestWindowsOptionsReport.fire(B.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(B.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${h.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:M!==0&&M!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),M!==0&&M!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:M!==0&&M!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),M!==0&&M!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(R){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(R){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(R){return this._windowTitle=R,this._onTitleChange.fire(R),!0}setIconName(R){return this._iconName=R,!0}setOrReportIndexedColor(R){const M=[],A=R.split(";");for(;A.length>1;){const j=A.shift(),Z=A.shift();if(/^\d+$/.exec(j)){const he=parseInt(j);if(_e(he))if(Z==="?")M.push({type:0,index:he});else{const me=(0,P.parseColor)(Z);me&&M.push({type:1,index:he,color:me})}}}return M.length&&this._onColor.fire(M),!0}setHyperlink(R){const M=R.split(";");return!(M.length<2)&&(M[1]?this._createHyperlink(M[0],M[1]):!M[0]&&this._finishHyperlink())}_createHyperlink(R,M){this._getCurrentLinkId()&&this._finishHyperlink();const A=R.split(":");let j;const Z=A.findIndex((he=>he.startsWith("id=")));return Z!==-1&&(j=A[Z].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:j,uri:M}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(R,M){const A=R.split(";");for(let j=0;j<A.length&&!(M>=this._specialColors.length);++j,++M)if(A[j]==="?")this._onColor.fire([{type:0,index:this._specialColors[M]}]);else{const Z=(0,P.parseColor)(A[j]);Z&&this._onColor.fire([{type:1,index:this._specialColors[M],color:Z}])}return!0}setOrReportFgColor(R){return this._setOrReportSpecialColor(R,0)}setOrReportBgColor(R){return this._setOrReportSpecialColor(R,1)}setOrReportCursorColor(R){return this._setOrReportSpecialColor(R,2)}restoreIndexedColor(R){if(!R)return this._onColor.fire([{type:2}]),!0;const M=[],A=R.split(";");for(let j=0;j<A.length;++j)if(/^\d+$/.exec(A[j])){const Z=parseInt(A[j]);_e(Z)&&M.push({type:2,index:Z})}return M.length&&this._onColor.fire(M),!0}restoreFgColor(R){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(R){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(R){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,v.DEFAULT_CHARSET),!0}selectCharset(R){return R.length!==2?(this.selectDefaultCharset(),!0):(R[0]==="/"||this._charsetService.setgCharset(O[R[0]],v.CHARSETS[R[1]]||v.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const R=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,R,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=o.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=o.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(R){return this._charsetService.setgLevel(R),!0}screenAlignmentPattern(){const R=new i.CellData;R.content=4194373,R.fg=this._curAttrData.fg,R.bg=this._curAttrData.bg,this._setCursor(0,0);for(let M=0;M<this._bufferService.rows;++M){const A=this._activeBuffer.ybase+this._activeBuffer.y+M,j=this._activeBuffer.lines.get(A);j&&(j.fill(R),j.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(R,M){const A=this._bufferService.buffer,j=this._optionsService.rawOptions;return(Z=>(this._coreService.triggerDataEvent(`${h.C0.ESC}${Z}${h.C0.ESC}\\`),!0))(R==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:R==='"p'?'P1$r61;1"p':R==="r"?`P1$r${A.scrollTop+1};${A.scrollBottom+1}r`:R==="m"?"P1$r0m":R===" q"?`P1$r${{block:2,underline:4,bar:6}[j.cursorStyle]-(j.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(R,M){this._dirtyRowTracker.markRangeDirty(R,M)}}c.InputHandler=ie;let fe=class{constructor(Y){this._bufferService=Y,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(Y){Y<this.start?this.start=Y:Y>this.end&&(this.end=Y)}markRangeDirty(Y,R){Y>R&&(J=Y,Y=R,R=J),Y<this.start&&(this.start=Y),R>this.end&&(this.end=R)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function _e(Y){return 0<=Y&&Y<256}fe=g([x(0,S.IBufferService)],fe)},844:(q,c)=>{function u(g){for(const x of g)x.dispose();g.length=0}Object.defineProperty(c,"__esModule",{value:!0}),c.getDisposeArrayDisposable=c.disposeArray=c.toDisposable=c.MutableDisposable=c.Disposable=void 0,c.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const g of this._disposables)g.dispose();this._disposables.length=0}register(g){return this._disposables.push(g),g}unregister(g){const x=this._disposables.indexOf(g);x!==-1&&this._disposables.splice(x,1)}},c.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(g){var x;this._isDisposed||g===this._value||((x=this._value)==null||x.dispose(),this._value=g)}clear(){this.value=void 0}dispose(){var g;this._isDisposed=!0,(g=this._value)==null||g.dispose(),this._value=void 0}},c.toDisposable=function(g){return{dispose:g}},c.disposeArray=u,c.getDisposeArrayDisposable=function(g){return{dispose:()=>u(g)}}},1505:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.FourKeyMap=c.TwoKeyMap=void 0;class u{constructor(){this._data={}}set(x,h,v){this._data[x]||(this._data[x]={}),this._data[x][h]=v}get(x,h){return this._data[x]?this._data[x][h]:void 0}clear(){this._data={}}}c.TwoKeyMap=u,c.FourKeyMap=class{constructor(){this._data=new u}set(g,x,h,v,w){this._data.get(g,x)||this._data.set(g,x,new u),this._data.get(g,x).set(h,v,w)}get(g,x,h,v){var w;return(w=this._data.get(g,x))==null?void 0:w.get(h,v)}clear(){this._data.clear()}}},6114:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.isChromeOS=c.isLinux=c.isWindows=c.isIphone=c.isIpad=c.isMac=c.getSafariVersion=c.isSafari=c.isLegacyEdge=c.isFirefox=c.isNode=void 0,c.isNode=typeof process<"u"&&"title"in process;const u=c.isNode?"node":navigator.userAgent,g=c.isNode?"node":navigator.platform;c.isFirefox=u.includes("Firefox"),c.isLegacyEdge=u.includes("Edge"),c.isSafari=/^((?!chrome|android).)*safari/i.test(u),c.getSafariVersion=function(){if(!c.isSafari)return 0;const x=u.match(/Version\/(\d+)/);return x===null||x.length<2?0:parseInt(x[1])},c.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(g),c.isIpad=g==="iPad",c.isIphone=g==="iPhone",c.isWindows=["Windows","Win16","Win32","WinCE"].includes(g),c.isLinux=g.indexOf("Linux")>=0,c.isChromeOS=/\bCrOS\b/.test(u)},6106:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.SortedList=void 0;let u=0;c.SortedList=class{constructor(g){this._getKey=g,this._array=[]}clear(){this._array.length=0}insert(g){this._array.length!==0?(u=this._search(this._getKey(g)),this._array.splice(u,0,g)):this._array.push(g)}delete(g){if(this._array.length===0)return!1;const x=this._getKey(g);if(x===void 0||(u=this._search(x),u===-1)||this._getKey(this._array[u])!==x)return!1;do if(this._array[u]===g)return this._array.splice(u,1),!0;while(++u<this._array.length&&this._getKey(this._array[u])===x);return!1}*getKeyIterator(g){if(this._array.length!==0&&(u=this._search(g),!(u<0||u>=this._array.length)&&this._getKey(this._array[u])===g))do yield this._array[u];while(++u<this._array.length&&this._getKey(this._array[u])===g)}forEachByKey(g,x){if(this._array.length!==0&&(u=this._search(g),!(u<0||u>=this._array.length)&&this._getKey(this._array[u])===g))do x(this._array[u]);while(++u<this._array.length&&this._getKey(this._array[u])===g)}values(){return[...this._array].values()}_search(g){let x=0,h=this._array.length-1;for(;h>=x;){let v=x+h>>1;const w=this._getKey(this._array[v]);if(w>g)h=v-1;else{if(!(w<g)){for(;v>0&&this._getKey(this._array[v-1])===g;)v--;return v}x=v+1}}return x}}},7226:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DebouncedIdleTask=c.IdleTaskQueue=c.PriorityTaskQueue=void 0;const g=u(6114);class x{constructor(){this._tasks=[],this._i=0}enqueue(w){this._tasks.push(w),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(w){this._idleCallback=void 0;let k=0,_=0,o=w.timeRemaining(),a=0;for(;this._i<this._tasks.length;){if(k=Date.now(),this._tasks[this._i]()||this._i++,k=Math.max(1,Date.now()-k),_=Math.max(k,_),a=w.timeRemaining(),1.5*_>a)return o-k<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(o-k))}ms`),void this._start();o=a}this.clear()}}class h extends x{_requestCallback(w){return setTimeout((()=>w(this._createDeadline(16))))}_cancelCallback(w){clearTimeout(w)}_createDeadline(w){const k=Date.now()+w;return{timeRemaining:()=>Math.max(0,k-Date.now())}}}c.PriorityTaskQueue=h,c.IdleTaskQueue=!g.isNode&&"requestIdleCallback"in window?class extends x{_requestCallback(v){return requestIdleCallback(v)}_cancelCallback(v){cancelIdleCallback(v)}}:h,c.DebouncedIdleTask=class{constructor(){this._queue=new c.IdleTaskQueue}set(v){this._queue.clear(),this._queue.enqueue(v)}flush(){this._queue.flush()}}},9282:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.updateWindowsModeWrappedState=void 0;const g=u(643);c.updateWindowsModeWrappedState=function(x){const h=x.buffer.lines.get(x.buffer.ybase+x.buffer.y-1),v=h==null?void 0:h.get(x.cols-1),w=x.buffer.lines.get(x.buffer.ybase+x.buffer.y);w&&v&&(w.isWrapped=v[g.CHAR_DATA_CODE_INDEX]!==g.NULL_CELL_CODE&&v[g.CHAR_DATA_CODE_INDEX]!==g.WHITESPACE_CELL_CODE)}},3734:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ExtendedAttrs=c.AttributeData=void 0;class u{constructor(){this.fg=0,this.bg=0,this.extended=new g}static toColorRGB(h){return[h>>>16&255,h>>>8&255,255&h]}static fromColorRGB(h){return(255&h[0])<<16|(255&h[1])<<8|255&h[2]}clone(){const h=new u;return h.fg=this.fg,h.bg=this.bg,h.extended=this.extended.clone(),h}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}c.AttributeData=u;class g{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(h){this._ext=h}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(h){this._ext&=-469762049,this._ext|=h<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(h){this._ext&=-67108864,this._ext|=67108863&h}get urlId(){return this._urlId}set urlId(h){this._urlId=h}get underlineVariantOffset(){const h=(3758096384&this._ext)>>29;return h<0?4294967288^h:h}set underlineVariantOffset(h){this._ext&=536870911,this._ext|=h<<29&3758096384}constructor(h=0,v=0){this._ext=0,this._urlId=0,this._ext=h,this._urlId=v}clone(){return new g(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}c.ExtendedAttrs=g},9092:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Buffer=c.MAX_BUFFER_SIZE=void 0;const g=u(6349),x=u(7226),h=u(3734),v=u(8437),w=u(4634),k=u(511),_=u(643),o=u(4863),a=u(7116);c.MAX_BUFFER_SIZE=4294967295,c.Buffer=class{constructor(n,i,f){this._hasScrollback=n,this._optionsService=i,this._bufferService=f,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=v.DEFAULT_ATTR_DATA.clone(),this.savedCharset=a.DEFAULT_CHARSET,this.markers=[],this._nullCell=k.CellData.fromCharData([0,_.NULL_CELL_CHAR,_.NULL_CELL_WIDTH,_.NULL_CELL_CODE]),this._whitespaceCell=k.CellData.fromCharData([0,_.WHITESPACE_CELL_CHAR,_.WHITESPACE_CELL_WIDTH,_.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new x.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new g.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(n){return n?(this._nullCell.fg=n.fg,this._nullCell.bg=n.bg,this._nullCell.extended=n.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new h.ExtendedAttrs),this._nullCell}getWhitespaceCell(n){return n?(this._whitespaceCell.fg=n.fg,this._whitespaceCell.bg=n.bg,this._whitespaceCell.extended=n.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new h.ExtendedAttrs),this._whitespaceCell}getBlankLine(n,i){return new v.BufferLine(this._bufferService.cols,this.getNullCell(n),i)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const n=this.ybase+this.y-this.ydisp;return n>=0&&n<this._rows}_getCorrectBufferLength(n){if(!this._hasScrollback)return n;const i=n+this._optionsService.rawOptions.scrollback;return i>c.MAX_BUFFER_SIZE?c.MAX_BUFFER_SIZE:i}fillViewportRows(n){if(this.lines.length===0){n===void 0&&(n=v.DEFAULT_ATTR_DATA);let i=this._rows;for(;i--;)this.lines.push(this.getBlankLine(n))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new g.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(n,i){const f=this.getNullCell(v.DEFAULT_ATTR_DATA);let S=0;const C=this._getCorrectBufferLength(i);if(C>this.lines.maxLength&&(this.lines.maxLength=C),this.lines.length>0){if(this._cols<n)for(let y=0;y<this.lines.length;y++)S+=+this.lines.get(y).resize(n,f);let E=0;if(this._rows<i)for(let y=this._rows;y<i;y++)this.lines.length<i+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new v.BufferLine(n,f)):this.ybase>0&&this.lines.length<=this.ybase+this.y+E+1?(this.ybase--,E++,this.ydisp>0&&this.ydisp--):this.lines.push(new v.BufferLine(n,f)));else for(let y=this._rows;y>i;y--)this.lines.length>i+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(C<this.lines.maxLength){const y=this.lines.length-C;y>0&&(this.lines.trimStart(y),this.ybase=Math.max(this.ybase-y,0),this.ydisp=Math.max(this.ydisp-y,0),this.savedY=Math.max(this.savedY-y,0)),this.lines.maxLength=C}this.x=Math.min(this.x,n-1),this.y=Math.min(this.y,i-1),E&&(this.y+=E),this.savedX=Math.min(this.savedX,n-1),this.scrollTop=0}if(this.scrollBottom=i-1,this._isReflowEnabled&&(this._reflow(n,i),this._cols>n))for(let E=0;E<this.lines.length;E++)S+=+this.lines.get(E).resize(n,f);this._cols=n,this._rows=i,this._memoryCleanupQueue.clear(),S>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue((()=>this._batchedMemoryCleanup())))}_batchedMemoryCleanup(){let n=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,n=!1);let i=0;for(;this._memoryCleanupPosition<this.lines.length;)if(i+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),i>100)return!0;return n}get _isReflowEnabled(){const n=this._optionsService.rawOptions.windowsPty;return n&&n.buildNumber?this._hasScrollback&&n.backend==="conpty"&&n.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(n,i){this._cols!==n&&(n>this._cols?this._reflowLarger(n,i):this._reflowSmaller(n,i))}_reflowLarger(n,i){const f=(0,w.reflowLargerGetLinesToRemove)(this.lines,this._cols,n,this.ybase+this.y,this.getNullCell(v.DEFAULT_ATTR_DATA));if(f.length>0){const S=(0,w.reflowLargerCreateNewLayout)(this.lines,f);(0,w.reflowLargerApplyNewLayout)(this.lines,S.layout),this._reflowLargerAdjustViewport(n,i,S.countRemoved)}}_reflowLargerAdjustViewport(n,i,f){const S=this.getNullCell(v.DEFAULT_ATTR_DATA);let C=f;for(;C-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<i&&this.lines.push(new v.BufferLine(n,S))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-f,0)}_reflowSmaller(n,i){const f=this.getNullCell(v.DEFAULT_ATTR_DATA),S=[];let C=0;for(let E=this.lines.length-1;E>=0;E--){let y=this.lines.get(E);if(!y||!y.isWrapped&&y.getTrimmedLength()<=n)continue;const P=[y];for(;y.isWrapped&&E>0;)y=this.lines.get(--E),P.unshift(y);const O=this.ybase+this.y;if(O>=E&&O<E+P.length)continue;const F=P[P.length-1].getTrimmedLength(),U=(0,w.reflowSmallerGetNewLineLengths)(P,this._cols,n),B=U.length-P.length;let J;J=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+B):Math.max(0,this.lines.length-this.lines.maxLength+B);const ie=[];for(let A=0;A<B;A++){const j=this.getBlankLine(v.DEFAULT_ATTR_DATA,!0);ie.push(j)}ie.length>0&&(S.push({start:E+P.length+C,newLines:ie}),C+=ie.length),P.push(...ie);let fe=U.length-1,_e=U[fe];_e===0&&(fe--,_e=U[fe]);let Y=P.length-B-1,R=F;for(;Y>=0;){const A=Math.min(R,_e);if(P[fe]===void 0)break;if(P[fe].copyCellsFrom(P[Y],R-A,_e-A,A,!0),_e-=A,_e===0&&(fe--,_e=U[fe]),R-=A,R===0){Y--;const j=Math.max(Y,0);R=(0,w.getWrappedLineTrimmedLength)(P,j,this._cols)}}for(let A=0;A<P.length;A++)U[A]<n&&P[A].setCell(U[A],f);let M=B-J;for(;M-- >0;)this.ybase===0?this.y<i-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+C)-i&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+B,this.ybase+i-1)}if(S.length>0){const E=[],y=[];for(let fe=0;fe<this.lines.length;fe++)y.push(this.lines.get(fe));const P=this.lines.length;let O=P-1,F=0,U=S[F];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+C);let B=0;for(let fe=Math.min(this.lines.maxLength-1,P+C-1);fe>=0;fe--)if(U&&U.start>O+B){for(let _e=U.newLines.length-1;_e>=0;_e--)this.lines.set(fe--,U.newLines[_e]);fe++,E.push({index:O+1,amount:U.newLines.length}),B+=U.newLines.length,U=S[++F]}else this.lines.set(fe,y[O--]);let J=0;for(let fe=E.length-1;fe>=0;fe--)E[fe].index+=J,this.lines.onInsertEmitter.fire(E[fe]),J+=E[fe].amount;const ie=Math.max(0,P+C-this.lines.maxLength);ie>0&&this.lines.onTrimEmitter.fire(ie)}}translateBufferLineToString(n,i,f=0,S){const C=this.lines.get(n);return C?C.translateToString(i,f,S):""}getWrappedRangeForLine(n){let i=n,f=n;for(;i>0&&this.lines.get(i).isWrapped;)i--;for(;f+1<this.lines.length&&this.lines.get(f+1).isWrapped;)f++;return{first:i,last:f}}setupTabStops(n){for(n!=null?this.tabs[n]||(n=this.prevStop(n)):(this.tabs={},n=0);n<this._cols;n+=this._optionsService.rawOptions.tabStopWidth)this.tabs[n]=!0}prevStop(n){for(n==null&&(n=this.x);!this.tabs[--n]&&n>0;);return n>=this._cols?this._cols-1:n<0?0:n}nextStop(n){for(n==null&&(n=this.x);!this.tabs[++n]&&n<this._cols;);return n>=this._cols?this._cols-1:n<0?0:n}clearMarkers(n){this._isClearing=!0;for(let i=0;i<this.markers.length;i++)this.markers[i].line===n&&(this.markers[i].dispose(),this.markers.splice(i--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let n=0;n<this.markers.length;n++)this.markers[n].dispose(),this.markers.splice(n--,1);this._isClearing=!1}addMarker(n){const i=new o.Marker(n);return this.markers.push(i),i.register(this.lines.onTrim((f=>{i.line-=f,i.line<0&&i.dispose()}))),i.register(this.lines.onInsert((f=>{i.line>=f.index&&(i.line+=f.amount)}))),i.register(this.lines.onDelete((f=>{i.line>=f.index&&i.line<f.index+f.amount&&i.dispose(),i.line>f.index&&(i.line-=f.amount)}))),i.register(i.onDispose((()=>this._removeMarker(i)))),i}_removeMarker(n){this._isClearing||this.markers.splice(this.markers.indexOf(n),1)}}},8437:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferLine=c.DEFAULT_ATTR_DATA=void 0;const g=u(3734),x=u(511),h=u(643),v=u(482);c.DEFAULT_ATTR_DATA=Object.freeze(new g.AttributeData);let w=0;class k{constructor(o,a,n=!1){this.isWrapped=n,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*o);const i=a||x.CellData.fromCharData([0,h.NULL_CELL_CHAR,h.NULL_CELL_WIDTH,h.NULL_CELL_CODE]);for(let f=0;f<o;++f)this.setCell(f,i);this.length=o}get(o){const a=this._data[3*o+0],n=2097151&a;return[this._data[3*o+1],2097152&a?this._combined[o]:n?(0,v.stringFromCodePoint)(n):"",a>>22,2097152&a?this._combined[o].charCodeAt(this._combined[o].length-1):n]}set(o,a){this._data[3*o+1]=a[h.CHAR_DATA_ATTR_INDEX],a[h.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[o]=a[1],this._data[3*o+0]=2097152|o|a[h.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*o+0]=a[h.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|a[h.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(o){return this._data[3*o+0]>>22}hasWidth(o){return 12582912&this._data[3*o+0]}getFg(o){return this._data[3*o+1]}getBg(o){return this._data[3*o+2]}hasContent(o){return 4194303&this._data[3*o+0]}getCodePoint(o){const a=this._data[3*o+0];return 2097152&a?this._combined[o].charCodeAt(this._combined[o].length-1):2097151&a}isCombined(o){return 2097152&this._data[3*o+0]}getString(o){const a=this._data[3*o+0];return 2097152&a?this._combined[o]:2097151&a?(0,v.stringFromCodePoint)(2097151&a):""}isProtected(o){return 536870912&this._data[3*o+2]}loadCell(o,a){return w=3*o,a.content=this._data[w+0],a.fg=this._data[w+1],a.bg=this._data[w+2],2097152&a.content&&(a.combinedData=this._combined[o]),268435456&a.bg&&(a.extended=this._extendedAttrs[o]),a}setCell(o,a){2097152&a.content&&(this._combined[o]=a.combinedData),268435456&a.bg&&(this._extendedAttrs[o]=a.extended),this._data[3*o+0]=a.content,this._data[3*o+1]=a.fg,this._data[3*o+2]=a.bg}setCellFromCodepoint(o,a,n,i){268435456&i.bg&&(this._extendedAttrs[o]=i.extended),this._data[3*o+0]=a|n<<22,this._data[3*o+1]=i.fg,this._data[3*o+2]=i.bg}addCodepointToCell(o,a,n){let i=this._data[3*o+0];2097152&i?this._combined[o]+=(0,v.stringFromCodePoint)(a):2097151&i?(this._combined[o]=(0,v.stringFromCodePoint)(2097151&i)+(0,v.stringFromCodePoint)(a),i&=-2097152,i|=2097152):i=a|4194304,n&&(i&=-12582913,i|=n<<22),this._data[3*o+0]=i}insertCells(o,a,n){if((o%=this.length)&&this.getWidth(o-1)===2&&this.setCellFromCodepoint(o-1,0,1,n),a<this.length-o){const i=new x.CellData;for(let f=this.length-o-a-1;f>=0;--f)this.setCell(o+a+f,this.loadCell(o+f,i));for(let f=0;f<a;++f)this.setCell(o+f,n)}else for(let i=o;i<this.length;++i)this.setCell(i,n);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,n)}deleteCells(o,a,n){if(o%=this.length,a<this.length-o){const i=new x.CellData;for(let f=0;f<this.length-o-a;++f)this.setCell(o+f,this.loadCell(o+a+f,i));for(let f=this.length-a;f<this.length;++f)this.setCell(f,n)}else for(let i=o;i<this.length;++i)this.setCell(i,n);o&&this.getWidth(o-1)===2&&this.setCellFromCodepoint(o-1,0,1,n),this.getWidth(o)!==0||this.hasContent(o)||this.setCellFromCodepoint(o,0,1,n)}replaceCells(o,a,n,i=!1){if(i)for(o&&this.getWidth(o-1)===2&&!this.isProtected(o-1)&&this.setCellFromCodepoint(o-1,0,1,n),a<this.length&&this.getWidth(a-1)===2&&!this.isProtected(a)&&this.setCellFromCodepoint(a,0,1,n);o<a&&o<this.length;)this.isProtected(o)||this.setCell(o,n),o++;else for(o&&this.getWidth(o-1)===2&&this.setCellFromCodepoint(o-1,0,1,n),a<this.length&&this.getWidth(a-1)===2&&this.setCellFromCodepoint(a,0,1,n);o<a&&o<this.length;)this.setCell(o++,n)}resize(o,a){if(o===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const n=3*o;if(o>this.length){if(this._data.buffer.byteLength>=4*n)this._data=new Uint32Array(this._data.buffer,0,n);else{const i=new Uint32Array(n);i.set(this._data),this._data=i}for(let i=this.length;i<o;++i)this.setCell(i,a)}else{this._data=this._data.subarray(0,n);const i=Object.keys(this._combined);for(let S=0;S<i.length;S++){const C=parseInt(i[S],10);C>=o&&delete this._combined[C]}const f=Object.keys(this._extendedAttrs);for(let S=0;S<f.length;S++){const C=parseInt(f[S],10);C>=o&&delete this._extendedAttrs[C]}}return this.length=o,4*n*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const o=new Uint32Array(this._data.length);return o.set(this._data),this._data=o,1}return 0}fill(o,a=!1){if(a)for(let n=0;n<this.length;++n)this.isProtected(n)||this.setCell(n,o);else{this._combined={},this._extendedAttrs={};for(let n=0;n<this.length;++n)this.setCell(n,o)}}copyFrom(o){this.length!==o.length?this._data=new Uint32Array(o._data):this._data.set(o._data),this.length=o.length,this._combined={};for(const a in o._combined)this._combined[a]=o._combined[a];this._extendedAttrs={};for(const a in o._extendedAttrs)this._extendedAttrs[a]=o._extendedAttrs[a];this.isWrapped=o.isWrapped}clone(){const o=new k(0);o._data=new Uint32Array(this._data),o.length=this.length;for(const a in this._combined)o._combined[a]=this._combined[a];for(const a in this._extendedAttrs)o._extendedAttrs[a]=this._extendedAttrs[a];return o.isWrapped=this.isWrapped,o}getTrimmedLength(){for(let o=this.length-1;o>=0;--o)if(4194303&this._data[3*o+0])return o+(this._data[3*o+0]>>22);return 0}getNoBgTrimmedLength(){for(let o=this.length-1;o>=0;--o)if(4194303&this._data[3*o+0]||50331648&this._data[3*o+2])return o+(this._data[3*o+0]>>22);return 0}copyCellsFrom(o,a,n,i,f){const S=o._data;if(f)for(let E=i-1;E>=0;E--){for(let y=0;y<3;y++)this._data[3*(n+E)+y]=S[3*(a+E)+y];268435456&S[3*(a+E)+2]&&(this._extendedAttrs[n+E]=o._extendedAttrs[a+E])}else for(let E=0;E<i;E++){for(let y=0;y<3;y++)this._data[3*(n+E)+y]=S[3*(a+E)+y];268435456&S[3*(a+E)+2]&&(this._extendedAttrs[n+E]=o._extendedAttrs[a+E])}const C=Object.keys(o._combined);for(let E=0;E<C.length;E++){const y=parseInt(C[E],10);y>=a&&(this._combined[y-a+n]=o._combined[y])}}translateToString(o,a,n,i){a=a??0,n=n??this.length,o&&(n=Math.min(n,this.getTrimmedLength())),i&&(i.length=0);let f="";for(;a<n;){const S=this._data[3*a+0],C=2097151&S,E=2097152&S?this._combined[a]:C?(0,v.stringFromCodePoint)(C):h.WHITESPACE_CELL_CHAR;if(f+=E,i)for(let y=0;y<E.length;++y)i.push(a);a+=S>>22||1}return i&&i.push(a),f}}c.BufferLine=k},4841:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.getRangeLength=void 0,c.getRangeLength=function(u,g){if(u.start.y>u.end.y)throw new Error(`Buffer range end (${u.end.x}, ${u.end.y}) cannot be before start (${u.start.x}, ${u.start.y})`);return g*(u.end.y-u.start.y)+(u.end.x-u.start.x+1)}},4634:(q,c)=>{function u(g,x,h){if(x===g.length-1)return g[x].getTrimmedLength();const v=!g[x].hasContent(h-1)&&g[x].getWidth(h-1)===1,w=g[x+1].getWidth(0)===2;return v&&w?h-1:h}Object.defineProperty(c,"__esModule",{value:!0}),c.getWrappedLineTrimmedLength=c.reflowSmallerGetNewLineLengths=c.reflowLargerApplyNewLayout=c.reflowLargerCreateNewLayout=c.reflowLargerGetLinesToRemove=void 0,c.reflowLargerGetLinesToRemove=function(g,x,h,v,w){const k=[];for(let _=0;_<g.length-1;_++){let o=_,a=g.get(++o);if(!a.isWrapped)continue;const n=[g.get(_)];for(;o<g.length&&a.isWrapped;)n.push(a),a=g.get(++o);if(v>=_&&v<o){_+=n.length-1;continue}let i=0,f=u(n,i,x),S=1,C=0;for(;S<n.length;){const y=u(n,S,x),P=y-C,O=h-f,F=Math.min(P,O);n[i].copyCellsFrom(n[S],C,f,F,!1),f+=F,f===h&&(i++,f=0),C+=F,C===y&&(S++,C=0),f===0&&i!==0&&n[i-1].getWidth(h-1)===2&&(n[i].copyCellsFrom(n[i-1],h-1,f++,1,!1),n[i-1].setCell(h-1,w))}n[i].replaceCells(f,h,w);let E=0;for(let y=n.length-1;y>0&&(y>i||n[y].getTrimmedLength()===0);y--)E++;E>0&&(k.push(_+n.length-E),k.push(E)),_+=n.length-1}return k},c.reflowLargerCreateNewLayout=function(g,x){const h=[];let v=0,w=x[v],k=0;for(let _=0;_<g.length;_++)if(w===_){const o=x[++v];g.onDeleteEmitter.fire({index:_-k,amount:o}),_+=o-1,k+=o,w=x[++v]}else h.push(_);return{layout:h,countRemoved:k}},c.reflowLargerApplyNewLayout=function(g,x){const h=[];for(let v=0;v<x.length;v++)h.push(g.get(x[v]));for(let v=0;v<h.length;v++)g.set(v,h[v]);g.length=x.length},c.reflowSmallerGetNewLineLengths=function(g,x,h){const v=[],w=g.map(((a,n)=>u(g,n,x))).reduce(((a,n)=>a+n));let k=0,_=0,o=0;for(;o<w;){if(w-o<h){v.push(w-o);break}k+=h;const a=u(g,_,x);k>a&&(k-=a,_++);const n=g[_].getWidth(k-1)===2;n&&k--;const i=n?h-1:h;v.push(i),o+=i}return v},c.getWrappedLineTrimmedLength=u},5295:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferSet=void 0;const g=u(8460),x=u(844),h=u(9092);class v extends x.Disposable{constructor(k,_){super(),this._optionsService=k,this._bufferService=_,this._onBufferActivate=this.register(new g.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",(()=>this.resize(this._bufferService.cols,this._bufferService.rows)))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",(()=>this.setupTabStops())))}reset(){this._normal=new h.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new h.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(k){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(k),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(k,_){this._normal.resize(k,_),this._alt.resize(k,_),this.setupTabStops(k)}setupTabStops(k){this._normal.setupTabStops(k),this._alt.setupTabStops(k)}}c.BufferSet=v},511:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CellData=void 0;const g=u(482),x=u(643),h=u(3734);class v extends h.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new h.ExtendedAttrs,this.combinedData=""}static fromCharData(k){const _=new v;return _.setFromCharData(k),_}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,g.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(k){this.fg=k[x.CHAR_DATA_ATTR_INDEX],this.bg=0;let _=!1;if(k[x.CHAR_DATA_CHAR_INDEX].length>2)_=!0;else if(k[x.CHAR_DATA_CHAR_INDEX].length===2){const o=k[x.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=o&&o<=56319){const a=k[x.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=a&&a<=57343?this.content=1024*(o-55296)+a-56320+65536|k[x.CHAR_DATA_WIDTH_INDEX]<<22:_=!0}else _=!0}else this.content=k[x.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|k[x.CHAR_DATA_WIDTH_INDEX]<<22;_&&(this.combinedData=k[x.CHAR_DATA_CHAR_INDEX],this.content=2097152|k[x.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}c.CellData=v},643:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.WHITESPACE_CELL_CODE=c.WHITESPACE_CELL_WIDTH=c.WHITESPACE_CELL_CHAR=c.NULL_CELL_CODE=c.NULL_CELL_WIDTH=c.NULL_CELL_CHAR=c.CHAR_DATA_CODE_INDEX=c.CHAR_DATA_WIDTH_INDEX=c.CHAR_DATA_CHAR_INDEX=c.CHAR_DATA_ATTR_INDEX=c.DEFAULT_EXT=c.DEFAULT_ATTR=c.DEFAULT_COLOR=void 0,c.DEFAULT_COLOR=0,c.DEFAULT_ATTR=256|c.DEFAULT_COLOR<<9,c.DEFAULT_EXT=0,c.CHAR_DATA_ATTR_INDEX=0,c.CHAR_DATA_CHAR_INDEX=1,c.CHAR_DATA_WIDTH_INDEX=2,c.CHAR_DATA_CODE_INDEX=3,c.NULL_CELL_CHAR="",c.NULL_CELL_WIDTH=1,c.NULL_CELL_CODE=0,c.WHITESPACE_CELL_CHAR=" ",c.WHITESPACE_CELL_WIDTH=1,c.WHITESPACE_CELL_CODE=32},4863:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Marker=void 0;const g=u(8460),x=u(844);class h{get id(){return this._id}constructor(w){this.line=w,this.isDisposed=!1,this._disposables=[],this._id=h._nextId++,this._onDispose=this.register(new g.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,x.disposeArray)(this._disposables),this._disposables.length=0)}register(w){return this._disposables.push(w),w}}c.Marker=h,h._nextId=1},7116:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DEFAULT_CHARSET=c.CHARSETS=void 0,c.CHARSETS={},c.DEFAULT_CHARSET=c.CHARSETS.B,c.CHARSETS[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""},c.CHARSETS.A={"#":""},c.CHARSETS.B=void 0,c.CHARSETS[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""},c.CHARSETS.C=c.CHARSETS[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},c.CHARSETS.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},c.CHARSETS.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.E=c.CHARSETS[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""},c.CHARSETS.H=c.CHARSETS[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},c.CHARSETS["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""}},2584:(q,c)=>{var u,g,x;Object.defineProperty(c,"__esModule",{value:!0}),c.C1_ESCAPED=c.C1=c.C0=void 0,(function(h){h.NUL="\0",h.SOH="",h.STX="",h.ETX="",h.EOT="",h.ENQ="",h.ACK="",h.BEL="\x07",h.BS="\b",h.HT="	",h.LF=`
`,h.VT="\v",h.FF="\f",h.CR="\r",h.SO="",h.SI="",h.DLE="",h.DC1="",h.DC2="",h.DC3="",h.DC4="",h.NAK="",h.SYN="",h.ETB="",h.CAN="",h.EM="",h.SUB="",h.ESC="\x1B",h.FS="",h.GS="",h.RS="",h.US="",h.SP=" ",h.DEL=""})(u||(c.C0=u={})),(function(h){h.PAD="",h.HOP="",h.BPH="",h.NBH="",h.IND="",h.NEL="",h.SSA="",h.ESA="",h.HTS="",h.HTJ="",h.VTS="",h.PLD="",h.PLU="",h.RI="",h.SS2="",h.SS3="",h.DCS="",h.PU1="",h.PU2="",h.STS="",h.CCH="",h.MW="",h.SPA="",h.EPA="",h.SOS="",h.SGCI="",h.SCI="",h.CSI="",h.ST="",h.OSC="",h.PM="",h.APC=""})(g||(c.C1=g={})),(function(h){h.ST=`${u.ESC}\\`})(x||(c.C1_ESCAPED=x={}))},7399:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.evaluateKeyboardEvent=void 0;const g=u(2584),x={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};c.evaluateKeyboardEvent=function(h,v,w,k){const _={type:0,cancel:!1,key:void 0},o=(h.shiftKey?1:0)|(h.altKey?2:0)|(h.ctrlKey?4:0)|(h.metaKey?8:0);switch(h.keyCode){case 0:h.key==="UIKeyInputUpArrow"?_.key=v?g.C0.ESC+"OA":g.C0.ESC+"[A":h.key==="UIKeyInputLeftArrow"?_.key=v?g.C0.ESC+"OD":g.C0.ESC+"[D":h.key==="UIKeyInputRightArrow"?_.key=v?g.C0.ESC+"OC":g.C0.ESC+"[C":h.key==="UIKeyInputDownArrow"&&(_.key=v?g.C0.ESC+"OB":g.C0.ESC+"[B");break;case 8:_.key=h.ctrlKey?"\b":g.C0.DEL,h.altKey&&(_.key=g.C0.ESC+_.key);break;case 9:if(h.shiftKey){_.key=g.C0.ESC+"[Z";break}_.key=g.C0.HT,_.cancel=!0;break;case 13:_.key=h.altKey?g.C0.ESC+g.C0.CR:g.C0.CR,_.cancel=!0;break;case 27:_.key=g.C0.ESC,h.altKey&&(_.key=g.C0.ESC+g.C0.ESC),_.cancel=!0;break;case 37:if(h.metaKey)break;o?(_.key=g.C0.ESC+"[1;"+(o+1)+"D",_.key===g.C0.ESC+"[1;3D"&&(_.key=g.C0.ESC+(w?"b":"[1;5D"))):_.key=v?g.C0.ESC+"OD":g.C0.ESC+"[D";break;case 39:if(h.metaKey)break;o?(_.key=g.C0.ESC+"[1;"+(o+1)+"C",_.key===g.C0.ESC+"[1;3C"&&(_.key=g.C0.ESC+(w?"f":"[1;5C"))):_.key=v?g.C0.ESC+"OC":g.C0.ESC+"[C";break;case 38:if(h.metaKey)break;o?(_.key=g.C0.ESC+"[1;"+(o+1)+"A",w||_.key!==g.C0.ESC+"[1;3A"||(_.key=g.C0.ESC+"[1;5A")):_.key=v?g.C0.ESC+"OA":g.C0.ESC+"[A";break;case 40:if(h.metaKey)break;o?(_.key=g.C0.ESC+"[1;"+(o+1)+"B",w||_.key!==g.C0.ESC+"[1;3B"||(_.key=g.C0.ESC+"[1;5B")):_.key=v?g.C0.ESC+"OB":g.C0.ESC+"[B";break;case 45:h.shiftKey||h.ctrlKey||(_.key=g.C0.ESC+"[2~");break;case 46:_.key=o?g.C0.ESC+"[3;"+(o+1)+"~":g.C0.ESC+"[3~";break;case 36:_.key=o?g.C0.ESC+"[1;"+(o+1)+"H":v?g.C0.ESC+"OH":g.C0.ESC+"[H";break;case 35:_.key=o?g.C0.ESC+"[1;"+(o+1)+"F":v?g.C0.ESC+"OF":g.C0.ESC+"[F";break;case 33:h.shiftKey?_.type=2:h.ctrlKey?_.key=g.C0.ESC+"[5;"+(o+1)+"~":_.key=g.C0.ESC+"[5~";break;case 34:h.shiftKey?_.type=3:h.ctrlKey?_.key=g.C0.ESC+"[6;"+(o+1)+"~":_.key=g.C0.ESC+"[6~";break;case 112:_.key=o?g.C0.ESC+"[1;"+(o+1)+"P":g.C0.ESC+"OP";break;case 113:_.key=o?g.C0.ESC+"[1;"+(o+1)+"Q":g.C0.ESC+"OQ";break;case 114:_.key=o?g.C0.ESC+"[1;"+(o+1)+"R":g.C0.ESC+"OR";break;case 115:_.key=o?g.C0.ESC+"[1;"+(o+1)+"S":g.C0.ESC+"OS";break;case 116:_.key=o?g.C0.ESC+"[15;"+(o+1)+"~":g.C0.ESC+"[15~";break;case 117:_.key=o?g.C0.ESC+"[17;"+(o+1)+"~":g.C0.ESC+"[17~";break;case 118:_.key=o?g.C0.ESC+"[18;"+(o+1)+"~":g.C0.ESC+"[18~";break;case 119:_.key=o?g.C0.ESC+"[19;"+(o+1)+"~":g.C0.ESC+"[19~";break;case 120:_.key=o?g.C0.ESC+"[20;"+(o+1)+"~":g.C0.ESC+"[20~";break;case 121:_.key=o?g.C0.ESC+"[21;"+(o+1)+"~":g.C0.ESC+"[21~";break;case 122:_.key=o?g.C0.ESC+"[23;"+(o+1)+"~":g.C0.ESC+"[23~";break;case 123:_.key=o?g.C0.ESC+"[24;"+(o+1)+"~":g.C0.ESC+"[24~";break;default:if(!h.ctrlKey||h.shiftKey||h.altKey||h.metaKey)if(w&&!k||!h.altKey||h.metaKey)!w||h.altKey||h.ctrlKey||h.shiftKey||!h.metaKey?h.key&&!h.ctrlKey&&!h.altKey&&!h.metaKey&&h.keyCode>=48&&h.key.length===1?_.key=h.key:h.key&&h.ctrlKey&&(h.key==="_"&&(_.key=g.C0.US),h.key==="@"&&(_.key=g.C0.NUL)):h.keyCode===65&&(_.type=1);else{const a=x[h.keyCode],n=a==null?void 0:a[h.shiftKey?1:0];if(n)_.key=g.C0.ESC+n;else if(h.keyCode>=65&&h.keyCode<=90){const i=h.ctrlKey?h.keyCode-64:h.keyCode+32;let f=String.fromCharCode(i);h.shiftKey&&(f=f.toUpperCase()),_.key=g.C0.ESC+f}else if(h.keyCode===32)_.key=g.C0.ESC+(h.ctrlKey?g.C0.NUL:" ");else if(h.key==="Dead"&&h.code.startsWith("Key")){let i=h.code.slice(3,4);h.shiftKey||(i=i.toLowerCase()),_.key=g.C0.ESC+i,_.cancel=!0}}else h.keyCode>=65&&h.keyCode<=90?_.key=String.fromCharCode(h.keyCode-64):h.keyCode===32?_.key=g.C0.NUL:h.keyCode>=51&&h.keyCode<=55?_.key=String.fromCharCode(h.keyCode-51+27):h.keyCode===56?_.key=g.C0.DEL:h.keyCode===219?_.key=g.C0.ESC:h.keyCode===220?_.key=g.C0.FS:h.keyCode===221&&(_.key=g.C0.GS)}return _}},482:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Utf8ToUtf32=c.StringToUtf32=c.utf32ToString=c.stringFromCodePoint=void 0,c.stringFromCodePoint=function(u){return u>65535?(u-=65536,String.fromCharCode(55296+(u>>10))+String.fromCharCode(u%1024+56320)):String.fromCharCode(u)},c.utf32ToString=function(u,g=0,x=u.length){let h="";for(let v=g;v<x;++v){let w=u[v];w>65535?(w-=65536,h+=String.fromCharCode(55296+(w>>10))+String.fromCharCode(w%1024+56320)):h+=String.fromCharCode(w)}return h},c.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(u,g){const x=u.length;if(!x)return 0;let h=0,v=0;if(this._interim){const w=u.charCodeAt(v++);56320<=w&&w<=57343?g[h++]=1024*(this._interim-55296)+w-56320+65536:(g[h++]=this._interim,g[h++]=w),this._interim=0}for(let w=v;w<x;++w){const k=u.charCodeAt(w);if(55296<=k&&k<=56319){if(++w>=x)return this._interim=k,h;const _=u.charCodeAt(w);56320<=_&&_<=57343?g[h++]=1024*(k-55296)+_-56320+65536:(g[h++]=k,g[h++]=_)}else k!==65279&&(g[h++]=k)}return h}},c.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(u,g){const x=u.length;if(!x)return 0;let h,v,w,k,_=0,o=0,a=0;if(this.interim[0]){let f=!1,S=this.interim[0];S&=(224&S)==192?31:(240&S)==224?15:7;let C,E=0;for(;(C=63&this.interim[++E])&&E<4;)S<<=6,S|=C;const y=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,P=y-E;for(;a<P;){if(a>=x)return 0;if(C=u[a++],(192&C)!=128){a--,f=!0;break}this.interim[E++]=C,S<<=6,S|=63&C}f||(y===2?S<128?a--:g[_++]=S:y===3?S<2048||S>=55296&&S<=57343||S===65279||(g[_++]=S):S<65536||S>1114111||(g[_++]=S)),this.interim.fill(0)}const n=x-4;let i=a;for(;i<x;){for(;!(!(i<n)||128&(h=u[i])||128&(v=u[i+1])||128&(w=u[i+2])||128&(k=u[i+3]));)g[_++]=h,g[_++]=v,g[_++]=w,g[_++]=k,i+=4;if(h=u[i++],h<128)g[_++]=h;else if((224&h)==192){if(i>=x)return this.interim[0]=h,_;if(v=u[i++],(192&v)!=128){i--;continue}if(o=(31&h)<<6|63&v,o<128){i--;continue}g[_++]=o}else if((240&h)==224){if(i>=x)return this.interim[0]=h,_;if(v=u[i++],(192&v)!=128){i--;continue}if(i>=x)return this.interim[0]=h,this.interim[1]=v,_;if(w=u[i++],(192&w)!=128){i--;continue}if(o=(15&h)<<12|(63&v)<<6|63&w,o<2048||o>=55296&&o<=57343||o===65279)continue;g[_++]=o}else if((248&h)==240){if(i>=x)return this.interim[0]=h,_;if(v=u[i++],(192&v)!=128){i--;continue}if(i>=x)return this.interim[0]=h,this.interim[1]=v,_;if(w=u[i++],(192&w)!=128){i--;continue}if(i>=x)return this.interim[0]=h,this.interim[1]=v,this.interim[2]=w,_;if(k=u[i++],(192&k)!=128){i--;continue}if(o=(7&h)<<18|(63&v)<<12|(63&w)<<6|63&k,o<65536||o>1114111)continue;g[_++]=o}}return _}}},225:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.UnicodeV6=void 0;const g=u(1480),x=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],h=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let v;c.UnicodeV6=class{constructor(){if(this.version="6",!v){v=new Uint8Array(65536),v.fill(1),v[0]=0,v.fill(0,1,32),v.fill(0,127,160),v.fill(2,4352,4448),v[9001]=2,v[9002]=2,v.fill(2,11904,42192),v[12351]=1,v.fill(2,44032,55204),v.fill(2,63744,64256),v.fill(2,65040,65050),v.fill(2,65072,65136),v.fill(2,65280,65377),v.fill(2,65504,65511);for(let w=0;w<x.length;++w)v.fill(0,x[w][0],x[w][1]+1)}}wcwidth(w){return w<32?0:w<127?1:w<65536?v[w]:(function(k,_){let o,a=0,n=_.length-1;if(k<_[0][0]||k>_[n][1])return!1;for(;n>=a;)if(o=a+n>>1,k>_[o][1])a=o+1;else{if(!(k<_[o][0]))return!0;n=o-1}return!1})(w,h)?0:w>=131072&&w<=196605||w>=196608&&w<=262141?2:1}charProperties(w,k){let _=this.wcwidth(w),o=_===0&&k!==0;if(o){const a=g.UnicodeService.extractWidth(k);a===0?o=!1:a>_&&(_=a)}return g.UnicodeService.createPropertyValue(0,_,o)}}},5981:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.WriteBuffer=void 0;const g=u(8460),x=u(844);class h extends x.Disposable{constructor(w){super(),this._action=w,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new g.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(w,k){if(k!==void 0&&this._syncCalls>k)return void(this._syncCalls=0);if(this._pendingData+=w.length,this._writeBuffer.push(w),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let _;for(this._isSyncWriting=!0;_=this._writeBuffer.shift();){this._action(_);const o=this._callbacks.shift();o&&o()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(w,k){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=w.length,this._writeBuffer.push(w),this._callbacks.push(k),void this._innerWrite();setTimeout((()=>this._innerWrite()))}this._pendingData+=w.length,this._writeBuffer.push(w),this._callbacks.push(k)}_innerWrite(w=0,k=!0){const _=w||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const o=this._writeBuffer[this._bufferOffset],a=this._action(o,k);if(a){const i=f=>Date.now()-_>=12?setTimeout((()=>this._innerWrite(0,f))):this._innerWrite(_,f);return void a.catch((f=>(queueMicrotask((()=>{throw f})),Promise.resolve(!1)))).then(i)}const n=this._callbacks[this._bufferOffset];if(n&&n(),this._bufferOffset++,this._pendingData-=o.length,Date.now()-_>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout((()=>this._innerWrite()))):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}c.WriteBuffer=h},5941:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.toRgbString=c.parseColor=void 0;const u=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,g=/^[\da-f]+$/;function x(h,v){const w=h.toString(16),k=w.length<2?"0"+w:w;switch(v){case 4:return w[0];case 8:return k;case 12:return(k+k).slice(0,3);default:return k+k}}c.parseColor=function(h){if(!h)return;let v=h.toLowerCase();if(v.indexOf("rgb:")===0){v=v.slice(4);const w=u.exec(v);if(w){const k=w[1]?15:w[4]?255:w[7]?4095:65535;return[Math.round(parseInt(w[1]||w[4]||w[7]||w[10],16)/k*255),Math.round(parseInt(w[2]||w[5]||w[8]||w[11],16)/k*255),Math.round(parseInt(w[3]||w[6]||w[9]||w[12],16)/k*255)]}}else if(v.indexOf("#")===0&&(v=v.slice(1),g.exec(v)&&[3,6,9,12].includes(v.length))){const w=v.length/3,k=[0,0,0];for(let _=0;_<3;++_){const o=parseInt(v.slice(w*_,w*_+w),16);k[_]=w===1?o<<4:w===2?o:w===3?o>>4:o>>8}return k}},c.toRgbString=function(h,v=16){const[w,k,_]=h;return`rgb:${x(w,v)}/${x(k,v)}/${x(_,v)}`}},5770:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.PAYLOAD_LIMIT=void 0,c.PAYLOAD_LIMIT=1e7},6351:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DcsHandler=c.DcsParser=void 0;const g=u(482),x=u(8742),h=u(5770),v=[];c.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=v,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=v}registerHandler(k,_){this._handlers[k]===void 0&&(this._handlers[k]=[]);const o=this._handlers[k];return o.push(_),{dispose:()=>{const a=o.indexOf(_);a!==-1&&o.splice(a,1)}}}clearHandler(k){this._handlers[k]&&delete this._handlers[k]}setHandlerFallback(k){this._handlerFb=k}reset(){if(this._active.length)for(let k=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;k>=0;--k)this._active[k].unhook(!1);this._stack.paused=!1,this._active=v,this._ident=0}hook(k,_){if(this.reset(),this._ident=k,this._active=this._handlers[k]||v,this._active.length)for(let o=this._active.length-1;o>=0;o--)this._active[o].hook(_);else this._handlerFb(this._ident,"HOOK",_)}put(k,_,o){if(this._active.length)for(let a=this._active.length-1;a>=0;a--)this._active[a].put(k,_,o);else this._handlerFb(this._ident,"PUT",(0,g.utf32ToString)(k,_,o))}unhook(k,_=!0){if(this._active.length){let o=!1,a=this._active.length-1,n=!1;if(this._stack.paused&&(a=this._stack.loopPosition-1,o=_,n=this._stack.fallThrough,this._stack.paused=!1),!n&&o===!1){for(;a>=0&&(o=this._active[a].unhook(k),o!==!0);a--)if(o instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!1,o;a--}for(;a>=0;a--)if(o=this._active[a].unhook(!1),o instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=a,this._stack.fallThrough=!0,o}else this._handlerFb(this._ident,"UNHOOK",k);this._active=v,this._ident=0}};const w=new x.Params;w.addParam(0),c.DcsHandler=class{constructor(k){this._handler=k,this._data="",this._params=w,this._hitLimit=!1}hook(k){this._params=k.length>1||k.params[0]?k.clone():w,this._data="",this._hitLimit=!1}put(k,_,o){this._hitLimit||(this._data+=(0,g.utf32ToString)(k,_,o),this._data.length>h.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(k){let _=!1;if(this._hitLimit)_=!1;else if(k&&(_=this._handler(this._data,this._params),_ instanceof Promise))return _.then((o=>(this._params=w,this._data="",this._hitLimit=!1,o)));return this._params=w,this._data="",this._hitLimit=!1,_}}},2015:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.EscapeSequenceParser=c.VT500_TRANSITION_TABLE=c.TransitionTable=void 0;const g=u(844),x=u(8742),h=u(6242),v=u(6351);class w{constructor(a){this.table=new Uint8Array(a)}setDefault(a,n){this.table.fill(a<<4|n)}add(a,n,i,f){this.table[n<<8|a]=i<<4|f}addMany(a,n,i,f){for(let S=0;S<a.length;S++)this.table[n<<8|a[S]]=i<<4|f}}c.TransitionTable=w;const k=160;c.VT500_TRANSITION_TABLE=(function(){const o=new w(4095),a=Array.apply(null,Array(256)).map(((E,y)=>y)),n=(E,y)=>a.slice(E,y),i=n(32,127),f=n(0,24);f.push(25),f.push.apply(f,n(28,32));const S=n(0,14);let C;for(C in o.setDefault(1,0),o.addMany(i,0,2,0),S)o.addMany([24,26,153,154],C,3,0),o.addMany(n(128,144),C,3,0),o.addMany(n(144,152),C,3,0),o.add(156,C,0,0),o.add(27,C,11,1),o.add(157,C,4,8),o.addMany([152,158,159],C,0,7),o.add(155,C,11,3),o.add(144,C,11,9);return o.addMany(f,0,3,0),o.addMany(f,1,3,1),o.add(127,1,0,1),o.addMany(f,8,0,8),o.addMany(f,3,3,3),o.add(127,3,0,3),o.addMany(f,4,3,4),o.add(127,4,0,4),o.addMany(f,6,3,6),o.addMany(f,5,3,5),o.add(127,5,0,5),o.addMany(f,2,3,2),o.add(127,2,0,2),o.add(93,1,4,8),o.addMany(i,8,5,8),o.add(127,8,5,8),o.addMany([156,27,24,26,7],8,6,0),o.addMany(n(28,32),8,0,8),o.addMany([88,94,95],1,0,7),o.addMany(i,7,0,7),o.addMany(f,7,0,7),o.add(156,7,0,0),o.add(127,7,0,7),o.add(91,1,11,3),o.addMany(n(64,127),3,7,0),o.addMany(n(48,60),3,8,4),o.addMany([60,61,62,63],3,9,4),o.addMany(n(48,60),4,8,4),o.addMany(n(64,127),4,7,0),o.addMany([60,61,62,63],4,0,6),o.addMany(n(32,64),6,0,6),o.add(127,6,0,6),o.addMany(n(64,127),6,0,0),o.addMany(n(32,48),3,9,5),o.addMany(n(32,48),5,9,5),o.addMany(n(48,64),5,0,6),o.addMany(n(64,127),5,7,0),o.addMany(n(32,48),4,9,5),o.addMany(n(32,48),1,9,2),o.addMany(n(32,48),2,9,2),o.addMany(n(48,127),2,10,0),o.addMany(n(48,80),1,10,0),o.addMany(n(81,88),1,10,0),o.addMany([89,90,92],1,10,0),o.addMany(n(96,127),1,10,0),o.add(80,1,11,9),o.addMany(f,9,0,9),o.add(127,9,0,9),o.addMany(n(28,32),9,0,9),o.addMany(n(32,48),9,9,12),o.addMany(n(48,60),9,8,10),o.addMany([60,61,62,63],9,9,10),o.addMany(f,11,0,11),o.addMany(n(32,128),11,0,11),o.addMany(n(28,32),11,0,11),o.addMany(f,10,0,10),o.add(127,10,0,10),o.addMany(n(28,32),10,0,10),o.addMany(n(48,60),10,8,10),o.addMany([60,61,62,63],10,0,11),o.addMany(n(32,48),10,9,12),o.addMany(f,12,0,12),o.add(127,12,0,12),o.addMany(n(28,32),12,0,12),o.addMany(n(32,48),12,9,12),o.addMany(n(48,64),12,0,11),o.addMany(n(64,127),12,12,13),o.addMany(n(64,127),10,12,13),o.addMany(n(64,127),9,12,13),o.addMany(f,13,13,13),o.addMany(i,13,13,13),o.add(127,13,0,13),o.addMany([27,156,24,26],13,14,0),o.add(k,0,2,0),o.add(k,8,5,8),o.add(k,6,0,6),o.add(k,11,0,11),o.add(k,13,13,13),o})();class _ extends g.Disposable{constructor(a=c.VT500_TRANSITION_TABLE){super(),this._transitions=a,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new x.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(n,i,f)=>{},this._executeHandlerFb=n=>{},this._csiHandlerFb=(n,i)=>{},this._escHandlerFb=n=>{},this._errorHandlerFb=n=>n,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,g.toDisposable)((()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)}))),this._oscParser=this.register(new h.OscParser),this._dcsParser=this.register(new v.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},(()=>!0))}_identifier(a,n=[64,126]){let i=0;if(a.prefix){if(a.prefix.length>1)throw new Error("only one byte as prefix supported");if(i=a.prefix.charCodeAt(0),i&&60>i||i>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(a.intermediates){if(a.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let S=0;S<a.intermediates.length;++S){const C=a.intermediates.charCodeAt(S);if(32>C||C>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");i<<=8,i|=C}}if(a.final.length!==1)throw new Error("final must be a single byte");const f=a.final.charCodeAt(0);if(n[0]>f||f>n[1])throw new Error(`final must be in range ${n[0]} .. ${n[1]}`);return i<<=8,i|=f,i}identToString(a){const n=[];for(;a;)n.push(String.fromCharCode(255&a)),a>>=8;return n.reverse().join("")}setPrintHandler(a){this._printHandler=a}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(a,n){const i=this._identifier(a,[48,126]);this._escHandlers[i]===void 0&&(this._escHandlers[i]=[]);const f=this._escHandlers[i];return f.push(n),{dispose:()=>{const S=f.indexOf(n);S!==-1&&f.splice(S,1)}}}clearEscHandler(a){this._escHandlers[this._identifier(a,[48,126])]&&delete this._escHandlers[this._identifier(a,[48,126])]}setEscHandlerFallback(a){this._escHandlerFb=a}setExecuteHandler(a,n){this._executeHandlers[a.charCodeAt(0)]=n}clearExecuteHandler(a){this._executeHandlers[a.charCodeAt(0)]&&delete this._executeHandlers[a.charCodeAt(0)]}setExecuteHandlerFallback(a){this._executeHandlerFb=a}registerCsiHandler(a,n){const i=this._identifier(a);this._csiHandlers[i]===void 0&&(this._csiHandlers[i]=[]);const f=this._csiHandlers[i];return f.push(n),{dispose:()=>{const S=f.indexOf(n);S!==-1&&f.splice(S,1)}}}clearCsiHandler(a){this._csiHandlers[this._identifier(a)]&&delete this._csiHandlers[this._identifier(a)]}setCsiHandlerFallback(a){this._csiHandlerFb=a}registerDcsHandler(a,n){return this._dcsParser.registerHandler(this._identifier(a),n)}clearDcsHandler(a){this._dcsParser.clearHandler(this._identifier(a))}setDcsHandlerFallback(a){this._dcsParser.setHandlerFallback(a)}registerOscHandler(a,n){return this._oscParser.registerHandler(a,n)}clearOscHandler(a){this._oscParser.clearHandler(a)}setOscHandlerFallback(a){this._oscParser.setHandlerFallback(a)}setErrorHandler(a){this._errorHandler=a}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(a,n,i,f,S){this._parseStack.state=a,this._parseStack.handlers=n,this._parseStack.handlerPos=i,this._parseStack.transition=f,this._parseStack.chunkPos=S}parse(a,n,i){let f,S=0,C=0,E=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,E=this._parseStack.chunkPos+1;else{if(i===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const y=this._parseStack.handlers;let P=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(i===!1&&P>-1){for(;P>=0&&(f=y[P](this._params),f!==!0);P--)if(f instanceof Promise)return this._parseStack.handlerPos=P,f}this._parseStack.handlers=[];break;case 4:if(i===!1&&P>-1){for(;P>=0&&(f=y[P](),f!==!0);P--)if(f instanceof Promise)return this._parseStack.handlerPos=P,f}this._parseStack.handlers=[];break;case 6:if(S=a[this._parseStack.chunkPos],f=this._dcsParser.unhook(S!==24&&S!==26,i),f)return f;S===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(S=a[this._parseStack.chunkPos],f=this._oscParser.end(S!==24&&S!==26,i),f)return f;S===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,E=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let y=E;y<n;++y){switch(S=a[y],C=this._transitions.table[this.currentState<<8|(S<160?S:k)],C>>4){case 2:for(let B=y+1;;++B){if(B>=n||(S=a[B])<32||S>126&&S<k){this._printHandler(a,y,B),y=B-1;break}if(++B>=n||(S=a[B])<32||S>126&&S<k){this._printHandler(a,y,B),y=B-1;break}if(++B>=n||(S=a[B])<32||S>126&&S<k){this._printHandler(a,y,B),y=B-1;break}if(++B>=n||(S=a[B])<32||S>126&&S<k){this._printHandler(a,y,B),y=B-1;break}}break;case 3:this._executeHandlers[S]?this._executeHandlers[S]():this._executeHandlerFb(S),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:y,code:S,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const P=this._csiHandlers[this._collect<<8|S];let O=P?P.length-1:-1;for(;O>=0&&(f=P[O](this._params),f!==!0);O--)if(f instanceof Promise)return this._preserveStack(3,P,O,C,y),f;O<0&&this._csiHandlerFb(this._collect<<8|S,this._params),this.precedingJoinState=0;break;case 8:do switch(S){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(S-48)}while(++y<n&&(S=a[y])>47&&S<60);y--;break;case 9:this._collect<<=8,this._collect|=S;break;case 10:const F=this._escHandlers[this._collect<<8|S];let U=F?F.length-1:-1;for(;U>=0&&(f=F[U](),f!==!0);U--)if(f instanceof Promise)return this._preserveStack(4,F,U,C,y),f;U<0&&this._escHandlerFb(this._collect<<8|S),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|S,this._params);break;case 13:for(let B=y+1;;++B)if(B>=n||(S=a[B])===24||S===26||S===27||S>127&&S<k){this._dcsParser.put(a,y,B),y=B-1;break}break;case 14:if(f=this._dcsParser.unhook(S!==24&&S!==26),f)return this._preserveStack(6,[],0,C,y),f;S===27&&(C|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let B=y+1;;B++)if(B>=n||(S=a[B])<32||S>127&&S<k){this._oscParser.put(a,y,B),y=B-1;break}break;case 6:if(f=this._oscParser.end(S!==24&&S!==26),f)return this._preserveStack(5,[],0,C,y),f;S===27&&(C|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&C}}}c.EscapeSequenceParser=_},6242:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.OscHandler=c.OscParser=void 0;const g=u(5770),x=u(482),h=[];c.OscParser=class{constructor(){this._state=0,this._active=h,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(v,w){this._handlers[v]===void 0&&(this._handlers[v]=[]);const k=this._handlers[v];return k.push(w),{dispose:()=>{const _=k.indexOf(w);_!==-1&&k.splice(_,1)}}}clearHandler(v){this._handlers[v]&&delete this._handlers[v]}setHandlerFallback(v){this._handlerFb=v}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=h}reset(){if(this._state===2)for(let v=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;v>=0;--v)this._active[v].end(!1);this._stack.paused=!1,this._active=h,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||h,this._active.length)for(let v=this._active.length-1;v>=0;v--)this._active[v].start();else this._handlerFb(this._id,"START")}_put(v,w,k){if(this._active.length)for(let _=this._active.length-1;_>=0;_--)this._active[_].put(v,w,k);else this._handlerFb(this._id,"PUT",(0,x.utf32ToString)(v,w,k))}start(){this.reset(),this._state=1}put(v,w,k){if(this._state!==3){if(this._state===1)for(;w<k;){const _=v[w++];if(_===59){this._state=2,this._start();break}if(_<48||57<_)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+_-48}this._state===2&&k-w>0&&this._put(v,w,k)}}end(v,w=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let k=!1,_=this._active.length-1,o=!1;if(this._stack.paused&&(_=this._stack.loopPosition-1,k=w,o=this._stack.fallThrough,this._stack.paused=!1),!o&&k===!1){for(;_>=0&&(k=this._active[_].end(v),k!==!0);_--)if(k instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=_,this._stack.fallThrough=!1,k;_--}for(;_>=0;_--)if(k=this._active[_].end(!1),k instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=_,this._stack.fallThrough=!0,k}else this._handlerFb(this._id,"END",v);this._active=h,this._id=-1,this._state=0}}},c.OscHandler=class{constructor(v){this._handler=v,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(v,w,k){this._hitLimit||(this._data+=(0,x.utf32ToString)(v,w,k),this._data.length>g.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(v){let w=!1;if(this._hitLimit)w=!1;else if(v&&(w=this._handler(this._data),w instanceof Promise))return w.then((k=>(this._data="",this._hitLimit=!1,k)));return this._data="",this._hitLimit=!1,w}}},8742:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.Params=void 0;const u=2147483647;class g{static fromArray(h){const v=new g;if(!h.length)return v;for(let w=Array.isArray(h[0])?1:0;w<h.length;++w){const k=h[w];if(Array.isArray(k))for(let _=0;_<k.length;++_)v.addSubParam(k[_]);else v.addParam(k)}return v}constructor(h=32,v=32){if(this.maxLength=h,this.maxSubParamsLength=v,v>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(h),this.length=0,this._subParams=new Int32Array(v),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(h),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const h=new g(this.maxLength,this.maxSubParamsLength);return h.params.set(this.params),h.length=this.length,h._subParams.set(this._subParams),h._subParamsLength=this._subParamsLength,h._subParamsIdx.set(this._subParamsIdx),h._rejectDigits=this._rejectDigits,h._rejectSubDigits=this._rejectSubDigits,h._digitIsSub=this._digitIsSub,h}toArray(){const h=[];for(let v=0;v<this.length;++v){h.push(this.params[v]);const w=this._subParamsIdx[v]>>8,k=255&this._subParamsIdx[v];k-w>0&&h.push(Array.prototype.slice.call(this._subParams,w,k))}return h}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(h){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(h<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=h>u?u:h}}addSubParam(h){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(h<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=h>u?u:h,this._subParamsIdx[this.length-1]++}}hasSubParams(h){return(255&this._subParamsIdx[h])-(this._subParamsIdx[h]>>8)>0}getSubParams(h){const v=this._subParamsIdx[h]>>8,w=255&this._subParamsIdx[h];return w-v>0?this._subParams.subarray(v,w):null}getSubParamsAll(){const h={};for(let v=0;v<this.length;++v){const w=this._subParamsIdx[v]>>8,k=255&this._subParamsIdx[v];k-w>0&&(h[v]=this._subParams.slice(w,k))}return h}addDigit(h){let v;if(this._rejectDigits||!(v=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const w=this._digitIsSub?this._subParams:this.params,k=w[v-1];w[v-1]=~k?Math.min(10*k+h,u):h}}c.Params=g},5741:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.AddonManager=void 0,c.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let u=this._addons.length-1;u>=0;u--)this._addons[u].instance.dispose()}loadAddon(u,g){const x={instance:g,dispose:g.dispose,isDisposed:!1};this._addons.push(x),g.dispose=()=>this._wrappedAddonDispose(x),g.activate(u)}_wrappedAddonDispose(u){if(u.isDisposed)return;let g=-1;for(let x=0;x<this._addons.length;x++)if(this._addons[x]===u){g=x;break}if(g===-1)throw new Error("Could not dispose an addon that has not been loaded");u.isDisposed=!0,u.dispose.apply(u.instance),this._addons.splice(g,1)}}},8771:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferApiView=void 0;const g=u(3785),x=u(511);c.BufferApiView=class{constructor(h,v){this._buffer=h,this.type=v}init(h){return this._buffer=h,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(h){const v=this._buffer.lines.get(h);if(v)return new g.BufferLineApiView(v)}getNullCell(){return new x.CellData}}},3785:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferLineApiView=void 0;const g=u(511);c.BufferLineApiView=class{constructor(x){this._line=x}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(x,h){if(!(x<0||x>=this._line.length))return h?(this._line.loadCell(x,h),h):this._line.loadCell(x,new g.CellData)}translateToString(x,h,v){return this._line.translateToString(x,h,v)}}},8285:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.BufferNamespaceApi=void 0;const g=u(8771),x=u(8460),h=u(844);class v extends h.Disposable{constructor(k){super(),this._core=k,this._onBufferChange=this.register(new x.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new g.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new g.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate((()=>this._onBufferChange.fire(this.active)))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}c.BufferNamespaceApi=v},7975:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.ParserApi=void 0,c.ParserApi=class{constructor(u){this._core=u}registerCsiHandler(u,g){return this._core.registerCsiHandler(u,(x=>g(x.toArray())))}addCsiHandler(u,g){return this.registerCsiHandler(u,g)}registerDcsHandler(u,g){return this._core.registerDcsHandler(u,((x,h)=>g(x,h.toArray())))}addDcsHandler(u,g){return this.registerDcsHandler(u,g)}registerEscHandler(u,g){return this._core.registerEscHandler(u,g)}addEscHandler(u,g){return this.registerEscHandler(u,g)}registerOscHandler(u,g){return this._core.registerOscHandler(u,g)}addOscHandler(u,g){return this.registerOscHandler(u,g)}}},7090:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.UnicodeApi=void 0,c.UnicodeApi=class{constructor(u){this._core=u}register(u){this._core.unicodeService.register(u)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(u){this._core.unicodeService.activeVersion=u}}},744:function(q,c,u){var g=this&&this.__decorate||function(o,a,n,i){var f,S=arguments.length,C=S<3?a:i===null?i=Object.getOwnPropertyDescriptor(a,n):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(o,a,n,i);else for(var E=o.length-1;E>=0;E--)(f=o[E])&&(C=(S<3?f(C):S>3?f(a,n,C):f(a,n))||C);return S>3&&C&&Object.defineProperty(a,n,C),C},x=this&&this.__param||function(o,a){return function(n,i){a(n,i,o)}};Object.defineProperty(c,"__esModule",{value:!0}),c.BufferService=c.MINIMUM_ROWS=c.MINIMUM_COLS=void 0;const h=u(8460),v=u(844),w=u(5295),k=u(2585);c.MINIMUM_COLS=2,c.MINIMUM_ROWS=1;let _=c.BufferService=class extends v.Disposable{get buffer(){return this.buffers.active}constructor(o){super(),this.isUserScrolling=!1,this._onResize=this.register(new h.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new h.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(o.rawOptions.cols||0,c.MINIMUM_COLS),this.rows=Math.max(o.rawOptions.rows||0,c.MINIMUM_ROWS),this.buffers=this.register(new w.BufferSet(o,this))}resize(o,a){this.cols=o,this.rows=a,this.buffers.resize(o,a),this._onResize.fire({cols:o,rows:a})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(o,a=!1){const n=this.buffer;let i;i=this._cachedBlankLine,i&&i.length===this.cols&&i.getFg(0)===o.fg&&i.getBg(0)===o.bg||(i=n.getBlankLine(o,a),this._cachedBlankLine=i),i.isWrapped=a;const f=n.ybase+n.scrollTop,S=n.ybase+n.scrollBottom;if(n.scrollTop===0){const C=n.lines.isFull;S===n.lines.length-1?C?n.lines.recycle().copyFrom(i):n.lines.push(i.clone()):n.lines.splice(S+1,0,i.clone()),C?this.isUserScrolling&&(n.ydisp=Math.max(n.ydisp-1,0)):(n.ybase++,this.isUserScrolling||n.ydisp++)}else{const C=S-f+1;n.lines.shiftElements(f+1,C-1,-1),n.lines.set(S,i.clone())}this.isUserScrolling||(n.ydisp=n.ybase),this._onScroll.fire(n.ydisp)}scrollLines(o,a,n){const i=this.buffer;if(o<0){if(i.ydisp===0)return;this.isUserScrolling=!0}else o+i.ydisp>=i.ybase&&(this.isUserScrolling=!1);const f=i.ydisp;i.ydisp=Math.max(Math.min(i.ydisp+o,i.ybase),0),f!==i.ydisp&&(a||this._onScroll.fire(i.ydisp))}};c.BufferService=_=g([x(0,k.IOptionsService)],_)},7994:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.CharsetService=void 0,c.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(u){this.glevel=u,this.charset=this._charsets[u]}setgCharset(u,g){this._charsets[u]=g,this.glevel===u&&(this.charset=g)}}},1753:function(q,c,u){var g=this&&this.__decorate||function(i,f,S,C){var E,y=arguments.length,P=y<3?f:C===null?C=Object.getOwnPropertyDescriptor(f,S):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(i,f,S,C);else for(var O=i.length-1;O>=0;O--)(E=i[O])&&(P=(y<3?E(P):y>3?E(f,S,P):E(f,S))||P);return y>3&&P&&Object.defineProperty(f,S,P),P},x=this&&this.__param||function(i,f){return function(S,C){f(S,C,i)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CoreMouseService=void 0;const h=u(2585),v=u(8460),w=u(844),k={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:i=>i.button!==4&&i.action===1&&(i.ctrl=!1,i.alt=!1,i.shift=!1,!0)},VT200:{events:19,restrict:i=>i.action!==32},DRAG:{events:23,restrict:i=>i.action!==32||i.button!==3},ANY:{events:31,restrict:i=>!0}};function _(i,f){let S=(i.ctrl?16:0)|(i.shift?4:0)|(i.alt?8:0);return i.button===4?(S|=64,S|=i.action):(S|=3&i.button,4&i.button&&(S|=64),8&i.button&&(S|=128),i.action===32?S|=32:i.action!==0||f||(S|=3)),S}const o=String.fromCharCode,a={DEFAULT:i=>{const f=[_(i,!1)+32,i.col+32,i.row+32];return f[0]>255||f[1]>255||f[2]>255?"":`\x1B[M${o(f[0])}${o(f[1])}${o(f[2])}`},SGR:i=>{const f=i.action===0&&i.button!==4?"m":"M";return`\x1B[<${_(i,!0)};${i.col};${i.row}${f}`},SGR_PIXELS:i=>{const f=i.action===0&&i.button!==4?"m":"M";return`\x1B[<${_(i,!0)};${i.x};${i.y}${f}`}};let n=c.CoreMouseService=class extends w.Disposable{constructor(i,f){super(),this._bufferService=i,this._coreService=f,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new v.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const S of Object.keys(k))this.addProtocol(S,k[S]);for(const S of Object.keys(a))this.addEncoding(S,a[S]);this.reset()}addProtocol(i,f){this._protocols[i]=f}addEncoding(i,f){this._encodings[i]=f}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(i){if(!this._protocols[i])throw new Error(`unknown protocol "${i}"`);this._activeProtocol=i,this._onProtocolChange.fire(this._protocols[i].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(i){if(!this._encodings[i])throw new Error(`unknown encoding "${i}"`);this._activeEncoding=i}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(i){if(i.col<0||i.col>=this._bufferService.cols||i.row<0||i.row>=this._bufferService.rows||i.button===4&&i.action===32||i.button===3&&i.action!==32||i.button!==4&&(i.action===2||i.action===3)||(i.col++,i.row++,i.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,i,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(i))return!1;const f=this._encodings[this._activeEncoding](i);return f&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(f):this._coreService.triggerDataEvent(f,!0)),this._lastEvent=i,!0}explainEvents(i){return{down:!!(1&i),up:!!(2&i),drag:!!(4&i),move:!!(8&i),wheel:!!(16&i)}}_equalEvents(i,f,S){if(S){if(i.x!==f.x||i.y!==f.y)return!1}else if(i.col!==f.col||i.row!==f.row)return!1;return i.button===f.button&&i.action===f.action&&i.ctrl===f.ctrl&&i.alt===f.alt&&i.shift===f.shift}};c.CoreMouseService=n=g([x(0,h.IBufferService),x(1,h.ICoreService)],n)},6975:function(q,c,u){var g=this&&this.__decorate||function(n,i,f,S){var C,E=arguments.length,y=E<3?i:S===null?S=Object.getOwnPropertyDescriptor(i,f):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")y=Reflect.decorate(n,i,f,S);else for(var P=n.length-1;P>=0;P--)(C=n[P])&&(y=(E<3?C(y):E>3?C(i,f,y):C(i,f))||y);return E>3&&y&&Object.defineProperty(i,f,y),y},x=this&&this.__param||function(n,i){return function(f,S){i(f,S,n)}};Object.defineProperty(c,"__esModule",{value:!0}),c.CoreService=void 0;const h=u(1439),v=u(8460),w=u(844),k=u(2585),_=Object.freeze({insertMode:!1}),o=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let a=c.CoreService=class extends w.Disposable{constructor(n,i,f){super(),this._bufferService=n,this._logService=i,this._optionsService=f,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new v.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new v.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new v.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new v.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,h.clone)(_),this.decPrivateModes=(0,h.clone)(o)}reset(){this.modes=(0,h.clone)(_),this.decPrivateModes=(0,h.clone)(o)}triggerDataEvent(n,i=!1){if(this._optionsService.rawOptions.disableStdin)return;const f=this._bufferService.buffer;i&&this._optionsService.rawOptions.scrollOnUserInput&&f.ybase!==f.ydisp&&this._onRequestScrollToBottom.fire(),i&&this._onUserInput.fire(),this._logService.debug(`sending data "${n}"`,(()=>n.split("").map((S=>S.charCodeAt(0))))),this._onData.fire(n)}triggerBinaryEvent(n){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${n}"`,(()=>n.split("").map((i=>i.charCodeAt(0))))),this._onBinary.fire(n))}};c.CoreService=a=g([x(0,k.IBufferService),x(1,k.ILogService),x(2,k.IOptionsService)],a)},9074:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.DecorationService=void 0;const g=u(8055),x=u(8460),h=u(844),v=u(6106);let w=0,k=0;class _ extends h.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new v.SortedList((n=>n==null?void 0:n.marker.line)),this._onDecorationRegistered=this.register(new x.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new x.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,h.toDisposable)((()=>this.reset())))}registerDecoration(n){if(n.marker.isDisposed)return;const i=new o(n);if(i){const f=i.marker.onDispose((()=>i.dispose()));i.onDispose((()=>{i&&(this._decorations.delete(i)&&this._onDecorationRemoved.fire(i),f.dispose())})),this._decorations.insert(i),this._onDecorationRegistered.fire(i)}return i}reset(){for(const n of this._decorations.values())n.dispose();this._decorations.clear()}*getDecorationsAtCell(n,i,f){let S=0,C=0;for(const E of this._decorations.getKeyIterator(i))S=E.options.x??0,C=S+(E.options.width??1),n>=S&&n<C&&(!f||(E.options.layer??"bottom")===f)&&(yield E)}forEachDecorationAtCell(n,i,f,S){this._decorations.forEachByKey(i,(C=>{w=C.options.x??0,k=w+(C.options.width??1),n>=w&&n<k&&(!f||(C.options.layer??"bottom")===f)&&S(C)}))}}c.DecorationService=_;class o extends h.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=g.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=g.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(n){super(),this.options=n,this.onRenderEmitter=this.register(new x.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new x.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=n.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.InstantiationService=c.ServiceCollection=void 0;const g=u(2585),x=u(8343);class h{constructor(...w){this._entries=new Map;for(const[k,_]of w)this.set(k,_)}set(w,k){const _=this._entries.get(w);return this._entries.set(w,k),_}forEach(w){for(const[k,_]of this._entries.entries())w(k,_)}has(w){return this._entries.has(w)}get(w){return this._entries.get(w)}}c.ServiceCollection=h,c.InstantiationService=class{constructor(){this._services=new h,this._services.set(g.IInstantiationService,this)}setService(v,w){this._services.set(v,w)}getService(v){return this._services.get(v)}createInstance(v,...w){const k=(0,x.getServiceDependencies)(v).sort(((a,n)=>a.index-n.index)),_=[];for(const a of k){const n=this._services.get(a.id);if(!n)throw new Error(`[createInstance] ${v.name} depends on UNKNOWN service ${a.id}.`);_.push(n)}const o=k.length>0?k[0].index:w.length;if(w.length!==o)throw new Error(`[createInstance] First service dependency of ${v.name} at position ${o+1} conflicts with ${w.length} static arguments`);return new v(...w,..._)}}},7866:function(q,c,u){var g=this&&this.__decorate||function(o,a,n,i){var f,S=arguments.length,C=S<3?a:i===null?i=Object.getOwnPropertyDescriptor(a,n):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(o,a,n,i);else for(var E=o.length-1;E>=0;E--)(f=o[E])&&(C=(S<3?f(C):S>3?f(a,n,C):f(a,n))||C);return S>3&&C&&Object.defineProperty(a,n,C),C},x=this&&this.__param||function(o,a){return function(n,i){a(n,i,o)}};Object.defineProperty(c,"__esModule",{value:!0}),c.traceCall=c.setTraceLogger=c.LogService=void 0;const h=u(844),v=u(2585),w={trace:v.LogLevelEnum.TRACE,debug:v.LogLevelEnum.DEBUG,info:v.LogLevelEnum.INFO,warn:v.LogLevelEnum.WARN,error:v.LogLevelEnum.ERROR,off:v.LogLevelEnum.OFF};let k,_=c.LogService=class extends h.Disposable{get logLevel(){return this._logLevel}constructor(o){super(),this._optionsService=o,this._logLevel=v.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",(()=>this._updateLogLevel()))),k=this}_updateLogLevel(){this._logLevel=w[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(o){for(let a=0;a<o.length;a++)typeof o[a]=="function"&&(o[a]=o[a]())}_log(o,a,n){this._evalLazyOptionalParams(n),o.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+a,...n)}trace(o,...a){var n;this._logLevel<=v.LogLevelEnum.TRACE&&this._log(((n=this._optionsService.options.logger)==null?void 0:n.trace.bind(this._optionsService.options.logger))??console.log,o,a)}debug(o,...a){var n;this._logLevel<=v.LogLevelEnum.DEBUG&&this._log(((n=this._optionsService.options.logger)==null?void 0:n.debug.bind(this._optionsService.options.logger))??console.log,o,a)}info(o,...a){var n;this._logLevel<=v.LogLevelEnum.INFO&&this._log(((n=this._optionsService.options.logger)==null?void 0:n.info.bind(this._optionsService.options.logger))??console.info,o,a)}warn(o,...a){var n;this._logLevel<=v.LogLevelEnum.WARN&&this._log(((n=this._optionsService.options.logger)==null?void 0:n.warn.bind(this._optionsService.options.logger))??console.warn,o,a)}error(o,...a){var n;this._logLevel<=v.LogLevelEnum.ERROR&&this._log(((n=this._optionsService.options.logger)==null?void 0:n.error.bind(this._optionsService.options.logger))??console.error,o,a)}};c.LogService=_=g([x(0,v.IOptionsService)],_),c.setTraceLogger=function(o){k=o},c.traceCall=function(o,a,n){if(typeof n.value!="function")throw new Error("not supported");const i=n.value;n.value=function(...f){if(k.logLevel!==v.LogLevelEnum.TRACE)return i.apply(this,f);k.trace(`GlyphRenderer#${i.name}(${f.map((C=>JSON.stringify(C))).join(", ")})`);const S=i.apply(this,f);return k.trace(`GlyphRenderer#${i.name} return`,S),S}}},7302:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.OptionsService=c.DEFAULT_OPTIONS=void 0;const g=u(8460),x=u(844),h=u(6114);c.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:h.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const v=["normal","bold","100","200","300","400","500","600","700","800","900"];class w extends x.Disposable{constructor(_){super(),this._onOptionChange=this.register(new g.EventEmitter),this.onOptionChange=this._onOptionChange.event;const o={...c.DEFAULT_OPTIONS};for(const a in _)if(a in o)try{const n=_[a];o[a]=this._sanitizeAndValidateOption(a,n)}catch(n){console.error(n)}this.rawOptions=o,this.options={...o},this._setupOptions(),this.register((0,x.toDisposable)((()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null})))}onSpecificOptionChange(_,o){return this.onOptionChange((a=>{a===_&&o(this.rawOptions[_])}))}onMultipleOptionChange(_,o){return this.onOptionChange((a=>{_.indexOf(a)!==-1&&o()}))}_setupOptions(){const _=a=>{if(!(a in c.DEFAULT_OPTIONS))throw new Error(`No option with key "${a}"`);return this.rawOptions[a]},o=(a,n)=>{if(!(a in c.DEFAULT_OPTIONS))throw new Error(`No option with key "${a}"`);n=this._sanitizeAndValidateOption(a,n),this.rawOptions[a]!==n&&(this.rawOptions[a]=n,this._onOptionChange.fire(a))};for(const a in this.rawOptions){const n={get:_.bind(this,a),set:o.bind(this,a)};Object.defineProperty(this.options,a,n)}}_sanitizeAndValidateOption(_,o){switch(_){case"cursorStyle":if(o||(o=c.DEFAULT_OPTIONS[_]),!(function(a){return a==="block"||a==="underline"||a==="bar"})(o))throw new Error(`"${o}" is not a valid value for ${_}`);break;case"wordSeparator":o||(o=c.DEFAULT_OPTIONS[_]);break;case"fontWeight":case"fontWeightBold":if(typeof o=="number"&&1<=o&&o<=1e3)break;o=v.includes(o)?o:c.DEFAULT_OPTIONS[_];break;case"cursorWidth":o=Math.floor(o);case"lineHeight":case"tabStopWidth":if(o<1)throw new Error(`${_} cannot be less than 1, value: ${o}`);break;case"minimumContrastRatio":o=Math.max(1,Math.min(21,Math.round(10*o)/10));break;case"scrollback":if((o=Math.min(o,4294967295))<0)throw new Error(`${_} cannot be less than 0, value: ${o}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(o<=0)throw new Error(`${_} cannot be less than or equal to 0, value: ${o}`);break;case"rows":case"cols":if(!o&&o!==0)throw new Error(`${_} must be numeric, value: ${o}`);break;case"windowsPty":o=o??{}}return o}}c.OptionsService=w},2660:function(q,c,u){var g=this&&this.__decorate||function(w,k,_,o){var a,n=arguments.length,i=n<3?k:o===null?o=Object.getOwnPropertyDescriptor(k,_):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(w,k,_,o);else for(var f=w.length-1;f>=0;f--)(a=w[f])&&(i=(n<3?a(i):n>3?a(k,_,i):a(k,_))||i);return n>3&&i&&Object.defineProperty(k,_,i),i},x=this&&this.__param||function(w,k){return function(_,o){k(_,o,w)}};Object.defineProperty(c,"__esModule",{value:!0}),c.OscLinkService=void 0;const h=u(2585);let v=c.OscLinkService=class{constructor(w){this._bufferService=w,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(w){const k=this._bufferService.buffer;if(w.id===void 0){const f=k.addMarker(k.ybase+k.y),S={data:w,id:this._nextId++,lines:[f]};return f.onDispose((()=>this._removeMarkerFromLink(S,f))),this._dataByLinkId.set(S.id,S),S.id}const _=w,o=this._getEntryIdKey(_),a=this._entriesWithId.get(o);if(a)return this.addLineToLink(a.id,k.ybase+k.y),a.id;const n=k.addMarker(k.ybase+k.y),i={id:this._nextId++,key:this._getEntryIdKey(_),data:_,lines:[n]};return n.onDispose((()=>this._removeMarkerFromLink(i,n))),this._entriesWithId.set(i.key,i),this._dataByLinkId.set(i.id,i),i.id}addLineToLink(w,k){const _=this._dataByLinkId.get(w);if(_&&_.lines.every((o=>o.line!==k))){const o=this._bufferService.buffer.addMarker(k);_.lines.push(o),o.onDispose((()=>this._removeMarkerFromLink(_,o)))}}getLinkData(w){var k;return(k=this._dataByLinkId.get(w))==null?void 0:k.data}_getEntryIdKey(w){return`${w.id};;${w.uri}`}_removeMarkerFromLink(w,k){const _=w.lines.indexOf(k);_!==-1&&(w.lines.splice(_,1),w.lines.length===0&&(w.data.id!==void 0&&this._entriesWithId.delete(w.key),this._dataByLinkId.delete(w.id)))}};c.OscLinkService=v=g([x(0,h.IBufferService)],v)},8343:(q,c)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.createDecorator=c.getServiceDependencies=c.serviceRegistry=void 0;const u="di$target",g="di$dependencies";c.serviceRegistry=new Map,c.getServiceDependencies=function(x){return x[g]||[]},c.createDecorator=function(x){if(c.serviceRegistry.has(x))return c.serviceRegistry.get(x);const h=function(v,w,k){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(_,o,a){o[u]===o?o[g].push({id:_,index:a}):(o[g]=[{id:_,index:a}],o[u]=o)})(h,v,k)};return h.toString=()=>x,c.serviceRegistry.set(x,h),h}},2585:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.IDecorationService=c.IUnicodeService=c.IOscLinkService=c.IOptionsService=c.ILogService=c.LogLevelEnum=c.IInstantiationService=c.ICharsetService=c.ICoreService=c.ICoreMouseService=c.IBufferService=void 0;const g=u(8343);var x;c.IBufferService=(0,g.createDecorator)("BufferService"),c.ICoreMouseService=(0,g.createDecorator)("CoreMouseService"),c.ICoreService=(0,g.createDecorator)("CoreService"),c.ICharsetService=(0,g.createDecorator)("CharsetService"),c.IInstantiationService=(0,g.createDecorator)("InstantiationService"),(function(h){h[h.TRACE=0]="TRACE",h[h.DEBUG=1]="DEBUG",h[h.INFO=2]="INFO",h[h.WARN=3]="WARN",h[h.ERROR=4]="ERROR",h[h.OFF=5]="OFF"})(x||(c.LogLevelEnum=x={})),c.ILogService=(0,g.createDecorator)("LogService"),c.IOptionsService=(0,g.createDecorator)("OptionsService"),c.IOscLinkService=(0,g.createDecorator)("OscLinkService"),c.IUnicodeService=(0,g.createDecorator)("UnicodeService"),c.IDecorationService=(0,g.createDecorator)("DecorationService")},1480:(q,c,u)=>{Object.defineProperty(c,"__esModule",{value:!0}),c.UnicodeService=void 0;const g=u(8460),x=u(225);class h{static extractShouldJoin(w){return(1&w)!=0}static extractWidth(w){return w>>1&3}static extractCharKind(w){return w>>3}static createPropertyValue(w,k,_=!1){return(16777215&w)<<3|(3&k)<<1|(_?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new g.EventEmitter,this.onChange=this._onChange.event;const w=new x.UnicodeV6;this.register(w),this._active=w.version,this._activeProvider=w}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(w){if(!this._providers[w])throw new Error(`unknown Unicode version "${w}"`);this._active=w,this._activeProvider=this._providers[w],this._onChange.fire(w)}register(w){this._providers[w.version]=w}wcwidth(w){return this._activeProvider.wcwidth(w)}getStringCellWidth(w){let k=0,_=0;const o=w.length;for(let a=0;a<o;++a){let n=w.charCodeAt(a);if(55296<=n&&n<=56319){if(++a>=o)return k+this.wcwidth(n);const S=w.charCodeAt(a);56320<=S&&S<=57343?n=1024*(n-55296)+S-56320+65536:k+=this.wcwidth(S)}const i=this.charProperties(n,_);let f=h.extractWidth(i);h.extractShouldJoin(i)&&(f-=h.extractWidth(_)),k+=f,_=i}return k}charProperties(w,k){return this._activeProvider.charProperties(w,k)}}c.UnicodeService=h}},I={};function $(q){var c=I[q];if(c!==void 0)return c.exports;var u=I[q]={exports:{}};return T[q].call(u.exports,u,u.exports,$),u.exports}var G={};return(()=>{var q=G;Object.defineProperty(q,"__esModule",{value:!0}),q.Terminal=void 0;const c=$(9042),u=$(3236),g=$(844),x=$(5741),h=$(8285),v=$(7975),w=$(7090),k=["cols","rows"];class _ extends g.Disposable{constructor(a){super(),this._core=this.register(new u.Terminal(a)),this._addonManager=this.register(new x.AddonManager),this._publicOptions={...this._core.options};const n=f=>this._core.options[f],i=(f,S)=>{this._checkReadonlyOptions(f),this._core.options[f]=S};for(const f in this._core.options){const S={get:n.bind(this,f),set:i.bind(this,f)};Object.defineProperty(this._publicOptions,f,S)}}_checkReadonlyOptions(a){if(k.includes(a))throw new Error(`Option "${a}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new v.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new w.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new h.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const a=this._core.coreService.decPrivateModes;let n="none";switch(this._core.coreMouseService.activeProtocol){case"X10":n="x10";break;case"VT200":n="vt200";break;case"DRAG":n="drag";break;case"ANY":n="any"}return{applicationCursorKeysMode:a.applicationCursorKeys,applicationKeypadMode:a.applicationKeypad,bracketedPasteMode:a.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:n,originMode:a.origin,reverseWraparoundMode:a.reverseWraparound,sendFocusMode:a.sendFocus,wraparoundMode:a.wraparound}}get options(){return this._publicOptions}set options(a){for(const n in a)this._publicOptions[n]=a[n]}blur(){this._core.blur()}focus(){this._core.focus()}input(a,n=!0){this._core.input(a,n)}resize(a,n){this._verifyIntegers(a,n),this._core.resize(a,n)}open(a){this._core.open(a)}attachCustomKeyEventHandler(a){this._core.attachCustomKeyEventHandler(a)}attachCustomWheelEventHandler(a){this._core.attachCustomWheelEventHandler(a)}registerLinkProvider(a){return this._core.registerLinkProvider(a)}registerCharacterJoiner(a){return this._checkProposedApi(),this._core.registerCharacterJoiner(a)}deregisterCharacterJoiner(a){this._checkProposedApi(),this._core.deregisterCharacterJoiner(a)}registerMarker(a=0){return this._verifyIntegers(a),this._core.registerMarker(a)}registerDecoration(a){return this._checkProposedApi(),this._verifyPositiveIntegers(a.x??0,a.width??0,a.height??0),this._core.registerDecoration(a)}hasSelection(){return this._core.hasSelection()}select(a,n,i){this._verifyIntegers(a,n,i),this._core.select(a,n,i)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(a,n){this._verifyIntegers(a,n),this._core.selectLines(a,n)}dispose(){super.dispose()}scrollLines(a){this._verifyIntegers(a),this._core.scrollLines(a)}scrollPages(a){this._verifyIntegers(a),this._core.scrollPages(a)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(a){this._verifyIntegers(a),this._core.scrollToLine(a)}clear(){this._core.clear()}write(a,n){this._core.write(a,n)}writeln(a,n){this._core.write(a),this._core.write(`\r
`,n)}paste(a){this._core.paste(a)}refresh(a,n){this._verifyIntegers(a,n),this._core.refresh(a,n)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(a){this._addonManager.loadAddon(this,a)}static get strings(){return c}_verifyIntegers(...a){for(const n of a)if(n===1/0||isNaN(n)||n%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...a){for(const n of a)if(n&&(n===1/0||isNaN(n)||n%1!=0||n<0))throw new Error("This API only accepts positive integers")}}q.Terminal=_})(),G})()))})(ul)),ul.exports}var zf=Hf(),hl={exports:{}},Uu;function $f(){return Uu||(Uu=1,(function(p,b){(function(T,I){p.exports=I()})(self,(()=>(()=>{var T={};return(()=>{var I=T;Object.defineProperty(I,"__esModule",{value:!0}),I.FitAddon=void 0,I.FitAddon=class{activate($){this._terminal=$}dispose(){}fit(){const $=this.proposeDimensions();if(!$||!this._terminal||isNaN($.cols)||isNaN($.rows))return;const G=this._terminal._core;this._terminal.rows===$.rows&&this._terminal.cols===$.cols||(G._renderService.clear(),this._terminal.resize($.cols,$.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const $=this._terminal._core,G=$._renderService.dimensions;if(G.css.cell.width===0||G.css.cell.height===0)return;const q=this._terminal.options.scrollback===0?0:$.viewport.scrollBarWidth,c=window.getComputedStyle(this._terminal.element.parentElement),u=parseInt(c.getPropertyValue("height")),g=Math.max(0,parseInt(c.getPropertyValue("width"))),x=window.getComputedStyle(this._terminal.element),h=u-(parseInt(x.getPropertyValue("padding-top"))+parseInt(x.getPropertyValue("padding-bottom"))),v=g-(parseInt(x.getPropertyValue("padding-right"))+parseInt(x.getPropertyValue("padding-left")))-q;return{cols:Math.max(2,Math.floor(v/G.css.cell.width)),rows:Math.max(1,Math.floor(h/G.css.cell.height))}}}})(),T})()))})(hl)),hl.exports}var Uf=$f();const Wf='git status --short && echo "---" && git branch --show-current',Kf='if command -v npm >/dev/null 2>&1; then npm test; elif command -v pnpm >/dev/null 2>&1; then pnpm test; elif command -v yarn >/dev/null 2>&1; then yarn test; elif command -v bun >/dev/null 2>&1; then bun test; else echo "No Node test runner found."; fi',qf=/^[a-zA-Z0-9._/-]{1,120}$/,Vf=p=>p.trim().toLowerCase(),Gf=p=>`'${String(p||"").replace(/'/g,`'"'"'`)}'`,mh=p=>{const b=Vf(p);return b.includes("aider")?{profile:"aider",supportsAsk:!0,supportsRun:!0}:/(claude|codex|gemini|amp)/.test(b)?{profile:"prompt",supportsAsk:!1,supportsRun:!1}:{profile:"shell",supportsAsk:!1,supportsRun:!1}},dl=(p,b)=>p.profile==="aider"?`/ask ${b}`:b,Po=(p,b)=>p.profile==="aider"?`/run ${b}`:b,Yf=(p,b)=>p==="pause"||p==="resume"||p==="status"||p==="test_and_fix"||p==="create_pr"?"shell":p==="plan"&&b.profile!=="shell"?"agent":"shell",Xf=p=>{const b=String(p||"").trim(),T=qf.test(b)&&!b.includes("..")?b:"main";return`TARGET_BRANCH=${Gf(T)}; CURRENT_BRANCH="$(git branch --show-current)"; if [ -z "$CURRENT_BRANCH" ]; then echo "Unable to detect current branch."; elif [ "$CURRENT_BRANCH" = "$TARGET_BRANCH" ]; then echo "Current branch equals target branch ($TARGET_BRANCH). Commit on a task branch first."; elif command -v gh >/dev/null 2>&1; then echo "Opening GitHub PR for $CURRENT_BRANCH -> $TARGET_BRANCH"; gh pr create --base "$TARGET_BRANCH" --head "$CURRENT_BRANCH" --fill --web || gh pr create --base "$TARGET_BRANCH" --head "$CURRENT_BRANCH" --title "PR: $CURRENT_BRANCH -> $TARGET_BRANCH" --body "Automated PR from Forkline task session." --web; elif command -v glab >/dev/null 2>&1; then echo "Opening GitLab MR for $CURRENT_BRANCH -> $TARGET_BRANCH"; glab mr create --source-branch "$CURRENT_BRANCH" --target-branch "$TARGET_BRANCH" --fill --web || glab mr create --source-branch "$CURRENT_BRANCH" --target-branch "$TARGET_BRANCH" --title "MR: $CURRENT_BRANCH -> $TARGET_BRANCH" --description "Automated MR from Forkline task session." --web; else echo "No PR CLI found. Install gh or glab, then run:"; echo "  gh pr create --base $TARGET_BRANCH --head $CURRENT_BRANCH --fill --web"; fi`},Qf=p=>{const b=mh(p.agentCommand),T=Yf(p.action,b),I=p.isBlocked;if(p.action==="pause")return{action:p.action,target:T,capabilities:b,steps:[{kind:"send",data:""}]};if(p.action==="resume")return{action:p.action,target:T,capabilities:b,steps:[{kind:"send_line",line:Po(b,p.agentCommand),clearLine:!0}]};if(I)return{action:p.action,target:T,capabilities:b,steps:[{kind:"hint",message:"Action is waiting on a confirmation prompt. Use approve/reject first."}]};if(p.action==="status"){if(T==="shell")return{action:p.action,target:T,capabilities:b,steps:[{kind:"send_line",line:Po(b,Wf)}]};const $=dl(b,"Show only the current git status and branch for this worktree.");return{action:p.action,target:T,capabilities:b,steps:[{kind:"send_line",line:$}]}}if(p.action==="test_and_fix"){if(T==="shell")return{action:p.action,target:T,capabilities:b,steps:[{kind:"send_line",line:Po(b,Kf)}]};const $=dl(b,"Run the relevant tests, fix failures, and summarize what changed.");return{action:p.action,target:T,capabilities:b,steps:[{kind:"send_line",line:$}]}}if(p.action==="plan"){const $=dl(b,"Create a concise 5-8 step execution plan and keep one step in progress at a time.");return{action:p.action,target:T,capabilities:b,steps:[{kind:"send_line",line:$}]}}if(p.action==="create_pr"){const $=Xf(p.parentBranch);return{action:p.action,target:T,capabilities:b,steps:[{kind:"send_line",line:Po(b,$)}]}}return{action:p.action,target:T,capabilities:b,steps:[{kind:"hint",message:"Unknown quick action."}]}},Jf=()=>{if(typeof navigator<"u"&&typeof navigator.platform=="string")return/win/i.test(navigator.platform);const p=globalThis.process;return p&&typeof p.platform=="string"?p.platform==="win32":!1},_h=p=>{const b=String(p??"");return Jf()?`'${b.replace(/'/g,"''")}'`:`'${b.replace(/'/g,`'"'"'`)}'`},Zf=p=>p.trim().toLowerCase(),Yn=(p,b)=>({id:p,label:b}),ep=new Set(["claude","gemini","amp","aider","codex"]),tp=new Set(["claude","gemini","amp","codex"]),gh=(p,b)=>{const T=b.trim().toLowerCase();if(!T||!ep.has(T))return p;const I=p.trim();return!I||I.includes("ForklineEvent=")?I:`{ __forkline_emit(){ printf '\\033]1337;ForklineEvent=%s\\007' "$1"; }; __forkline_emit 'type=agent_started;provider=${T}'; ${I}; __forkline_ec=$?; __forkline_emit "type=agent_exited;provider=${T};code=\${__forkline_ec}"; }`},Mo=p=>{const b=Zf(p);return b.includes("claude")?Yn("claude","Claude"):b.includes("aider")?Yn("aider","Aider"):b.includes("gemini")?Yn("gemini","Gemini"):b.includes("codex")?Yn("codex","Codex"):b.includes("amp")?Yn("amp","Amp"):Yn("shell","Shell")},rp=p=>{const b=Mo(p);return tp.has(b.id)},Lo=(p,b="default")=>{const T=String(p||"").trim();if(!T||b!=="bypass")return T;const I=Mo(T);return I.id==="claude"?/\b--dangerously-skip-permissions\b/i.test(T)||/\b--permission-mode(?:=|\s+)bypassPermissions\b/i.test(T)?T:`${T} --permission-mode bypassPermissions`:I.id==="codex"?/\b--dangerously-bypass-approvals-and-sandbox\b/i.test(T)?T:`${T} --dangerously-bypass-approvals-and-sandbox`:I.id==="gemini"?/\b--yolo\b/i.test(T)||/\b--approval-mode(?:=|\s+)yolo\b/i.test(T)?T:`${T} --approval-mode yolo`:I.id==="amp"?/\b--dangerously-allow-all\b/i.test(T)?T:`${T} --dangerously-allow-all`:T},Wu=(p,b,T={})=>{const I=Mo(p),$=T.permissionMode==="bypass"?"bypass":"default";let G=Lo(p,$);return b&&b.trim()&&(G=`${G} ${_h(b)}`),G=gh(G,I.id),{command:G}},an=p=>p==="shell"||p==="exited",Ku=p=>p==="agent"||p==="blocked"||p==="tui",qu=p=>an(p)||p==="booting",sp=p=>/[^\x00-\x1f\x7f]/.test(p),np=p=>p>="0"&&p<="9"||p===";"||p==="?"||p===">"||p===":",ip=p=>{let b=p;return b=b.replace(/(^|[\r\n])[ \t]*\??[0-9]{1,3}(?:;[0-9]{1,3}){0,6}[cnR](?=$|[\r\n])/g,"$1"),b=b.replace(/(^|[\r\n>:\s])[ \t]*(?:[0-9]{1,3}(?:;[0-9]{1,3}){1,6}c){1,8}(?=$|[\r\n:\s])/g,"$1"),b=b.replace(/(^|[\r\n>:\s])[ \t]*(?:25h){1,6}(?=$|[\r\n:\s])/g,"$1"),{sanitized:b,changed:b!==p}},op=(p,b="",T=!1)=>{const I=`${b}${String(p||"")}`;if(!I)return{sanitized:"",carry:"",strippedControlResponse:!1};let $="",G="",q=!1;const c=(u,g,x)=>{if(u==="I"||u==="O")return q=!0,{consumed:!0,nextIndex:g+x+1};if(u==="?"||u===">"||u>="0"&&u<="9"){let h=g+x+1;for(;h<I.length&&np(I[h]);)h+=1;if(h>=I.length)return G=I.slice(g),{consumed:!0,nextIndex:I.length};if(I[h]==="c"||I[h]==="n"||I[h]==="R")return q=!0,{consumed:!0,nextIndex:h+1}}return{consumed:!1,nextIndex:g+1}};for(let u=0;u<I.length;){const g=I[u];if(g!=="\x1B"){if(g===""){if(u+1>=I.length){G=I.slice(u);break}const v=c(I[u+1],u,1);if(v.consumed){u=v.nextIndex;continue}}$+=g,u+=1;continue}if(u+1>=I.length){G=I.slice(u);break}if(I[u+1]!=="["){if(I[u+1]==="]"){let v=u+2,w=!1;for(;v<I.length;){if(I[v]==="\x07"){w=!0,v+=1;break}if(I[v]==="\x1B"&&v+1<I.length&&I[v+1]==="\\"){w=!0,v+=2;break}v+=1}if(!w){G=I.slice(u);break}q=!0,u=v;continue}$+=g,u+=1;continue}if(u+2>=I.length){G=I.slice(u);break}const x=I[u+2];if(x==="I"||x==="O"){q=!0,u+=3;continue}const h=c(x,u,2);if(h.consumed){u=h.nextIndex;continue}$+=g,u+=1}if((q||T)&&$){const u=ip($);$=u.sanitized,u.changed&&(q=!0)}return{sanitized:$,carry:G,strippedControlResponse:q}},ap=/^[a-zA-Z0-9._/-]{1,120}$/,lp=(p,b)=>((p==null?void 0:p.mode)||"")===((b==null?void 0:b.mode)||"")&&((p==null?void 0:p.selectedPath)||"")===((b==null?void 0:b.selectedPath)||""),cp=(p,b)=>((p==null?void 0:p.contextTokens)??null)===((b==null?void 0:b.contextTokens)??null)&&((p==null?void 0:p.promptTokens)??null)===((b==null?void 0:b.promptTokens)??null)&&((p==null?void 0:p.completionTokens)??null)===((b==null?void 0:b.completionTokens)??null)&&((p==null?void 0:p.totalTokens)??null)===((b==null?void 0:b.totalTokens)??null)&&((p==null?void 0:p.contextWindow)??null)===((b==null?void 0:b.contextWindow)??null)&&((p==null?void 0:p.percentUsed)??null)===((b==null?void 0:b.percentUsed)??null)&&((p==null?void 0:p.costUsd)??null)===((b==null?void 0:b.costUsd)??null)&&((p==null?void 0:p.promptCostUsd)??null)===((b==null?void 0:b.promptCostUsd)??null)&&((p==null?void 0:p.completionCostUsd)??null)===((b==null?void 0:b.completionCostUsd)??null)&&((p==null?void 0:p.updatedAt)??null)===((b==null?void 0:b.updatedAt)??null),up=(p,b)=>{var T,I;return p.taskId===b.taskId&&p.cwd===b.cwd&&p.agentCommand===b.agentCommand&&p.context===b.context&&p.envVars===b.envVars&&p.prompt===b.prompt&&(p.permissionMode||"default")===(b.permissionMode||"default")&&p.launchCommandOverride===b.launchCommandOverride&&p.projectPath===b.projectPath&&p.parentBranch===b.parentBranch&&lp(p.livingSpecPreference,b.livingSpecPreference)&&p.livingSpecOverridePath===b.livingSpecOverridePath&&p.packageStoreStrategy===b.packageStoreStrategy&&p.pnpmStorePath===b.pnpmStorePath&&p.sharedCacheRoot===b.sharedCacheRoot&&p.sandboxMode===b.sandboxMode&&p.networkGuard===b.networkGuard&&p.isActive===b.isActive&&p.shouldBootstrap===b.shouldBootstrap&&(((T=p.capabilities)==null?void 0:T.autoMerge)??!1)===(((I=b.capabilities)==null?void 0:I.autoMerge)??!1)&&cp(p.taskUsage,b.taskUsage)&&p.isBlocked===b.isBlocked&&p.blockedReason===b.blockedReason&&p.onMerge===b.onMerge&&p.onDelete===b.onDelete&&p.onBootstrapped===b.onBootstrapped},Vu=()=>{const p=getComputedStyle(document.documentElement),b=p.getPropertyValue("--xterm-bg").trim()||"#000000",T=p.getPropertyValue("--xterm-fg").trim()||"#e5e5e5",I=p.getPropertyValue("--xterm-cursor").trim()||"#ffffff",$=p.getPropertyValue("--xterm-selection").trim()||"rgba(255, 255, 255, 0.2)",q=(document.documentElement.getAttribute("data-theme")||"").trim().toLowerCase().endsWith("light");return{minimumContrastRatio:q?4.5:1,theme:{background:b,foreground:T,cursor:I,cursorAccent:q?"#f8fafc":"#000000",selectionBackground:$,...q?{black:"#1f2937",red:"#dc2626",green:"#16a34a",yellow:"#a16207",blue:"#2563eb",magenta:"#a21caf",cyan:"#0e7490",white:"#334155",brightBlack:"#64748b",brightRed:"#ef4444",brightGreen:"#22c55e",brightYellow:"#ca8a04",brightBlue:"#3b82f6",brightMagenta:"#c026d3",brightCyan:"#0891b2",brightWhite:"#0f172a"}:{black:"#1f2937",red:"#ef4444",green:"#22c55e",yellow:"#eab308",blue:"#3b82f6",magenta:"#d946ef",cyan:"#06b6d4",white:"#e5e7eb",brightBlack:"#6b7280",brightRed:"#f87171",brightGreen:"#4ade80",brightYellow:"#facc15",brightBlue:"#60a5fa",brightMagenta:"#e879f9",brightCyan:"#22d3ee",brightWhite:"#ffffff"}}}},hp=({taskId:p,cwd:b,agentCommand:T,context:I,envVars:$,prompt:G,permissionMode:q="default",launchCommandOverride:c,projectPath:u,parentBranch:g,livingSpecPreference:x,livingSpecOverridePath:h,packageStoreStrategy:v,pnpmStorePath:w,sharedCacheRoot:k,sandboxMode:_,networkGuard:o,isActive:a=!0,shouldBootstrap:n,onBootstrapped:i,capabilities:f,taskUsage:S,isBlocked:C,blockedReason:E,onMerge:y,onDelete:P})=>{const O=`http://127.0.0.1:34567/api/task/${p}`,F=N.useRef(null),U=N.useRef(null),B=N.useRef(null),J=N.useRef(null),ie=N.useRef({cols:0,rows:0}),fe=N.useRef(O),_e=N.useRef(""),Y=N.useRef(null),R=N.useRef(0),M=N.useRef(0),A=N.useRef(0),j=N.useRef(-1),Z=N.useRef("booting"),he=N.useRef({mode:"booting",modeSeq:0,isBlocked:!1}),me=N.useRef(!1),ve=N.useRef(!1),W=N.useRef(null),D=N.useRef(!1),oe=N.useRef(null),ee=N.useRef(!1),xe=N.useRef(n),Ce=N.useRef(null),[Ke,Xe]=N.useState("booting"),[ft,gt]=N.useState(null),[Ae,Ht]=N.useState(null),[Nt,sr]=N.useState(null),[kt,De]=N.useState(null),[Qe,ir]=N.useState(!1),[Mt,or]=N.useState(!1),Re=N.useRef(null),ct=N.useRef(null),mt=N.useRef(!1),Ue=N.useRef(!1),ut=N.useRef([]),nt=N.useRef(""),Qt=N.useRef(!1),ar=N.useRef(0),Mr=N.useRef(!1),ur=N.useRef(i),Yt=N.useMemo(()=>mh(T),[T]),kr=N.useMemo(()=>Mo(T),[T]),lr=q==="bypass"?"bypass":"default",Fr=N.useMemo(()=>Lo(T,lr),[T,lr]),[Et,Jt]=N.useState(!1),[pt,Hr]=N.useState({isBlocked:!!C,blockedReason:C?E:void 0}),jt=Et?pt.isBlocked:!!C,Ls=(Et?pt.blockedReason:E)||E,hs=N.useMemo(()=>fh(S),[S]),es=N.useMemo(()=>Of(S),[S]),Xr=!!hs||!!es,br=N.useMemo(()=>!(S!=null&&S.updatedAt)||!Number.isFinite(S.updatedAt)?null:new Date(S.updatedAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),[S]),fr=N.useMemo(()=>{var ke;const ae=h==null?void 0:h.trim();if(ae)return ae;const be=(x==null?void 0:x.mode)==="single"?(ke=x.selectedPath)==null?void 0:ke.trim():"";return be||".agent_cache/FORKLINE_SPEC.md"},[h,x]),vt=N.useCallback(ae=>{ee.current!==ae&&(ee.current=ae)},[]),cn=N.useCallback(()=>{mt.current||(mt.current=!0,or(!0))},[]),ts=N.useCallback(()=>{mt.current=!1,or(!1)},[]),yr=N.useCallback((ae,be)=>{sr({phase:ae,detail:be})},[]),zt=N.useCallback(()=>{sr(null)},[]),rs=N.useMemo(()=>Nt?Nt.phase==="restoring"?{label:"Restoring session",percent:30}:Nt.phase==="preparing_workspace"?{label:"Preparing workspace metadata",percent:65}:Nt.phase==="waiting_for_agent"?{label:"Starting agent runtime",percent:97}:{label:"Relaunching agent",percent:92}:null,[Nt]),Ut=N.useMemo(()=>Nt&&rs?{label:rs.label,percent:rs.percent,detail:Nt.detail}:Qe?{label:"Loading session",percent:24,detail:"Attaching PTY and restoring task state for this tab."}:null,[Nt,rs,Qe]),zr=!!Ut&&!Mt,$r=!!Ut&&Mt,hr=(Ut==null?void 0:Ut.label)==="Starting agent runtime",bt=N.useCallback(()=>{D.current=!1,oe.current!==null&&(window.clearTimeout(oe.current),oe.current=null)},[]),Cs=N.useCallback(()=>{D.current=!0,oe.current!==null&&(window.clearTimeout(oe.current),oe.current=null),yr("waiting_for_agent","Waiting for agent startup output."),oe.current=window.setTimeout(()=>{var ae;oe.current=null,D.current&&(D.current=!1,zt(),(ae=U.current)==null||ae.writeln(`\r
[orchestrator] Agent launch is taking longer than expected. Terminal remains available while it starts.`))},15e3)},[zt,yr]),Ds=N.useCallback(async ae=>{var He,ot,lt;const be=String(ae||"").trim();if(!be)return!1;if(W.current)return bt(),zt(),vt(!1),!1;const ke=8;for(let Je=0;Je<=ke;Je+=1)try{const Me=await window.electronAPI.launchPty(p,be,{suppressEcho:!0});if(Me!=null&&Me.success)return Cs(),!0;const It=String((Me==null?void 0:Me.error)||"");if(/not running|session not found/i.test(It)&&W.current)return bt(),zt(),vt(!1),!1;if(Je<ke&&/not running|session not found/i.test(It)){const Ot=Y.current||{};if(window.electronAPI.createPty(p,b,Ot),await new Promise(Zt=>window.setTimeout(Zt,Math.min(1200,140*(Je+1)))),Ue.current)return!1;continue}return bt(),zt(),vt(!1),(He=U.current)==null||He.writeln(`\r
[orchestrator] Failed to relaunch agent: ${It||"unknown error"}`),!1}catch(Me){const It=Me instanceof Error?Me.message:"unknown error";if(Je<ke&&/not running|session not found/i.test(It)){const Ot=Y.current||{};if(window.electronAPI.createPty(p,b,Ot),await new Promise(Zt=>window.setTimeout(Zt,Math.min(1200,140*(Je+1)))),Ue.current)return!1;continue}return bt(),zt(),vt(!1),(ot=U.current)==null||ot.writeln(`\r
[orchestrator] Failed to relaunch agent: ${It}`),!1}return bt(),zt(),vt(!1),(lt=U.current)==null||lt.writeln(`\r
[orchestrator] Failed to relaunch agent: timed out.`),!1},[p,b,bt,zt,vt,Cs]),Ur=N.useCallback(()=>{ts(),ct.current!==null&&(window.clearTimeout(ct.current),ct.current=null),ct.current=window.setTimeout(()=>{ir(!0),ct.current=null},60)},[ts]),Er=N.useCallback(()=>{ct.current!==null&&(window.clearTimeout(ct.current),ct.current=null),ir(!1)},[]),pr=N.useMemo(()=>{if(!kt)return null;const ae=String(kt.mode||"sandbox").toLowerCase(),be=ae==="off"?"Sandbox":`Sandbox (${ae})`,ke=typeof kt.warning=="string"?kt.warning.trim():"";return ke?{tone:"warning",message:`${be}: ${ke}`}:kt.active&&kt.denyNetwork?{tone:"warning",message:`${be} is active. Outbound network is blocked for this session.`}:kt.active?{tone:"info",message:`${be} is active for this terminal session.`}:kt.denyNetwork?{tone:"warning",message:"Network guard was requested but could not be enforced for this session."}:null},[kt]),ds=N.useMemo(()=>Ae?`PTY startup failed: ${Ae}`:null,[Ae]),X=N.useCallback(()=>{var be;if(!me.current||!an(Z.current))return;const ae=Date.now();ae-ar.current<300||(ar.current=ae,(be=U.current)==null||be.write("\x1B[?25h"))},[]),se=N.useCallback(()=>{const ae=B.current,be=U.current;if(!(!ae||!be||Ue.current))try{ae.fit();const ke=be.cols,He=be.rows,ot=ie.current;if(ke===ot.cols&&He===ot.rows)return;ie.current={cols:ke,rows:He},window.electronAPI.resizePty(p,ke,He)}catch{}},[p]),te=N.useCallback(()=>{J.current===null&&(J.current=requestAnimationFrame(()=>{J.current=null,se()}))},[se]),de=N.useCallback((ae,be)=>{const ke={MULTI_AGENT_IDE_URL:ae||O,MULTI_AGENT_IDE_TOKEN:be||"",TERM:"xterm-256color",COLORTERM:"truecolor",TERM_PROGRAM:"Forkline",FORCE_COLOR:"1",CLICOLOR:"1",CLICOLOR_FORCE:"1",FORKLINE_SPEC_PATH:fr,FORKLINE_PACKAGE_STORE_STRATEGY:v||"off",FORKLINE_SANDBOX_MODE:_||"off",FORKLINE_NETWORK_GUARD:o||"off",FORKLINE_AGENT_COMMAND:Fr,FORKLINE_AGENT_PROVIDER:kr.id};return w!=null&&w.trim()&&(ke.FORKLINE_PNPM_STORE_PATH=w.trim()),k!=null&&k.trim()&&(ke.FORKLINE_SHARED_CACHE_ROOT=k.trim()),h!=null&&h.trim()&&(ke.FORKLINE_SPEC_OVERRIDE_PATH=h.trim()),$&&$.split(`
`).forEach(He=>{const[ot,...lt]=He.split("="),Je=lt.join("=");ot&&Je&&(ke[ot.trim()]=Je.trim())}),ke},[$,O,_,o,v,w,k,h,fr,Fr,kr.id]);N.useEffect(()=>{ur.current=i},[i]),N.useEffect(()=>{xe.current=n},[n]),N.useEffect(()=>()=>{Re.current!==null&&(window.clearTimeout(Re.current),Re.current=null),ct.current!==null&&(window.clearTimeout(ct.current),ct.current=null),oe.current!==null&&(window.clearTimeout(oe.current),oe.current=null)},[]),N.useEffect(()=>{Et||Hr({isBlocked:!!C,blockedReason:C?E:void 0})},[E,Et,C]),N.useEffect(()=>{jt&&vt(!0)},[jt,vt]);const pe=N.useCallback(()=>{const ae=Ce.current;return ae?(Ce.current=null,window.clearTimeout(ae.timeoutId),ae):null},[]),ue=N.useCallback(ae=>{const be=Number.isFinite(ae.modeSeq)?ae.modeSeq:0;if(be<=j.current)return;j.current=be;const ke=ae.mode||"booting";if(Z.current=ke,he.current={mode:ke,modeSeq:be,isBlocked:!!ae.isBlocked,blockedReason:ae.isBlocked?ae.blockedReason:void 0},Jt(!0),Hr({isBlocked:!!ae.isBlocked,blockedReason:ae.isBlocked?ae.blockedReason:void 0}),Xe(ke),ae.isBlocked){bt(),zt(),vt(!0);return}if(an(ke)){if(D.current){vt(!0);return}zt(),vt(!1),X();return}if(Ku(ke)){bt(),zt(),vt(!0);return}ke==="booting"&&vt(!0)},[bt,zt,X,vt]);N.useEffect(()=>{const ae=U.current;if(!ae)return;if(!a){try{ae.blur()}catch{}return}const be=requestAnimationFrame(()=>{const ke=U.current;!ke||Ue.current||(te(),ke.focus(),X())});return()=>cancelAnimationFrame(be)},[a,X,te]),N.useEffect(()=>{const ae=`http://127.0.0.1:34567/api/task/${p}`;fe.current=ae},[p]),N.useEffect(()=>{const ae=()=>{const ke=U.current;if(!ke)return;const He=Vu();ke.options.minimumContrastRatio=He.minimumContrastRatio,ke.options.theme=He.theme;try{ke.refresh(0,ke.rows-1)}catch{}};ae();const be=new MutationObserver(()=>{ae()});return be.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>{be.disconnect()}},[]),N.useEffect(()=>{if(!F.current||Mr.current)return;De(null),Ur();let ae=null,be=null,ke=null,He=null,ot=null,lt=null,Je=null,Me=null,It=!1,Ot=!1,Zt=null;Ue.current=!1;const mr=()=>{if(Ot||Ue.current||Mr.current||!F.current)return!1;const fs=F.current.getBoundingClientRect();if(fs.width===0||fs.height===0)return!1;try{const Ar=Vu();ae=new zf.Terminal({theme:Ar.theme,minimumContrastRatio:Ar.minimumContrastRatio,cursorBlink:!0,cursorStyle:"block",cursorInactiveStyle:"block",scrollback:1e5,allowTransparency:!1,drawBoldTextInBrightColors:!0,rightClickSelectsWord:!0,macOptionIsMeta:!0,altClickMovesCursor:!0,fastScrollModifier:"alt",fastScrollSensitivity:4,fontFamily:'"SF Mono", "SFMono-Regular", ui-monospace, Menlo, Monaco, Consolas, "Liberation Mono", monospace',fontSize:13,lineHeight:1.2}),be=new Uf.FitAddon,ae.loadAddon(be),ae.open(F.current),be.fit(),U.current=ae,B.current=be,Mr.current=!0,ae.attachCustomKeyEventHandler(Oe=>{const tt=Oe.key.toLowerCase(),Ft=navigator.platform.toUpperCase().includes("MAC")?Oe.metaKey:Oe.ctrlKey,Wt=Ft&&tt==="c"||Oe.ctrlKey&&Oe.shiftKey&&tt==="c",Kt=Ft&&tt==="v"||Oe.ctrlKey&&Oe.shiftKey&&tt==="v",ps=Ft&&tt==="k";if(Wt&&(ae!=null&&ae.hasSelection())){const $t=ae.getSelection();return $t&&window.electronAPI.writeClipboardText($t).then(ht=>{if(!(ht!=null&&ht.success))throw new Error((ht==null?void 0:ht.error)||"Clipboard write failed.")}).catch(()=>{}),!1}return Kt?(window.electronAPI.readClipboardText().then($t=>{!$t||Ot||ae==null||ae.paste($t)}).catch(()=>{}),!1):ps?(Oe.preventDefault(),Oe.stopPropagation(),window.dispatchEvent(new CustomEvent("orchestrator:open-command-palette")),!1):!0});let $e=de(fe.current);return Y.current=$e,ae.onData(Oe=>{const tt=op(Oe,nt.current,Qt.current);nt.current=tt.carry,Qt.current=!!tt.strippedControlResponse;const At=tt.sanitized;At&&window.electronAPI.writePty(p,At)}),ot=window.electronAPI.onPtyData(p,Oe=>{D.current||Er(),sp(String(Oe||""))&&cn(),ae==null||ae.write(Oe)}),lt=window.electronAPI.onPtyState(p,({created:Oe,running:tt,restarted:At,startError:Ft,sandbox:Wt})=>{if(Ot||Ue.current)return;Wt&&typeof Wt=="object"?De({mode:typeof Wt.mode=="string"?Wt.mode:"off",active:!!Wt.active,warning:typeof Wt.warning=="string"?Wt.warning:void 0,denyNetwork:!!Wt.denyNetwork}):Oe&&De(null),me.current=!!tt,ve.current=!1;const Kt=typeof Ft=="string"?Ft.trim():"";if(W.current=Kt||null,tt?Ht(null):Kt&&(bt(),Ht(Kt),Er(),zt(),vt(!1),It=!0),tt&&ut.current.splice(0).forEach(({continuation:_r,timeoutId:ks})=>{window.clearTimeout(ks),_r()}),Kt||It)return;It=!0;const ps=!!xe.current,$t=!ps&&!Oe&&!At&&qu(Z.current),ht=!ps&&(!!Oe||!!At||$t);if(!ps&&!ht){zt(),Er();return}if(ht){const er=Oe?"previous PTY session was missing":At?"previous PTY session was not live":Z.current==="booting"?"restored terminal mode was unresolved":"restored terminal was at a shell prompt";yr("restoring",er)}window.setTimeout(()=>{if(Ot||Ue.current)return;const er=fe.current,_r=ps&&(c!=null&&c.trim())?{command:Lo(c.trim(),lr)}:Wu(T,G,{permissionMode:lr}),ks=`IDE Capabilities API
--------------------
You are running inside Forkline.
You can interact with the IDE by sending HTTP requests to the local control server.

Base URL: ${er}
Authentication:
- Header: x-forkline-token: $MULTI_AGENT_IDE_TOKEN
- Alternate: Authorization: Bearer $MULTI_AGENT_IDE_TOKEN
Current Permissions:
- Merge Request: ${f!=null&&f.autoMerge?"Auto-Approve":"Requires Human Approval"}

Workspace Metadata Paths:
- Living Spec (if available): ${fr}
- Memory Context: .agent_cache/agent_memory.md

Endpoints:
1. POST ${er}/merge (returns 202 + requestId)
2. GET ${er.replace("/api/task/"+p,"")}/api/approval/:requestId (poll merge status)
3. POST ${er}/todos
4. POST ${er}/message
5. POST ${er}/usage (or /metrics)

Merge wait mode:
- Use ${er}/merge?wait=1 to wait for a decision inline (times out after 10 minutes).

curl example:
curl -s -H "x-forkline-token: $MULTI_AGENT_IDE_TOKEN" -H "content-type: application/json" -X POST ${er}/todos -d '{"todos":[{"id":"1","title":"Implement fix","status":"in_progress"}]}'
`;yr("preparing_workspace"),window.electronAPI.prepareAgentWorkspace(b,u,I||"",ks,x,h,_r.command).then(wr=>{var Br;if(Ot||Ue.current)return;if(!((wr==null?void 0:wr.success)!==!1)){const bs=wr!=null&&wr.error?`Workspace metadata warning: ${wr.error}`:"Workspace metadata preparation failed.";ae==null||ae.writeln(`\r
[orchestrator] ${bs}`)}const ss=typeof(wr==null?void 0:wr.launchScriptPath)=="string"?wr.launchScriptPath.trim().replace(/\\/g,"/"):"",Ns=ss.startsWith(".agent_cache/")?`./${ss}`:_r.command;yr("launching_agent"),Ds(Ns),vt(!0),A.current=Date.now(),(Br=ur.current)==null||Br.call(ur,p)}).catch(wr=>{var Ws;Ot||Ue.current||(console.error("Failed to prepare workspace metadata:",wr),ae==null||ae.writeln(`\r
[orchestrator] Workspace metadata setup failed. Continuing.`),yr("launching_agent","workspace metadata setup failed; launching with fallback"),Ds(_r.command),vt(!0),A.current=Date.now(),(Ws=ur.current)==null||Ws.call(ur,p))})},200)}),Me=window.electronAPI.onPtyMode(p,Oe=>{Ot||Ue.current||ue({mode:Oe.mode||"booting",modeSeq:Number.isFinite(Oe.modeSeq)?Oe.modeSeq:0,isBlocked:!!Oe.isBlocked,blockedReason:Oe.blockedReason})}),Je=window.electronAPI.onPtyExit(p,({exitCode:Oe,signal:tt})=>{bt(),Er(),zt(),Ht(null),W.current=null,me.current=!1,ve.current=!1,It=!1,pe(),j.current+=1,he.current={mode:"exited",modeSeq:j.current,isBlocked:!1},Jt(!0),Hr({isBlocked:!1,blockedReason:void 0}),Z.current="exited",Xe("exited"),vt(!1),ae==null||ae.writeln(`\r
[orchestrator] PTY exited (code=${Oe??"null"} signal=${tt??"none"}).`)}),Promise.all([window.electronAPI.getControlBaseUrl().catch(()=>""),window.electronAPI.getControlAuthToken().catch(()=>"")]).then(([Oe,tt])=>{if(Ot||Ue.current)return;const Ft=(typeof Oe=="string"?Oe.trim().replace(/\/+$/,""):"")||"http://127.0.0.1:34567",Wt=typeof tt=="string"?tt.trim():"";_e.current=Wt;const Kt=`${Ft}/api/task/${p}`;fe.current=Kt,$e=de(Kt,Wt),Y.current=$e}).catch(()=>{Ot||Ue.current||($e=de(O,""),Y.current=$e)}).finally(()=>{Ot||Ue.current||(Y.current=$e,ve.current=!0,bt(),W.current=null,Ht(null),j.current=-1,Z.current="booting",he.current={mode:"booting",modeSeq:0,isBlocked:!1},Jt(!1),Hr({isBlocked:!1,blockedReason:void 0}),Xe("booting"),window.electronAPI.createPty(p,b,$e))}),window.addEventListener("resize",jr),He=new ResizeObserver(()=>{jr()}),He.observe(F.current),setTimeout(jr,0),Zt=requestAnimationFrame(()=>{ae==null||ae.focus()}),!0}catch(Ar){return console.error("Failed to initialize xterm:",Ar),!1}},jr=()=>{te()};return mr()||(ke=new ResizeObserver(()=>{mr()&&ke&&F.current&&(ke.unobserve(F.current),ke.disconnect())}),ke.observe(F.current)),()=>{Ot=!0,Ue.current=!0,window.removeEventListener("resize",jr),J.current!==null&&(cancelAnimationFrame(J.current),J.current=null),ie.current={cols:0,rows:0},Zt!==null&&cancelAnimationFrame(Zt),ke&&ke.disconnect(),He&&He.disconnect(),ot?ot():window.electronAPI.removePtyDataListener(p),Je&&Je(),Me&&Me(),lt&&lt(),ut.current.splice(0).forEach(({timeoutId:Ar})=>window.clearTimeout(Ar)),pe(),bt(),me.current=!1,ve.current=!1,W.current=null,Ht(null),nt.current="",Qt.current=!1,j.current=-1,Z.current="booting",he.current={mode:"booting",modeSeq:0,isBlocked:!1},Jt(!1),Hr({isBlocked:!1,blockedReason:void 0}),Xe("booting"),De(null),Er(),vt(!1),zt(),window.electronAPI.detachPty(p),ae&&ae.dispose(),Mr.current=!1}},[p,b,vt,ue,pe,bt,zt,yr,te,Ur,Er,Ds,lr]);const ge=()=>{requestAnimationFrame(()=>{var be;(be=U.current)==null||be.focus();const ae=Z.current;(ae==="shell"||ae==="exited")&&X()})},Q=N.useCallback(ae=>{ae&&(window.electronAPI.writePty(p,ae),ge())},[p]),Ie=N.useCallback((ae,be=!1)=>{const ke=be&&ae?"":"";window.electronAPI.writePty(p,`${ke}${ae}\r`),ge()},[p]),Ge=N.useCallback((ae,be=4200)=>{const ke=String(ae||"").trim();ke&&(gt(ke),Re.current!==null&&(window.clearTimeout(Re.current),Re.current=null),!(be<=0)&&(Re.current=window.setTimeout(()=>{gt(He=>He===ke?null:He),Re.current=null},be)))},[]),Te=N.useCallback(ae=>{var He;Ge(ae);const be=Z.current;an(be)&&((He=U.current)==null||He.writeln(`\r
[orchestrator] ${ae}`))},[Ge]),Ne=N.useCallback(async ae=>{const be=String(ae||"").replace(/[\r\n]+/g," ").trim();if(!be)return!1;const ke=Y.current||de(fe.current||O);Y.current=ke;const He=8;for(let ot=0;ot<=He;ot+=1)try{const lt=await window.electronAPI.launchPty(p,be,{suppressEcho:!0});if(lt!=null&&lt.success)return ge(),!0;const Je=String((lt==null?void 0:lt.error)||"PTY command dispatch failed.");if(ot<He&&/not running|session not found/i.test(Je)){window.electronAPI.createPty(p,b,ke),await new Promise(Me=>window.setTimeout(Me,Math.min(900,120*(ot+1))));continue}return Te(`Quick action failed: ${Je}`),!1}catch(lt){const Je=String((lt==null?void 0:lt.message)||"PTY command dispatch failed.");if(ot<He&&/not running|session not found/i.test(Je)){window.electronAPI.createPty(p,b,ke),await new Promise(Me=>window.setTimeout(Me,Math.min(900,120*(ot+1))));continue}return Te(`Quick action failed: ${Je}`),!1}return Te("Quick action failed: PTY command dispatch timed out."),!1},[p,b,de,O,Te]),Fe=(ae,be={})=>{window.electronAPI.fleetRecordEvent(p,"quick_action",{action:ae,...be})},qe=ae=>{ae.preventDefault(),ae.stopPropagation(),ae.currentTarget.blur(),ge()},Ye=N.useCallback(ae=>{if(Ue.current)return;if(W.current){Te("PTY startup failed. Fix environment/worktree and retry.");return}if(me.current){ae();return}ut.current.length===0&&Te("Restoring terminal process for this task.");const be=window.setTimeout(()=>{const He=ut.current.findIndex(lt=>lt.timeoutId===be);if(He===-1||Ue.current)return;const[ot]=ut.current.splice(He,1);if(!me.current&&ut.current.length===0&&(ve.current=!1),!me.current){if(W.current){Te("PTY startup failed. Fix environment/worktree and retry.");return}Te("PTY startup is still in progress. Retry the action in a moment.");const lt=Y.current||de(fe.current||O);Y.current=lt,ve.current||(ve.current=!0,window.electronAPI.createPty(p,b,lt));return}ot.continuation()},4500);ut.current.push({continuation:ae,timeoutId:be});const ke=Y.current||de(fe.current||O);Y.current=ke,ve.current||(ve.current=!0,window.electronAPI.createPty(p,b,ke))},[b,p,de,O]),it=N.useCallback(async ae=>{var be;for(const ke of ae){if(ke.kind==="hint"){Te(ke.message);continue}if(ke.kind==="send"){Q(ke.data);continue}if(ke.kind==="send_line"){const He=ke.line.replace(/\$MULTI_AGENT_IDE_URL/g,fe.current).trim();if(!He)continue;if(ke.clearLine&&Q(""),!await Ne(He))break;continue}if(ke.kind==="launch_agent"){if(Q(""),!await Ne(Fr))break;A.current=Date.now(),(be=ke.postInstruction)!=null&&be.trim()&&(await new Promise(ot=>window.setTimeout(ot,800)),await Ne(ke.postInstruction.trim()))}}},[Fr,Q,Ne,Te]),et=N.useCallback(ae=>{if(Ue.current)return;if(an(Z.current)){it(ae);return}pe();const be=window.setTimeout(()=>{var ke;((ke=Ce.current)==null?void 0:ke.timeoutId)===be&&(Ce.current=null,Te("Could not reach a shell prompt yet. Retry once the terminal settles."))},3200);Ce.current={steps:ae,timeoutId:be},Te("Interrupting active session and waiting for shell prompt."),Q("")},[pe,it,Q,Te]);N.useEffect(()=>{if(!an(Ke))return;const ae=pe();ae&&it(ae.steps)},[Ke,pe,it]);const _t=N.useCallback(ae=>{const be=Date.now();if(be-R.current<180)return;R.current=be;const ke=Z.current,He=Et?pt.isBlocked:!!C||!!he.current.isBlocked;if(ae==="pause"){if(an(ke)&&!He){vt(!1),Te("Terminal is already at a shell prompt. Use resume to relaunch the agent.");return}if(be-M.current<900){Te("Pause already sent. Use resume if you want to relaunch the agent.");return}M.current=be,Fe(ae,{target:"shell",profile:Yt.profile}),Ye(()=>{pe(),Q(""),vt(!1)});return}if(ae==="resume"){if(He){Te("Agent is waiting on a confirmation prompt. Use approve/reject first.");return}if(!qu(ke)){Te("Agent already appears active."),vt(!0);return}Fe(ae,{target:"shell",profile:Yt.profile}),Ye(()=>{const Je=Wu(T,void 0,{permissionMode:lr});Q(""),Ne(Je.command).then(Me=>{if(!Me){vt(!1);return}A.current=Date.now(),vt(!0)})});return}if(ae==="create_pr"){if(He){Te("Agent is waiting on a confirmation prompt. Use approve/reject first.");return}const Je=String(g||"").trim(),Me=ap.test(Je)&&!Je.includes("..")?Je:"main";if(an(ke)&&vt(!1),Yt.profile!=="shell"&&Ku(ke)){const Ot=`Create a pull request from the current branch into ${Me}. Use this repository's configured provider tooling, open the PR in browser, and then paste the PR link.`,Zt=Yt.profile==="aider"?`/ask ${Ot}`:Ot;Fe(ae,{target:"agent",profile:Yt.profile,prTarget:Me}),Ye(()=>{Ne(Zt)});return}}const ot=Qf({action:ae,agentCommand:T,isBlocked:He,parentBranch:g});if(Fe(ae,{target:ot.target,profile:ot.capabilities.profile,prTarget:ae==="create_pr"?g||"main":void 0}),!ot.steps.some(Je=>Je.kind!=="hint")){it(ot.steps);return}Ye(()=>{if(ot.target==="shell"){et(ot.steps);return}it(ot.steps)})},[T,lr,Yt.profile,Ye,Et,C,pt.isBlocked,g,it,Ne,vt,pe,et]),wt=()=>{_t("create_pr")},Ve=ae=>{if(Yt.profile==="aider"){Ie(`/add ${ae}`);return}Ie(`Please analyze this image and use it as task context: ${ae}`)},Rt=async ae=>{const be=ae.clipboardData.items;let ke=!1;for(let ot=0;ot<be.length;ot+=1){if(!be[ot].type.includes("image"))continue;const lt=be[ot].getAsFile();if(!lt)continue;ke=!0,ae.preventDefault();const Je=new FileReader;Je.onload=async Me=>{var Zt;const It=(Zt=Me.target)==null?void 0:Zt.result,Ot=`img_${Date.now()}.png`;try{const mr=await window.electronAPI.saveImage(b,It,Ot);mr.success&&mr.path?Ve(mr.path):Te(mr.error||"Image paste failed: unable to save image to workspace cache.")}catch(mr){Te(`Image paste failed: ${(mr==null?void 0:mr.message)||"unknown error"}`)}},Je.onerror=()=>{Te("Image paste failed: could not read clipboard image data.")},Je.readAsDataURL(lt)}if(ke)return;const He=ae.clipboardData.getData("text");He&&U.current&&(ae.preventDefault(),U.current.paste(He))};return d.jsxs("div",{className:"w-full h-full flex flex-col relative bg-[var(--xterm-bg)] rounded-xl overflow-hidden",onPaste:Rt,children:[d.jsxs("div",{className:"flex-1 relative overflow-hidden bg-[var(--xterm-bg)] p-2",onMouseDown:()=>{var ae;(ae=U.current)==null||ae.focus()},children:[zr&&Ut&&d.jsx("div",{className:"terminal-startup-overlay",role:"status","aria-live":"polite",children:d.jsxs("div",{className:`terminal-startup-overlay-card ${hr?"terminal-startup-overlay-card--attention":""}`,children:[d.jsxs("div",{className:"terminal-startup-progress-head",children:[d.jsx("span",{children:Ut.label}),d.jsxs("span",{children:[Ut.percent,"%"]})]}),d.jsx("div",{className:"terminal-startup-progress-track",children:d.jsx("div",{className:`terminal-startup-progress-fill ${Ut.label==="Loading session"?"animate-pulse":""}`,style:{width:`${Ut.percent}%`}})}),Ut.detail&&d.jsx("div",{className:"terminal-startup-progress-detail",children:Ut.detail})]})}),d.jsx("div",{className:"w-full h-full rounded-lg overflow-hidden border border-[var(--panel-border)] bg-[var(--xterm-bg)] p-2",children:d.jsx("div",{ref:F,className:"w-full h-full rounded-md overflow-hidden"})})]}),d.jsxs("div",{className:"terminal-action-bar flex flex-col shrink-0 relative z-30",children:[ds&&d.jsxs("div",{className:"terminal-guardrail-banner terminal-guardrail-banner--warning",role:"status","aria-live":"polite",children:[d.jsx(Us,{size:12,className:"flex-shrink-0"}),d.jsx("span",{children:ds})]}),pr&&d.jsxs("div",{className:`terminal-guardrail-banner ${pr.tone==="warning"?"terminal-guardrail-banner--warning":"terminal-guardrail-banner--info"}`,role:"status","aria-live":"polite",children:[d.jsx(Us,{size:12,className:"flex-shrink-0"}),d.jsx("span",{children:pr.message})]}),$r&&Ut&&d.jsxs("div",{className:`terminal-startup-progress ${hr?"terminal-startup-progress--attention":""}`,role:"status","aria-live":"polite",children:[d.jsxs("div",{className:"terminal-startup-progress-head",children:[d.jsx("span",{children:Ut.label}),d.jsxs("span",{children:[Ut.percent,"%"]})]}),d.jsx("div",{className:"terminal-startup-progress-track",children:d.jsx("div",{className:`terminal-startup-progress-fill ${Ut.label==="Loading session"?"animate-pulse":""}`,style:{width:`${Ut.percent}%`}})}),Ut.detail&&d.jsx("div",{className:"terminal-startup-progress-detail",children:Ut.detail})]}),ft&&d.jsx("div",{className:"terminal-action-notice",children:ft}),jt&&d.jsxs("div",{className:"terminal-blocked-banner mb-2",children:[d.jsxs("div",{className:"min-w-0 flex items-center",children:[d.jsx(Us,{size:13,className:"text-red-500 mr-2 flex-shrink-0"}),d.jsxs("span",{className:"text-[11px] text-red-300 font-mono truncate",children:["Action Required: ",Ls||"agent is waiting for confirmation."]})]}),d.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[d.jsx("button",{type:"button",onMouseDown:qe,onClick:()=>Ie("y",!1),className:"btn-primary px-3 py-1.5 rounded text-[11px] font-mono",children:"approve (y)"}),d.jsx("button",{type:"button",onMouseDown:qe,onClick:()=>Ie("n",!1),className:"btn-ghost px-3 py-1.5 rounded text-[11px] font-mono",children:"reject (n)"})]})]}),d.jsxs("div",{className:"terminal-action-meta",children:[d.jsxs("div",{className:"terminal-action-chips",children:[hs&&d.jsx("span",{className:"terminal-action-chip",children:hs}),es&&d.jsx("span",{className:"terminal-action-chip",children:es})]}),d.jsx("div",{className:"terminal-action-updated",children:Xr&&br?`updated ${br}`:""})]}),d.jsxs("div",{className:"terminal-quick-toolbar",children:[d.jsx("div",{className:"terminal-quick-group",children:d.jsxs("button",{type:"button",onMouseDown:qe,onClick:wt,title:`Create PR/MR into ${g||"main"} and open it in browser`,className:"terminal-quick-btn terminal-quick-btn--primary",children:[d.jsx(Ef,{size:12,className:"mr-2 shrink-0"})," create PR"]})}),d.jsxs("div",{className:"terminal-quick-group terminal-quick-group--right",children:[d.jsxs("button",{type:"button",onMouseDown:qe,onClick:()=>y==null?void 0:y(p),title:"Review and merge this worktree",className:"terminal-quick-btn terminal-quick-btn--merge",children:[d.jsx(dh,{size:12,className:"mr-2 shrink-0"})," merge"]}),d.jsxs("button",{type:"button",onMouseDown:qe,onClick:()=>P==null?void 0:P(p),title:"Delete this branch and worktree",className:"terminal-quick-btn terminal-quick-btn--delete",children:[d.jsx(Ti,{size:12,className:"mr-2 shrink-0"})," delete"]})]})]})]})]})},dp=lf.memo(hp,up),bn=[{id:"docs-circuit",name:"Docs Circuit",description:"Matches the documentation default dark palette",preview:{bg:"#090d14",panel:"#0f1723",border:"#283548",text:"#e2e8f0",accent:"#2dd4bf"}},{id:"stealth",name:"Stealth Mono",description:"High-contrast dark operator theme",preview:{bg:"#000000",panel:"#050505",border:"#1a1a1a",text:"#e5e5e5",accent:"#ffffff"}},{id:"graphite",name:"Graphite",description:"Neutral gray studio look",preview:{bg:"#0b0d10",panel:"#101419",border:"#2a3038",text:"#dde1e7",accent:"#dbe3f0"}},{id:"midnight-teal",name:"Midnight Teal",description:"Cool dark cyan accents",preview:{bg:"#041217",panel:"#092027",border:"#1f4a52",text:"#d9f3f0",accent:"#4bd3cf"}},{id:"amber-night",name:"Amber Night",description:"Warm amber focus palette",preview:{bg:"#140d05",panel:"#1b1208",border:"#4b3116",text:"#f8e8c8",accent:"#f0b34a"}},{id:"forest-terminal",name:"Forest Terminal",description:"Deep green command center",preview:{bg:"#071107",panel:"#0b1a0c",border:"#24512a",text:"#d8f3dc",accent:"#65d46e"}},{id:"ocean-deep",name:"Ocean Deep",description:"Blue-forward contrast theme",preview:{bg:"#06111f",panel:"#0a1a33",border:"#244779",text:"#d6e7ff",accent:"#74aaff"}},{id:"sunset-dark",name:"Sunset Dark",description:"Dark shell with warm highlights",preview:{bg:"#1a0e14",panel:"#23111a",border:"#5b2e3b",text:"#f8dce3",accent:"#ff9a76"}},{id:"paper-light",name:"Paper Light",description:"Light reading-focused workspace",preview:{bg:"#f6f7f9",panel:"#ffffff",border:"#d5dbe4",text:"#111827",accent:"#111827"}},{id:"sandstorm-light",name:"Sandstorm Light",description:"Warm light with muted contrast",preview:{bg:"#f7f3ea",panel:"#fffaf0",border:"#d9c9ae",text:"#2b2217",accent:"#7f4f24"}},{id:"ice-light",name:"Ice Light",description:"Cool light technical theme",preview:{bg:"#eef4f9",panel:"#f9fcff",border:"#bfd2e6",text:"#10263d",accent:"#1f5f8b"}}],fl="docs-circuit",on=p=>p.replace(/\r\n/g,`
`).trimEnd(),fp=p=>{const b=p.split(`
`),T=[];return b.forEach((I,$)=>{const G=I.trim();!G||G.startsWith("#")||/^[A-Za-z_][A-Za-z0-9_]*=.*/.test(G)||T.push($+1)}),T},pp=({isOpen:p,onClose:b,context:T,setContext:I,envVars:$,setEnvVars:G,defaultCommand:q,setDefaultCommand:c,packageStoreStrategy:u,setPackageStoreStrategy:g,dependencyCloneMode:x,setDependencyCloneMode:h,pnpmStorePath:v,setPnpmStorePath:w,sharedCacheRoot:k,setSharedCacheRoot:_,pnpmAutoInstall:o,setPnpmAutoInstall:a,sandboxMode:n,setSandboxMode:i,networkGuard:f,setNetworkGuard:S,availableAgents:C,theme:E,setTheme:y})=>{const[P,O]=N.useState(T),[F,U]=N.useState($),[B,J]=N.useState(q),[ie,fe]=N.useState(u),[_e,Y]=N.useState(x),[R,M]=N.useState(v),[A,j]=N.useState(k),[Z,he]=N.useState(o),[me,ve]=N.useState(n),[W,D]=N.useState(f),[oe,ee]=N.useState(E),[xe,Ce]=N.useState(!1),Ke=N.useMemo(()=>[...C].sort((De,Qe)=>De.name.localeCompare(Qe.name)),[C]),Xe=bn.find(De=>De.id===oe)||bn[0],ft=Ke.find(De=>De.command===B)||Ke[0],gt=N.useMemo(()=>fp(F),[F]),Ae=gt.length>0?`Invalid ENV format on line${gt.length>1?"s":""}: ${gt.join(", ")}`:"",Ht=N.useMemo(()=>on(P)!==on(T)||on(F)!==on($)||(B||"")!==(q||"")||ie!==u||_e!==x||on(R)!==on(v)||on(A)!==on(k)||Z!==o||me!==n||W!==f||oe!==E,[T,q,$,B,P,F,ie,_e,R,A,Z,me,W,oe,u,x,v,k,o,n,f,E]),Nt=Ht&&!Ae;if(N.useEffect(()=>{var Qe;if(!p)return;const De=C.some(ir=>ir.command===q)?q:((Qe=C[0])==null?void 0:Qe.command)||"claude";J(De),O(T),U($),fe(u),Y(x),M(v),j(k),he(o),ve(n),D(f),ee(E),Ce(!1)},[p,q,C,T,$,u,x,v,k,o,n,f,E]),N.useEffect(()=>{if(!p)return;const De=Qe=>{Qe.key==="Escape"&&b(),(Qe.metaKey||Qe.ctrlKey)&&Qe.key==="Enter"&&Nt&&(Qe.preventDefault(),I(P),G(F),c(B),g(ie),h(_e),w(R),_(A),a(Z),i(me),S(W),y(oe),b())};return window.addEventListener("keydown",De),()=>window.removeEventListener("keydown",De)},[Nt,p,B,P,F,ie,_e,R,A,Z,me,W,oe,b,I,c,G,g,h,w,_,a,i,S,y]),!p)return null;const sr=()=>{var Qe;const De=C.some(ir=>ir.command===q)?q:((Qe=C[0])==null?void 0:Qe.command)||"claude";J(De),O(T),U($),fe(u),Y(x),M(v),j(k),he(o),ve(n),D(f),ee(E)},kt=()=>{Nt&&(I(P),G(F),c(B),g(ie),h(_e),w(R),_(A),a(Z),i(me),S(W),y(oe),b())};return d.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[90] p-4",children:d.jsxs("div",{className:"app-panel border border-[#1a1a1a] rounded-xl shadow-2xl w-full max-w-3xl flex flex-col h-[85vh]",children:[d.jsxs("div",{className:"flex justify-between items-center p-5 border-b border-[#1a1a1a] bg-[#050505]",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("h2",{className:"text-sm font-bold text-[#e5e5e5] uppercase tracking-widest",children:"Workspace Settings"}),Ht?d.jsx("span",{className:"text-[10px] uppercase tracking-[0.18em] text-amber-300 font-mono",children:"Unsaved changes"}):d.jsx("span",{className:"text-[10px] uppercase tracking-[0.18em] text-emerald-300 font-mono",children:"Saved"})]}),d.jsx("button",{onClick:b,className:"btn-ghost btn-icon rounded-md",title:"Close settings",children:d.jsx(No,{size:18})})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6 bg-[#000000]",children:[d.jsxs("section",{className:"space-y-4",children:[d.jsx("h3",{className:"text-[10px] font-bold text-[#9ca3af] uppercase tracking-[0.2em]",children:"Essentials"}),d.jsxs("div",{className:"rounded-lg border border-[#1a1a1a] p-4 space-y-3",children:[d.jsx("label",{className:"block text-xs text-[#d4d4d8] font-semibold",children:"Default Agent"}),d.jsx("p",{className:"text-xs text-[#888888]",children:"Used automatically when spawning a new task."}),d.jsx("select",{value:B,onChange:De=>J(De.target.value),className:"w-full input-stealth rounded py-2 px-3 text-xs font-mono appearance-none",style:{backgroundImage:'url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23525252%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E")',backgroundRepeat:"no-repeat",backgroundPosition:"right .7em top 50%",backgroundSize:".65em auto"},children:Ke.map(De=>d.jsxs("option",{value:De.command,children:[De.name," ",De.version!=="unknown"?`(${De.version})`:""]},De.command))}),d.jsxs("div",{className:"text-[11px] font-mono text-[#9ca3af] break-all",children:["command: ",d.jsx("span",{className:"text-[#d4d4d8]",children:(ft==null?void 0:ft.command)||B})]})]}),d.jsxs("div",{className:"rounded-lg border border-[#1a1a1a] p-4 space-y-3",children:[d.jsx("label",{className:"block text-xs text-[#d4d4d8] font-semibold",children:"Theme"}),d.jsx("p",{className:"text-xs text-[#888888]",children:"Pick a visual theme for long sessions."}),d.jsx("select",{value:oe,onChange:De=>ee(De.target.value),className:"w-full input-stealth rounded py-2 px-3 text-xs font-mono appearance-none",style:{backgroundImage:'url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23525252%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E")',backgroundRepeat:"no-repeat",backgroundPosition:"right .7em top 50%",backgroundSize:".65em auto"},children:bn.map(De=>d.jsx("option",{value:De.id,children:De.name},De.id))}),d.jsxs("div",{className:"rounded border p-3",style:{backgroundColor:Xe.preview.panel,borderColor:Xe.preview.border},children:[d.jsx("div",{className:"text-xs font-semibold",style:{color:Xe.preview.text},children:Xe.name}),d.jsx("div",{className:"text-[10px] mt-1",style:{color:Xe.preview.text,opacity:.8},children:Xe.description}),d.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[d.jsx("div",{className:"h-2.5 w-10 rounded",style:{backgroundColor:Xe.preview.accent}}),d.jsx("div",{className:"h-2.5 w-10 rounded",style:{backgroundColor:Xe.preview.border}}),d.jsx("div",{className:"h-2.5 w-10 rounded",style:{backgroundColor:Xe.preview.text,opacity:.25}})]})]})]})]}),d.jsxs("section",{className:"space-y-3",children:[d.jsx("h3",{className:"text-[10px] font-bold text-[#9ca3af] uppercase tracking-[0.2em]",children:"Shared Instructions"}),d.jsxs("div",{className:"rounded-lg border border-[#1a1a1a] p-4 space-y-3",children:[d.jsx("label",{className:"block text-xs text-[#d4d4d8] font-semibold",children:"Project Memory"}),d.jsx("p",{className:"text-xs text-[#888888]",children:"Added to every new task in this workspace."}),d.jsx("textarea",{value:P,onChange:De=>O(De.target.value),placeholder:"Example: We use React + Tailwind. Keep changes small and include tests for risky logic.",className:"w-full h-32 input-stealth rounded p-3 text-xs"})]})]}),d.jsxs("section",{className:"rounded-lg border border-[#1a1a1a] overflow-hidden",children:[d.jsxs("button",{type:"button",onClick:()=>Ce(De=>!De),className:"btn-ghost w-full px-4 py-3 text-left flex items-center justify-between rounded-none border-0 border-b border-[var(--panel-border)] bg-[#050505] hover:bg-[#0b0b0b]",children:[d.jsx("span",{className:"text-[11px] uppercase tracking-[0.18em] text-[#9ca3af] font-mono",children:"Advanced"}),d.jsx("span",{className:"text-[11px] text-[#71717a] font-mono",children:xe?"hide":"show"})]}),xe&&d.jsxs("div",{className:"p-4 space-y-6",children:[d.jsxs("div",{className:"space-y-3",children:[d.jsx("label",{className:"block text-xs text-[#d4d4d8] font-semibold",children:"Environment Variables"}),d.jsxs("p",{className:"text-xs text-[#888888]",children:["Format: ",d.jsx("span",{className:"font-mono",children:"KEY=VALUE"})," per line. Not written to disk."]}),d.jsx("textarea",{value:F,onChange:De=>U(De.target.value),placeholder:"ANTHROPIC_API_KEY=...\\nOPENAI_API_KEY=...",className:"w-full h-24 input-stealth rounded p-3 text-xs font-mono"}),Ae?d.jsxs("div",{className:"flex items-center gap-2 text-xs text-rose-300",children:[d.jsx(_f,{size:14}),Ae]}):d.jsxs("div",{className:"flex items-center gap-2 text-xs text-emerald-300",children:[d.jsx(Sl,{size:14}),"Environment format looks valid."]})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsx("label",{className:"block text-xs text-[#d4d4d8] font-semibold",children:"Dependencies For New Tasks"}),d.jsx("p",{className:"text-xs text-[#888888]",children:"Choose between saving disk space or full isolated copies."}),d.jsxs("select",{value:_e,onChange:De=>Y(De.target.value==="full_copy"?"full_copy":"copy_on_write"),className:"w-full input-stealth rounded py-2 px-3 text-xs font-mono",children:[d.jsx("option",{value:"copy_on_write",children:"Save disk space (recommended)"}),d.jsx("option",{value:"full_copy",children:"Use full copies (more disk usage)"})]}),d.jsx("p",{className:"text-[11px] text-[#9ca3af]",children:_e==="copy_on_write"?"Reuses dependency files when possible to keep worktrees lightweight.":"Copies dependencies into each worktree for maximum isolation."}),d.jsxs("label",{className:"flex items-center gap-2 text-xs text-[#a3a3a3]",children:[d.jsx("input",{type:"checkbox",checked:ie!=="off",onChange:De=>fe(De.target.checked?"polyglot_global":"off"),className:"appearance-none w-4 h-4 rounded-sm border border-[#262626] bg-[#0a0a0a] checked:bg-white checked:border-white transition-colors"}),"Use shared dependency cache for faster installs"]}),ie!=="off"&&d.jsxs("details",{className:"rounded border border-[#1f1f1f] p-3 space-y-3",children:[d.jsx("summary",{className:"text-[11px] text-[#9ca3af] font-mono cursor-pointer",children:"Optional cache paths"}),d.jsxs("div",{className:"mt-3 space-y-3",children:[d.jsx("input",{value:A,onChange:De=>j(De.target.value),placeholder:"/Users/you/.forkline-cache",className:"w-full input-stealth rounded p-3 text-xs font-mono"}),d.jsx("input",{value:R,onChange:De=>M(De.target.value),placeholder:"/Users/you/.forkline-cache/pnpm-store",className:"w-full input-stealth rounded p-3 text-xs font-mono"})]})]}),ie!=="off"&&d.jsxs("label",{className:"flex items-center gap-2 text-xs text-[#a3a3a3]",children:[d.jsx("input",{type:"checkbox",checked:Z,onChange:De=>he(De.target.checked),className:"appearance-none w-4 h-4 rounded-sm border border-[#262626] bg-[#0a0a0a] checked:bg-white checked:border-white transition-colors"}),"Auto-run dependency hydration when creating a worktree"]})]}),d.jsxs("div",{className:"space-y-3",children:[d.jsx("label",{className:"block text-xs text-[#d4d4d8] font-semibold",children:"Sandbox & Network Guardrails"}),d.jsx("p",{className:"text-xs text-[#888888]",children:"Best-effort PTY wrapper. Uses seatbelt on macOS or firejail on Linux when available."}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[d.jsxs("select",{value:me,onChange:De=>{const Qe=De.target.value;if(Qe==="auto"||Qe==="seatbelt"||Qe==="firejail"){ve(Qe);return}ve("off")},className:"w-full input-stealth rounded py-2 px-3 text-xs font-mono",children:[d.jsx("option",{value:"off",children:"sandbox off"}),d.jsx("option",{value:"auto",children:"auto"}),d.jsx("option",{value:"seatbelt",children:"seatbelt (macOS)"}),d.jsx("option",{value:"firejail",children:"firejail (Linux)"})]}),d.jsxs("select",{value:W,onChange:De=>D(De.target.value==="none"?"none":"off"),className:"w-full input-stealth rounded py-2 px-3 text-xs font-mono",children:[d.jsx("option",{value:"off",children:"network guard off"}),d.jsx("option",{value:"none",children:"block network egress"})]})]})]})]})]})]}),d.jsxs("div",{className:"p-5 border-t border-[#1a1a1a] flex items-center justify-between bg-[#050505]",children:[d.jsx("button",{onClick:sr,className:"btn-ghost px-4 py-2 text-xs font-semibold rounded",disabled:!Ht,children:"Discard Changes"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:b,className:"btn-ghost px-5 py-2 text-xs font-bold rounded",children:"Cancel"}),d.jsxs("button",{onClick:kt,disabled:!Nt,className:"btn-primary px-5 py-2 text-xs uppercase tracking-wider font-bold rounded shadow-[0_0_15px_rgba(255,255,255,0.1)]",children:[d.jsx(Nf,{size:14,className:"mr-2"})," Save"]})]})]})]})})},mp=({isOpen:p,onClose:b,onConfirm:T,worktreePath:I,branchName:$,targetBranch:G})=>{const[q,c]=N.useState(""),[u,g]=N.useState(!0),[x,h]=N.useState(!0),[v,w]=N.useState("text");return N.useEffect(()=>{p&&(g(!0),window.electronAPI.getDiff(I,{syntaxAware:x}).then(k=>{k.success&&k.diff?(c(k.diff),w(k.diffMode==="syntax"?"syntax":"text")):(c("No changes detected, or an error occurred."),w("text")),g(!1)}))},[p,I,x]),p?d.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-8",children:d.jsxs("div",{className:"app-panel border border-[var(--panel-border)] rounded-lg shadow-2xl w-full max-w-5xl flex flex-col h-full",children:[d.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-[var(--panel-border)]",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-lg font-bold text-[var(--text-primary)]",children:"Review Before Merge"}),d.jsxs("div",{className:"text-[11px] text-[var(--text-secondary)] font-mono mt-1",children:[$||"task-branch"," ","->"," ",G||"base-branch","  session closes after merge"]}),d.jsxs("div",{className:"text-[10px] text-[var(--text-tertiary)] font-mono mt-1",children:["Diff mode: ",v==="syntax"?"syntax-aware (difftastic)":"plain git diff"]})]}),d.jsx("button",{onClick:b,className:"btn-ghost btn-icon rounded-md",children:d.jsx(No,{size:20})})]}),d.jsxs("div",{className:"px-4 py-2 border-b border-[var(--panel-border)] flex items-center gap-3 text-[11px] text-[var(--text-secondary)] font-mono",children:[d.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[d.jsx("input",{type:"checkbox",checked:x,onChange:k=>h(k.target.checked)}),"syntax-aware diff"]}),d.jsx("span",{className:"text-[var(--text-tertiary)]",children:"falls back to plain diff if difftastic is unavailable"})]}),d.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-[var(--panel-subtle)]",children:u?d.jsx("div",{className:"text-[var(--text-tertiary)] text-center mt-10 animate-pulse",children:"Generating Diff..."}):d.jsx("pre",{className:"text-xs font-mono text-[var(--text-primary)] whitespace-pre-wrap",children:q||"No changes to merge."})}),d.jsxs("div",{className:"p-4 border-t border-[var(--panel-border)] flex justify-end space-x-3 bg-[var(--panel)]",children:[d.jsx("button",{onClick:b,className:"btn-ghost px-4 py-2 text-sm",children:"Cancel"}),d.jsxs("button",{onClick:T,className:"btn-success px-4 py-2 text-sm rounded",children:[d.jsx(dh,{size:16,className:"mr-2"})," Merge & Close Session"]})]})]})}):null},_p=/^[a-zA-Z0-9._/-]{1,120}$/,Ro=p=>`'${String(p||"").replace(/'/g,`'"'"'`)}'`,pl=p=>{const b=String(p||"").trim().toLowerCase();return b.includes("claude")?"claude":b.includes("gemini")?"gemini":b.includes("amp")?"amp":b.includes("codex")?"codex":"other"},gp=(p,b,T,I)=>p==="gemini"?b==="latest"?"gemini --resume latest":b==="session"&&(T!=null&&T.resumeArg)?`gemini --resume ${Ro(T.resumeArg)}`:null:p==="amp"?b==="latest"?"amp threads continue --last":b==="session"&&(T!=null&&T.id)?`amp threads continue ${Ro(T.id)}`:null:p==="claude"?b==="latest"?"claude --continue":b==="picker"?"claude --resume":b==="manual"&&I.trim()?`claude --resume ${Ro(I.trim())}`:null:p==="codex"?b==="latest"?"codex resume --last":b==="picker"?"codex resume":b==="manual"&&I.trim()?`codex resume ${Ro(I.trim())}`:null:null,vp=({isOpen:p,onClose:b,onSubmit:T,projectName:I,basePath:$,parentBranch:G,availableBranches:q,dependencyCloneMode:c,defaultCommand:u,availableAgents:g})=>{const x=N.useRef(!1),[h,v]=N.useState(`${I}-task-${Date.now().toString().slice(-4)}`),[w,k]=N.useState(u),[_,o]=N.useState(G||"main"),[a,n]=N.useState("existing"),[i,f]=N.useState(""),[S,C]=N.useState(""),[E,y]=N.useState(c),[P,O]=N.useState("new"),[F,U]=N.useState("default"),[B,J]=N.useState(pl(u)),[ie,fe]=N.useState("latest"),[_e,Y]=N.useState([]),[R,M]=N.useState(""),[A,j]=N.useState(""),[Z,he]=N.useState(!1),[me,ve]=N.useState(!1),[W,D]=N.useState(""),[oe,ee]=N.useState(""),[xe,Ce]=N.useState(!1),[Ke,Xe]=N.useState(!1),[ft,gt]=N.useState("");N.useEffect(()=>{var Re;if(p&&!x.current){v(`${I}-task-${Date.now().toString().slice(-4)}`);const ct=g.some(mt=>mt.command===u)?u:((Re=g[0])==null?void 0:Re.command)||"claude";k(ct),o(G||q[0]||"main"),n("existing"),f(""),C(""),y(c),O("new"),U("default"),J(pl(ct)),fe("latest"),Y([]),M(""),j(""),he(!1),ve(!1),D(""),Xe(!1),gt("")}x.current=p},[p,I,u,g,G,q,c]),N.useEffect(()=>{if(!p||P!=="resume")return;const Re=pl(w);if(J(Re),Re==="other"){he(!1),Y([]),M(""),D("Resume is available for Claude, Gemini, Amp, and Codex.");return}let ct=!1;return(async()=>{ve(!0),D("");const Ue=await window.electronAPI.listAgentSessions(w,$);if(ct)return;if(he(!!Ue.supportsInAppList),Ue.provider&&J(Ue.provider),!Ue.success){Y([]),M(""),D(Ue.error||"Unable to load provider sessions."),ve(!1);return}const ut=Array.isArray(Ue.sessions)?Ue.sessions:[];Y(ut),Ue.supportsInAppList?fe(ut.length>0?"session":"latest"):(Re==="claude"||Re==="codex")&&fe("latest"),M(nt=>{var Qt;return nt&&ut.some(ar=>ar.id===nt)?nt:((Qt=ut[0])==null?void 0:Qt.id)||""}),ve(!1)})(),()=>{ct=!0}},[p,P,w,$]);const Ae=N.useMemo(()=>rp(w),[w]),Ht=N.useMemo(()=>_e.find(Re=>Re.id===R)||null,[_e,R]),Nt=N.useMemo(()=>P!=="resume"?!0:B==="other"?!1:Z?ie==="session"?!!Ht:!0:ie==="manual"?!!A.trim():!0,[P,B,Z,ie,Ht,A]),sr=!!h.trim()&&!Ke&&!me&&!S&&Nt,kt=F==="bypass"&&Ae;if(N.useEffect(()=>{Ae||U("default")},[Ae]),!p)return null;const De=Re=>{if(!h.trim()||Ke)return;const ct=a==="new"?i.trim():_;if(!ct){C("Parent branch is required.");return}if(a==="new"&&!(_p.test(ct)&&!ct.includes(".."))){C('Invalid branch name. Use letters, numbers, ".", "_", "-", or "/" only.');return}C("");const mt=F==="bypass"&&Ae?"bypass":"default";gt("");let Ue;if(P==="resume"){const ut=gp(B,ie,Ht,A);if(!ut){gt("Select a valid resume target for this provider.");return}Ue=Lo(ut,mt)}Xe(!0),T(h,Re,P==="resume"?"":oe,ct,{autoMerge:xe},{createBaseBranchIfMissing:a==="new",dependencyCloneMode:E,launchCommandOverride:Ue,permissionMode:mt}).then(ut=>{if(!ut.success){Xe(!1),gt(ut.error||"Unable to spawn session.");return}ee(""),b()}).catch(ut=>{Xe(!1),gt(ut instanceof Error?ut.message:"Unable to spawn session.")})},Qe=Re=>{Re.preventDefault(),De(w)},Mt=`${`${$?`${$.split("/").slice(0,-1).join("/")}/${I}-worktrees`:"(workspace)-worktrees"}`}/${h||"<branch-name>"}`,or=a==="new"?i.trim():_;return d.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"app-panel rounded-xl shadow-2xl w-full max-w-2xl overflow-hidden border border-[#1a1a1a] max-h-[90vh] flex flex-col",children:[d.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-[#1a1a1a] bg-[#050505]",children:[d.jsx("h2",{className:"text-sm font-bold text-[#e5e5e5] uppercase tracking-widest",children:"Spawn Agent"}),d.jsx("button",{onClick:b,className:"btn-ghost btn-icon rounded-md",children:d.jsx(No,{size:18})})]}),d.jsxs("form",{onSubmit:Qe,className:"p-5 space-y-4 bg-[#000000] overflow-y-auto",children:[d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[d.jsxs("div",{className:"sm:col-span-2",children:[d.jsx("label",{className:"block text-[10px] font-bold text-[#525252] uppercase tracking-[0.2em] mb-2",children:"Branch"}),d.jsx("input",{type:"text",value:h,onChange:Re=>v(Re.target.value),className:"w-full input-stealth rounded py-2 px-3 text-xs font-mono",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-[10px] font-bold text-[#525252] uppercase tracking-[0.2em] mb-2",children:"Agent"}),d.jsx("select",{value:w,onChange:Re=>k(Re.target.value),className:"w-full input-stealth rounded py-2 px-3 text-xs font-mono appearance-none",style:{backgroundImage:'url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23525252%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E")',backgroundRepeat:"no-repeat",backgroundPosition:"right .7em top 50%",backgroundSize:".65em auto"},children:g.map(Re=>d.jsxs("option",{value:Re.command,children:[Re.name," ",Re.version!=="unknown"?`(${Re.version})`:""]},Re.command))})]})]}),d.jsxs("div",{className:"rounded-lg border border-[#1f1f1f] bg-[#070707] p-3 space-y-3",children:[d.jsx("div",{className:"text-[10px] uppercase tracking-[0.2em] text-[#737373] font-mono",children:"Launch Mode"}),d.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[d.jsx("button",{type:"button",onClick:()=>O("new"),className:`btn-ghost px-3 py-1 rounded text-[10px] font-mono ${P==="new"?"border-[var(--input-border-focus)] text-[var(--text-primary)] bg-[var(--panel-strong)]":""}`,children:"Start New Session"}),d.jsx("button",{type:"button",onClick:()=>O("resume"),className:`btn-ghost px-3 py-1 rounded text-[10px] font-mono ${P==="resume"?"border-[var(--input-border-focus)] text-[var(--text-primary)] bg-[var(--panel-strong)]":""}`,children:"Resume Existing"})]}),P==="resume"&&d.jsxs("div",{className:"space-y-2",children:[d.jsxs("div",{className:"text-[11px] text-[#d4d4d8] font-mono",children:["Provider: ",d.jsx("span",{className:"text-white",children:B})]}),me&&d.jsx("div",{className:"text-[10px] text-[#9ca3af] font-mono",children:"Loading available sessions..."}),W&&d.jsx("div",{className:"text-[10px] text-rose-300 font-mono",children:W}),!me&&Z&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[d.jsx("button",{type:"button",onClick:()=>fe("session"),className:`btn-ghost px-2 py-1 rounded text-[10px] font-mono ${ie==="session"?"border-[var(--input-border-focus)] text-[var(--text-primary)] bg-[var(--panel-strong)]":""}`,children:"Pick Session"}),d.jsx("button",{type:"button",onClick:()=>fe("latest"),className:`btn-ghost px-2 py-1 rounded text-[10px] font-mono ${ie==="latest"?"border-[var(--input-border-focus)] text-[var(--text-primary)] bg-[var(--panel-strong)]":""}`,children:"Use Latest"})]}),ie==="session"&&d.jsxs("select",{value:R,onChange:Re=>M(Re.target.value),className:"w-full input-stealth rounded py-1.5 px-2 text-[11px] font-mono appearance-none",style:{backgroundImage:'url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org/2000/svg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23525252%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E")',backgroundRepeat:"no-repeat",backgroundPosition:"right .7em top 50%",backgroundSize:".65em auto"},children:[_e.length===0&&d.jsx("option",{value:"",children:"No sessions found for this project"}),_e.map(Re=>d.jsx("option",{value:Re.id,children:Re.label},Re.id))]})]}),!me&&!Z&&(B==="claude"||B==="codex")&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[d.jsx("button",{type:"button",onClick:()=>fe("latest"),className:`btn-ghost px-2 py-1 rounded text-[10px] font-mono ${ie==="latest"?"border-[var(--input-border-focus)] text-[var(--text-primary)] bg-[var(--panel-strong)]":""}`,children:"Use Latest"}),d.jsx("button",{type:"button",onClick:()=>fe("picker"),className:`btn-ghost px-2 py-1 rounded text-[10px] font-mono ${ie==="picker"?"border-[var(--input-border-focus)] text-[var(--text-primary)] bg-[var(--panel-strong)]":""}`,children:"Open Picker In Terminal"}),d.jsx("button",{type:"button",onClick:()=>fe("manual"),className:`btn-ghost px-2 py-1 rounded text-[10px] font-mono ${ie==="manual"?"border-[var(--input-border-focus)] text-[var(--text-primary)] bg-[var(--panel-strong)]":""}`,children:"Manual Session ID"})]}),ie==="manual"&&d.jsx("input",{type:"text",value:A,onChange:Re=>j(Re.target.value),className:"w-full input-stealth rounded py-1.5 px-2 text-[11px] font-mono",placeholder:"Paste provider session id/name"})]})]}),d.jsxs("div",{className:`rounded border px-3 py-2.5 space-y-2 ${kt?"border-[#60a5fa] bg-[#0a1730]":"border-[#334155] bg-[#06101f]"}`,children:[d.jsx("div",{className:"text-[10px] uppercase tracking-[0.14em] text-[#93c5fd] font-mono",children:"Permissions"}),d.jsxs("label",{className:`flex items-center space-x-3 ${Ae?"cursor-pointer group":"opacity-60 cursor-not-allowed"}`,children:[d.jsx("input",{id:"spawn-bypass-approvals",type:"checkbox",checked:F==="bypass",disabled:!Ae,onChange:Re=>U(Re.target.checked?"bypass":"default"),className:"h-4 w-4 accent-[#60a5fa] border border-[#1d4ed8] bg-[#0a0f1a] rounded-sm disabled:opacity-40"}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-xs font-medium text-[#bfdbfe] group-hover:text-white transition-colors",children:"Bypass approval prompts"}),d.jsx("span",{className:`text-[10px] font-mono px-1.5 py-0.5 rounded border ${kt?"text-[#bfdbfe] border-[#60a5fa] bg-[#10213f]":"text-[#93c5fd] border-[#334155] bg-[#09172d]"}`,children:kt?"ON":"OFF"})]})]}),d.jsx("div",{className:"text-[10px] text-[#93c5fd] font-mono",children:Ae?"Supported by this agent.":"Not supported by this agent."})]})]}),d.jsxs("div",{className:"rounded-lg border border-[#1f1f1f] bg-[#070707] p-3 space-y-3",children:[d.jsx("div",{className:"text-[10px] uppercase tracking-[0.2em] text-[#737373] font-mono",children:"Workspace Setup"}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-[10px] font-bold text-[#737373] uppercase tracking-[0.2em] mb-1",children:"Parent Branch"}),d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx("button",{type:"button",onClick:()=>{n("existing"),C("")},className:`btn-ghost px-2 py-1 rounded text-[10px] font-mono ${a==="existing"?"border-[var(--input-border-focus)] text-[var(--text-primary)] bg-[var(--panel-strong)]":""}`,children:"Use Existing"}),d.jsx("button",{type:"button",onClick:()=>{n("new"),C(""),f(Re=>Re||_||G||"main")},className:`btn-ghost px-2 py-1 rounded text-[10px] font-mono ${a==="new"?"border-[var(--input-border-focus)] text-[var(--text-primary)] bg-[var(--panel-strong)]":""}`,children:"Create New"})]}),a==="existing"?d.jsxs("select",{value:_,onChange:Re=>o(Re.target.value),className:"w-full input-stealth rounded py-1.5 px-2 text-[11px] font-mono appearance-none",style:{backgroundImage:'url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23525252%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E")',backgroundRepeat:"no-repeat",backgroundPosition:"right .7em top 50%",backgroundSize:".65em auto"},children:[q.length===0&&d.jsx("option",{value:G||"main",children:G||"main"}),q.map(Re=>d.jsx("option",{value:Re,children:Re},Re))]}):d.jsx("input",{type:"text",value:i,onChange:Re=>f(Re.target.value),className:"w-full input-stealth rounded py-1.5 px-2 text-[11px] font-mono",placeholder:"feature/new-base-branch"}),a==="new"&&d.jsxs("div",{className:"text-[10px] text-[#9ca3af] font-mono mt-1",children:["Creates ",d.jsx("span",{className:"text-white",children:or||"<new-parent-branch>"})," in base repo before spawn."]}),S&&d.jsx("div",{className:"text-[10px] text-rose-300 font-mono mt-1",children:S})]}),d.jsxs("div",{className:"text-[11px] text-[#a3a3a3] font-mono truncate",title:Mt,children:["Worktree: ",d.jsx("span",{className:"text-white",children:Mt})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-[10px] font-bold text-[#737373] uppercase tracking-[0.2em] mb-1",children:"Dependencies"}),d.jsxs("select",{value:E,onChange:Re=>y(Re.target.value==="full_copy"?"full_copy":"copy_on_write"),className:"w-full input-stealth rounded py-1.5 px-2 text-[11px] font-mono appearance-none",style:{backgroundImage:'url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org/2000/svg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23525252%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E")',backgroundRepeat:"no-repeat",backgroundPosition:"right .7em top 50%",backgroundSize:".65em auto"},children:[d.jsx("option",{value:"copy_on_write",children:"Save disk space (recommended)"}),d.jsx("option",{value:"full_copy",children:"Use full copies (more disk usage)"})]})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-[10px] font-bold text-[#525252] uppercase tracking-[0.2em] mb-2",children:"Initial Instruction"}),d.jsx("textarea",{value:oe,onChange:Re=>ee(Re.target.value),placeholder:P==="resume"?"Resume mode: add instructions in terminal after attach.":"e.g. Refactor auth component",className:"w-full h-24 input-stealth rounded p-3 text-xs",disabled:P==="resume"})]}),d.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer group border-t border-[#1a1a1a] pt-3",children:[d.jsx("input",{type:"checkbox",checked:xe,onChange:Re=>Ce(Re.target.checked),className:"appearance-none w-4 h-4 rounded-sm border border-[#262626] bg-[#0a0a0a] checked:bg-white checked:border-white transition-colors"}),d.jsx("span",{className:"text-xs font-medium text-[#a3a3a3] group-hover:text-white transition-colors",children:"Allow auto-merge for this task"})]}),ft&&d.jsx("div",{className:"text-[11px] text-rose-300 font-mono",children:ft}),d.jsxs("div",{className:"pt-2 flex justify-end space-x-3",children:[d.jsx("button",{type:"button",onClick:b,className:"btn-ghost px-4 py-2 text-xs font-bold rounded",children:"Cancel"}),d.jsxs("button",{type:"submit",disabled:!sr,className:"btn-primary px-5 py-2 rounded text-xs uppercase tracking-wider disabled:opacity-60",children:[d.jsx(Df,{size:14,className:"mr-2"})," ",Ke?"Spawning...":"Spawn"]})]})]})]})})},yp=p=>{try{return JSON.stringify(p??{},null,2)}catch{return"{}"}},wp=({isOpen:p,onClose:b,pendingApprovals:T,blockedTasks:I,taskMetaById:$,onSelectTask:G,onApproveOne:q,onRejectOne:c,onApproveAll:u,onRejectAll:g,onRespondBlocked:x,onRespondAllBlocked:h})=>{const[v,w]=N.useState(null),[k,_]=N.useState(null),[o,a]=N.useState({}),[n,i]=N.useState({}),f=T.length+I.length,S=T.length>0,C=I.length>0,E=N.useMemo(()=>[...T].sort((P,O)=>P.taskId.localeCompare(O.taskId)),[T]);if(!p)return null;const y=async(P,O)=>{var B;if(o[P]||k===P)return;const F=(B=$[O])==null?void 0:B.worktreePath;if(!F){i(J=>({...J,[P]:"No worktree available for diff preview."}));return}_(P);const U=await window.electronAPI.getDiff(F,{syntaxAware:!0});if(!U.success){i(J=>({...J,[P]:U.error||"Failed to load diff."})),_(null);return}a(J=>({...J,[P]:U.diff||""})),_(null)};return d.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[96] flex items-center justify-center p-4",children:d.jsxs("div",{className:"app-panel rounded-xl border border-[#1a1a1a] shadow-2xl w-full max-w-5xl h-[84vh] flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"px-5 py-4 border-b border-[#1a1a1a] flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("div",{className:"text-[11px] uppercase tracking-[0.2em] text-[#6b7280] font-mono",children:"Human Gatekeeper"}),d.jsx("h2",{className:"text-lg text-white font-semibold mt-1",children:"Approval Inbox"})]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("span",{className:"text-[11px] font-mono text-[#a1a1aa]",children:["items ",f]}),d.jsx("button",{onClick:b,className:"btn-ghost px-3 py-1.5 rounded text-[11px] uppercase tracking-wider",children:"close"})]})]}),d.jsxs("div",{className:"px-5 py-3 border-b border-[#1a1a1a] flex items-center gap-2 flex-wrap",children:[d.jsxs("button",{onClick:u,disabled:!S,className:"btn-primary px-3 py-1 rounded text-[11px] uppercase tracking-wider disabled:opacity-40",children:[d.jsx(ff,{size:12,className:"inline mr-1"})," approve all requests"]}),d.jsxs("button",{onClick:g,disabled:!S,className:"btn-danger px-3 py-1 rounded text-[11px] uppercase tracking-wider disabled:opacity-40",children:[d.jsx(No,{size:12,className:"inline mr-1"})," reject all requests"]}),d.jsx("button",{onClick:()=>h("y"),disabled:!C,className:"btn-warning px-3 py-1 rounded text-[11px] uppercase tracking-wider disabled:opacity-40",children:"respond y to blocked"}),d.jsx("button",{onClick:()=>h("n"),disabled:!C,className:"btn-danger px-3 py-1 rounded text-[11px] uppercase tracking-wider disabled:opacity-40",children:"respond n to blocked"})]}),d.jsxs("div",{className:"flex-1 min-h-0 grid grid-cols-1 lg:grid-cols-2",children:[d.jsxs("section",{className:"border-r border-[#1a1a1a] overflow-y-auto p-3 space-y-2",children:[d.jsx("div",{className:"text-[10px] uppercase tracking-[0.2em] text-[#6b7280] font-mono px-1",children:"Approval Requests"}),E.length===0&&d.jsx("div",{className:"text-xs text-[#71717a] font-mono p-2",children:"No pending approval requests."}),E.map(P=>{const O=$[P.taskId]||{taskName:P.taskId,projectPath:P.projectPath},F=v===P.requestId,U=o[P.requestId],B=n[P.requestId];return d.jsxs("div",{className:"rounded-lg border border-[#1f1f1f] bg-[#090909] p-3",children:[d.jsxs("div",{className:"flex items-start justify-between gap-3",children:[d.jsxs("div",{className:"min-w-0",children:[d.jsx("button",{type:"button",onClick:()=>{G(P.taskId)},className:"btn-link text-left text-sm truncate",children:O.taskName}),d.jsx("div",{className:"text-[10px] text-[#71717a] font-mono mt-0.5 truncate",children:O.projectPath}),d.jsx("div",{className:"text-[11px] text-amber-300 uppercase tracking-wider font-mono mt-2",children:P.action})]}),d.jsxs("div",{className:"shrink-0 flex items-center gap-2",children:[d.jsx("button",{onClick:()=>c(P.requestId),className:"btn-danger px-2 py-1 rounded text-[10px] font-mono",children:"reject"}),d.jsx("button",{onClick:()=>void q(P.requestId),className:"btn-primary px-2 py-1 rounded text-[10px] font-mono",children:"approve"})]})]}),d.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[d.jsxs("button",{type:"button",onClick:()=>{w(J=>J===P.requestId?null:P.requestId)},className:"btn-ghost px-2 py-1 rounded text-[10px] uppercase tracking-wider",children:[d.jsx(Pf,{size:11,className:"inline mr-1"})," payload"]}),d.jsxs("button",{type:"button",onClick:()=>{y(P.requestId,P.taskId),w(P.requestId)},className:"btn-ghost px-2 py-1 rounded text-[10px] uppercase tracking-wider",children:[d.jsx(xf,{size:11,className:"inline mr-1"})," diff"]})]}),F&&d.jsxs("div",{className:"mt-2 rounded border border-[#1f1f1f] bg-[#050505] p-2 text-[11px] font-mono overflow-auto max-h-56",children:[d.jsx("div",{className:"text-[#9ca3af] uppercase tracking-wider mb-1",children:"payload"}),d.jsx("pre",{className:"whitespace-pre-wrap text-[#d4d4d8]",children:yp(P.payload)}),d.jsx("div",{className:"text-[#9ca3af] uppercase tracking-wider mt-3 mb-1",children:"diff preview"}),k===P.requestId&&d.jsx("div",{className:"text-[#6b7280]",children:"loading diff..."}),B&&d.jsx("div",{className:"text-rose-300",children:B}),!k&&!B&&d.jsx("pre",{className:"whitespace-pre-wrap text-[#d4d4d8]",children:U||"No diff loaded yet."})]})]},P.requestId)})]}),d.jsxs("section",{className:"overflow-y-auto p-3 space-y-2",children:[d.jsx("div",{className:"text-[10px] uppercase tracking-[0.2em] text-[#6b7280] font-mono px-1",children:"Blocked Sessions"}),I.length===0&&d.jsx("div",{className:"text-xs text-[#71717a] font-mono p-2",children:"No blocked terminal prompts."}),I.map(P=>d.jsxs("div",{className:"rounded-lg border border-[#1f1f1f] bg-[#090909] p-3",children:[d.jsx("button",{type:"button",onClick:()=>G(P.taskId),className:"btn-link text-left text-sm truncate",children:P.taskName}),d.jsx("div",{className:"text-[10px] text-[#71717a] font-mono mt-0.5 truncate",children:P.projectPath}),d.jsx("div",{className:"text-[11px] text-[#d4d4d8] mt-2",children:P.reason}),d.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[d.jsx("button",{onClick:()=>x(P.taskId,"y"),className:"btn-primary px-2 py-1 rounded text-[10px] font-mono",children:"send y"}),d.jsx("button",{onClick:()=>x(P.taskId,"n"),className:"btn-danger px-2 py-1 rounded text-[10px] font-mono",children:"send n"})]})]},P.taskId))]})]})]})})},Sp=({todos:p})=>{if(!p||p.length===0)return d.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center",children:[d.jsx(yf,{size:24,className:"text-[#333333] mb-3"}),d.jsx("h3",{className:"text-[11px] font-bold text-[#888888] mb-1 uppercase tracking-[0.15em]",children:"Execution Plan"}),d.jsx("p",{className:"text-[10px] text-[#525252]",children:"Awaiting agent payload."})]});const b=p.filter(I=>I.status==="done").length,T=Math.round(b/p.length*100);return d.jsxs("div",{className:"flex flex-col h-full bg-[#050505] overflow-hidden",children:[d.jsxs("div",{className:"p-4 border-b border-[#1a1a1a]",children:[d.jsx("h2",{className:"text-[11px] font-bold text-white mb-3 uppercase tracking-[0.15em] flex items-center",children:"Plan"}),d.jsx("div",{className:"w-full bg-[#1a1a1a] h-1 mb-2 rounded-full overflow-hidden",children:d.jsx("div",{className:"bg-white h-full transition-all duration-300",style:{width:`${T}%`}})}),d.jsxs("div",{className:"flex justify-between text-[9px] text-[#888888] font-mono",children:[d.jsxs("span",{children:[T,"%"]}),d.jsxs("span",{children:[b,"/",p.length]})]})]}),d.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2",children:p.map((I,$)=>d.jsxs("div",{className:`flex items-start p-2.5 rounded-lg border ${I.status==="done"?"bg-[#0a0a0a] border-transparent opacity-50":I.status==="in_progress"?"bg-[#121212] border-[#333333]":"bg-transparent border-[#1a1a1a]"}`,children:[d.jsx("div",{className:"mt-0.5 mr-3 flex-shrink-0",children:I.status==="done"?d.jsx(Sl,{size:14,className:"text-white"}):I.status==="in_progress"?d.jsx("div",{className:"w-3.5 h-3.5 rounded-full border-2 border-[#333333] border-t-white animate-spin"}):d.jsx(vf,{size:14,className:"text-[#333333]"})}),d.jsx("div",{className:`flex-1 text-[12px] leading-tight ${I.status==="done"?"text-[#525252] line-through":"text-[#e5e5e5]"}`,children:I.title})]},I.id||$))})]})},xp=({basePath:p,sourceStatus:b,onBrowseWorkspace:T,onSpawnAgent:I})=>{const $=!!p.trim()&&!!(b!=null&&b.valid);return d.jsx("div",{className:"h-full app-panel rounded-xl overflow-auto",children:d.jsx("div",{className:"h-full w-full p-8 flex flex-col",children:d.jsxs("div",{className:"max-w-2xl w-full mx-auto",children:[d.jsx("div",{className:"text-[11px] uppercase tracking-[0.2em] text-[#6b7280] font-mono",children:"Ready State"}),d.jsx("h2",{className:"text-2xl text-white font-semibold mt-2",children:"Start in two steps"}),d.jsx("p",{className:"text-sm text-[#a1a1aa] mt-2",children:"Pick a workspace, then spawn an agent. Everything else stays out of your way."}),d.jsxs("div",{className:"mt-6 app-panel rounded-lg p-5 border border-[#1f1f1f]",children:[d.jsx("div",{className:"text-[10px] uppercase tracking-wider text-[#6b7280] font-mono mb-2",children:"Current Workspace"}),d.jsx("div",{className:"text-xs text-[#d4d4d8] break-all",children:p||"No workspace selected yet."}),d.jsx("div",{className:`text-[11px] mt-2 ${$?"text-emerald-300":"text-amber-300"}`,children:$?"Workspace ready":(b==null?void 0:b.error)||"Select a valid directory"}),d.jsxs("div",{className:"mt-4 flex gap-2 flex-wrap",children:[d.jsxs("button",{onClick:T,className:"btn-primary px-3 py-1.5 rounded text-[11px] uppercase tracking-wider flex items-center",children:[d.jsx(kf,{size:12,className:"mr-1.5"}),"1) Choose Workspace"]}),d.jsxs("button",{onClick:I,disabled:!$,className:"btn-primary px-3 py-1.5 rounded text-[11px] uppercase tracking-wider flex items-center disabled:opacity-50",children:[d.jsx(gf,{size:12,className:"mr-1.5"}),"2) Spawn Agent"]})]})]}),!$&&d.jsxs("div",{className:"mt-5 rounded-lg border border-amber-900/70 bg-[#1d1607] px-4 py-3 text-amber-300 text-xs flex items-start",children:[d.jsx(Us,{size:13,className:"mr-2 mt-0.5 flex-shrink-0"}),d.jsx("span",{children:"Start by choosing a valid local project folder. Spawn and merge controls remain disabled until workspace validation passes."})]})]})})})},Cp="Forkline",kp="Run and control coding agents in isolated Git worktrees.",bp="logo.svg",Ep="logo.icns",Pp={name:Cp,tagline:kp,logoFile:bp,appIconFile:Ep},Ri=Pp||{},Rp=(p,b)=>(typeof p=="string"?p.trim():"")||b,Ap=(p,b)=>(typeof p=="string"?p.trim():"")||b,ml=(p,b)=>(typeof p=="string"?p.trim().replace(/\\/g,"/").replace(/^\/+/,""):"")||b,ln={name:Rp(Ri.name,"Forkline"),tagline:Ap(Ri.tagline,"Run and control coding agents in isolated Git worktrees."),logoFile:ml(Ri.logoFile,"logo.svg"),appIconFile:ml(Ri.appIconFile,"logo.icns"),logoSrc:`./${ml(Ri.logoFile,"logo.svg")}`},Tp=({isOpen:p,theme:b,setTheme:T,onContinue:I})=>{if(!p)return null;const $=bn.find(q=>q.id===b)||bn[0],G=ln.logoSrc;return d.jsx("div",{className:"fixed inset-0 z-[120] backdrop-blur-sm flex items-center justify-center p-4",style:{backgroundColor:"rgba(3, 7, 12, 0.88)"},children:d.jsxs("div",{className:"w-full max-w-2xl app-panel rounded-2xl border border-[var(--panel-border)] shadow-2xl overflow-hidden",children:[d.jsx("div",{className:"px-6 py-6 bg-[var(--panel-subtle)] border-b border-[var(--panel-border)]",children:d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("img",{src:G,alt:`${ln.name} logo`,className:"w-14 h-14 rounded-lg border border-[var(--panel-border)] p-2 bg-[var(--panel)]"}),d.jsxs("div",{className:"min-w-0",children:[d.jsx("div",{className:"text-[10px] uppercase tracking-[0.2em] text-[var(--text-tertiary)] font-mono",children:"Welcome"}),d.jsx("h2",{className:"text-xl font-semibold text-[var(--text-primary)] mt-1",children:ln.name}),d.jsx("p",{className:"text-sm text-[var(--text-secondary)] mt-1",children:ln.tagline})]})]})}),d.jsxs("div",{className:"px-6 py-6 space-y-5",children:[d.jsxs("div",{className:"rounded-xl border border-[var(--panel-border)] bg-[var(--panel-subtle)] p-4",children:[d.jsxs("div",{className:"flex items-center gap-2 text-[var(--text-primary)] text-xs font-semibold uppercase tracking-wider",children:[d.jsx(Tf,{size:14}),"Default Theme"]}),d.jsx("p",{className:"text-xs text-[var(--text-secondary)] mt-2",children:"App default matches the documentation theme. You can change it here or later in Settings."}),d.jsxs("div",{className:"mt-3 grid gap-3 sm:grid-cols-[minmax(0,1fr)_9rem] items-center",children:[d.jsx("select",{value:b,onChange:q=>T(q.target.value),className:"w-full input-stealth rounded px-3 py-2 text-sm",children:bn.map(q=>d.jsx("option",{value:q.id,children:q.name},q.id))}),d.jsxs("div",{className:"rounded-lg border px-3 py-2",style:{backgroundColor:$.preview.panel,borderColor:$.preview.border,color:$.preview.text},children:[d.jsx("div",{className:"text-[11px] font-semibold",children:$.name}),d.jsx("div",{className:"mt-1 h-1.5 rounded",style:{backgroundColor:$.preview.accent}})]})]})]}),d.jsxs("div",{className:"rounded-xl border border-[var(--panel-border)] bg-[var(--panel)] p-4",children:[d.jsxs("div",{className:"flex items-center gap-2 text-xs text-[var(--text-primary)] font-semibold uppercase tracking-wider",children:[d.jsx(jf,{size:14}),"Start Flow"]}),d.jsx("p",{className:"text-xs text-[var(--text-secondary)] mt-2",children:"1) Choose workspace, 2) spawn first task, 3) iterate and merge."})]})]}),d.jsx("div",{className:"px-6 py-4 border-t border-[var(--panel-border)] bg-[var(--panel-subtle)] flex items-center justify-end",children:d.jsxs("button",{onClick:I,className:"btn-primary px-4 py-2 rounded text-xs uppercase tracking-wider",children:["Enter ",ln.name]})})]})})},Gu=(p,b=4)=>{const T=String(p||"").trim().replace(/\\/g,"/").replace(/\/+$/,"");if(!T)return"-";const I=T.split("/").filter(Boolean);return I.length<=b?T:`.../${I.slice(-b).join("/")}`},Lp=({isOpen:p,kind:b,sessionName:T,branchName:I,projectPath:$,worktreePath:G,onClose:q,onConfirm:c})=>{const[u,g]=N.useState(""),[x,h]=N.useState(!1),[v,w]=N.useState(!1),[k,_]=N.useState("");N.useEffect(()=>{p&&(g(""),h(!1),w(!1),_(""))},[p,I,T,$,G]);const o=N.useMemo(()=>String(I||"").trim(),[I]),a=u.trim()===o,n=!!o&&a&&x&&!v;if(!p)return null;const i=b==="session"?"Delete Session, Branch, and Worktree":"Delete Branch and Worktree",f=async()=>{if(!n)return;w(!0),_("");const S=await c().catch(C=>({success:!1,error:(C==null?void 0:C.message)||"Delete failed."}));if(!S.success){_(S.error||"Delete failed."),w(!1);return}w(!1),q()};return d.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[95] flex items-center justify-center p-4",onClick:q,children:d.jsxs("div",{className:"app-panel rounded-xl shadow-2xl w-full max-w-xl border border-[#1a1a1a] overflow-hidden",onClick:S=>S.stopPropagation(),children:[d.jsx("div",{className:"px-5 py-4 border-b border-[#1a1a1a] bg-[#090909]",children:d.jsxs("div",{className:"flex items-center gap-2 text-red-300",children:[d.jsx(Us,{size:16,className:"shrink-0"}),d.jsx("h2",{className:"text-sm font-semibold uppercase tracking-[0.12em]",children:i})]})}),d.jsxs("div",{className:"p-5 space-y-4",children:[b==="session"&&T&&d.jsxs("div",{className:"text-[12px] text-[var(--text-primary)] font-mono",children:["Session: ",d.jsx("span",{className:"text-white",children:T})]}),d.jsxs("div",{className:"rounded-lg border border-red-900/70 bg-[#1a0707] p-3 space-y-1",children:[d.jsx("div",{className:"text-[11px] font-mono text-red-200",children:"This action permanently removes:"}),b==="session"&&d.jsx("div",{className:"text-[11px] font-mono text-red-100",children:"- The running session tab"}),d.jsxs("div",{className:"text-[11px] font-mono text-red-100",children:["- Branch: ",o||"-"]}),d.jsxs("div",{className:"text-[11px] font-mono text-red-100",children:["- Worktree: ",Gu(G,5)]})]}),d.jsx("div",{className:"rounded-lg border border-amber-900/70 bg-[#1d1408] p-3",children:d.jsx("div",{className:"text-[11px] font-mono text-amber-200",children:"Merge and verify your changes before deleting this branch/worktree."})}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("div",{className:"text-[10px] uppercase tracking-[0.14em] text-[var(--text-tertiary)] font-mono",children:"Project"}),d.jsx("div",{className:"text-[11px] text-[var(--text-secondary)] font-mono truncate",title:$,children:Gu($,5)})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-[10px] uppercase tracking-[0.14em] text-[var(--text-tertiary)] font-mono",children:"Type branch name to confirm"}),d.jsx("input",{type:"text",value:u,onChange:S=>g(S.target.value),placeholder:o||"branch-name",className:"w-full input-stealth rounded py-2 px-3 text-xs font-mono",autoFocus:!0})]}),d.jsxs("label",{className:"flex items-start gap-2 cursor-pointer select-none",children:[d.jsx("input",{type:"checkbox",checked:x,onChange:S=>h(S.target.checked),className:"mt-0.5"}),d.jsx("span",{className:"text-[11px] text-[var(--text-secondary)] font-mono",children:"I understand this permanently deletes local branch/worktree data and cannot be undone. I have merged or intentionally discarded my changes."})]}),k&&d.jsx("div",{className:"text-[11px] text-red-300 font-mono",children:k}),d.jsxs("div",{className:"pt-1 flex items-center justify-end gap-2",children:[d.jsx("button",{type:"button",onClick:q,disabled:v,className:"btn-ghost px-3 py-1.5 rounded text-[11px] uppercase tracking-wider",children:"cancel"}),d.jsx("button",{type:"button",onClick:()=>{f()},disabled:!n,className:"btn-danger px-3 py-1.5 rounded text-[11px] uppercase tracking-wider disabled:opacity-60",children:v?"deleting...":"delete permanently"})]})]})]})})},vh=p=>String(p||"").trim().replace(/\\/g,"/").replace(/\/+$/,""),Dp=(p,b=4)=>{const T=vh(p);if(!T)return"-";const I=T.split("/").filter(Boolean);return I.length<=b?T:`.../${I.slice(-b).join("/")}`},Np=p=>{const b=vh(p);if(!b)return"";const T=b.split("/").filter(Boolean);return T[T.length-1]||b},Mp=({isOpen:p,projectPath:b,sessionNames:T,onClose:I,onConfirm:$})=>{const[G,q]=N.useState(""),[c,u]=N.useState(!1),[g,x]=N.useState(!1),[h,v]=N.useState("");N.useEffect(()=>{p&&(q(""),u(!1),x(!1),v(""))},[p,b]);const w=N.useMemo(()=>Np(b),[b]),k=G.trim()===w,_=!!w&&k&&c&&!g,o=T.slice(0,5);if(!p)return null;const a=async()=>{if(!_)return;x(!0),v("");const n=await $().catch(i=>({success:!1,error:(i==null?void 0:i.message)||"Project removal failed."}));if(!n.success){v(n.error||"Project removal failed."),x(!1);return}x(!1),I()};return d.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[96] flex items-center justify-center p-4",onClick:I,children:d.jsxs("div",{className:"app-panel rounded-xl shadow-2xl w-full max-w-xl border border-[#1a1a1a] overflow-hidden",onClick:n=>n.stopPropagation(),children:[d.jsx("div",{className:"px-5 py-4 border-b border-[#1a1a1a] bg-[#090909]",children:d.jsxs("div",{className:"flex items-center gap-2 text-red-300",children:[d.jsx(Us,{size:16,className:"shrink-0"}),d.jsx("h2",{className:"text-sm font-semibold uppercase tracking-[0.12em]",children:"Remove Project and Sessions"})]})}),d.jsxs("div",{className:"p-5 space-y-4",children:[d.jsxs("div",{className:"rounded-lg border border-red-900/70 bg-[#1a0707] p-3 space-y-1",children:[d.jsx("div",{className:"text-[11px] font-mono text-red-200",children:"This action permanently removes:"}),d.jsx("div",{className:"text-[11px] font-mono text-red-100",children:"- Project entry from side rail and local history"}),d.jsxs("div",{className:"text-[11px] font-mono text-red-100",children:["- All sessions for this project (",T.length,")"]}),d.jsx("div",{className:"text-[11px] font-mono text-red-100",children:"- Branch/worktree for each active project session"}),d.jsx("div",{className:"text-[11px] font-mono text-red-100",children:"- Fleet timeline/transcript metadata for this project"})]}),d.jsx("div",{className:"rounded-lg border border-amber-900/70 bg-[#1d1408] p-3",children:d.jsx("div",{className:"text-[11px] font-mono text-amber-200",children:"Merge and verify your session changes before deleting this project and its worktrees."})}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("div",{className:"text-[10px] uppercase tracking-[0.14em] text-[var(--text-tertiary)] font-mono",children:"Project Path"}),d.jsx("div",{className:"text-[11px] text-[var(--text-secondary)] font-mono truncate",title:b,children:Dp(b,5)})]}),o.length>0&&d.jsxs("div",{className:"space-y-1",children:[d.jsx("div",{className:"text-[10px] uppercase tracking-[0.14em] text-[var(--text-tertiary)] font-mono",children:"Sessions"}),d.jsxs("div",{className:"rounded-lg border border-[var(--panel-border)] bg-[var(--panel-subtle)] p-2.5 space-y-1",children:[o.map((n,i)=>d.jsx("div",{className:"text-[11px] font-mono text-[var(--text-secondary)] truncate",children:n},`${n}-${i}`)),T.length>o.length&&d.jsxs("div",{className:"text-[10px] font-mono text-[var(--text-muted)]",children:["+",T.length-o.length," more"]})]})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx("label",{className:"block text-[10px] uppercase tracking-[0.14em] text-[var(--text-tertiary)] font-mono",children:"Type project name to confirm"}),d.jsx("input",{type:"text",value:G,onChange:n=>q(n.target.value),placeholder:w||"project-name",className:"w-full input-stealth rounded py-2 px-3 text-xs font-mono",autoFocus:!0})]}),d.jsxs("label",{className:"flex items-start gap-2 cursor-pointer select-none",children:[d.jsx("input",{type:"checkbox",checked:c,onChange:n=>u(n.target.checked),className:"mt-0.5"}),d.jsx("span",{className:"text-[11px] text-[var(--text-secondary)] font-mono",children:"I understand this removes project sessions and related local metadata. I have merged or intentionally discarded pending changes."})]}),d.jsx("div",{className:"text-[10px] text-[var(--text-muted)] font-mono",children:"The source project directory itself is not deleted."}),h&&d.jsx("div",{className:"text-[11px] text-red-300 font-mono",children:h}),d.jsxs("div",{className:"pt-1 flex items-center justify-end gap-2",children:[d.jsx("button",{type:"button",onClick:I,disabled:g,className:"btn-ghost px-3 py-1.5 rounded text-[11px] uppercase tracking-wider",children:"cancel"}),d.jsx("button",{type:"button",onClick:()=>{a()},disabled:!_,className:"btn-danger px-3 py-1.5 rounded text-[11px] uppercase tracking-wider disabled:opacity-60",children:g?"removing...":"remove project"})]})]})]})})},Do=p=>p.replace(/\\/g,"/").replace(/\/+$/,""),Yu=p=>{const b=Do(p),T=b.split("/");return T[T.length-1]||b},Xu=(p,b=4)=>{const T=Do(p),I=T.split("/").filter(Boolean);return I.length<=b?T:`.../${I.slice(-b).join("/")}`},jp=p=>p?p.isReady?p.isBlocked?"blocked":p.hasCollision?"collision":p.isDirty?"dirty":"clean":"provisioning":"unknown",Bp=({isOpen:p,onClose:b,projectPaths:T,tabs:I,statuses:$,onOpenSession:G,onOpenWorktree:q,onDeleteWorktree:c})=>{const[u,g]=N.useState({}),x=N.useMemo(()=>Array.from(new Set(T.map(w=>w.trim()).filter(Boolean))).sort((w,k)=>w.localeCompare(k)),[T]),h=N.useMemo(()=>x.join(`
`),[x]);if(N.useEffect(()=>{if(!p)return;let w=!1;const k=x;if(k.length===0){g({});return}return(async()=>{const o={};k.forEach(n=>{o[n]={loading:!0,worktrees:[]}}),g(o);const a=await Promise.all(k.map(async n=>{const i=await window.electronAPI.listWorktrees(n);return i.success?{projectPath:n,data:{loading:!1,worktrees:i.worktrees||[]}}:{projectPath:n,data:{loading:!1,worktrees:[],error:i.error||"Failed to list worktrees"}}}));w||g(n=>{const i={...n};return a.forEach(({projectPath:f,data:S})=>{i[f]=S}),i})})(),()=>{w=!0}},[p,h]),!p)return null;const v=new Map;return I.forEach(w=>{w.worktreePath&&v.set(Do(w.worktreePath),w)}),d.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:d.jsxs("div",{className:"app-panel rounded-xl shadow-2xl w-full max-w-7xl border border-[#1a1a1a] h-[86vh] flex flex-col overflow-hidden",children:[d.jsxs("div",{className:"px-5 py-4 border-b border-[#1a1a1a] flex items-center justify-between",children:[d.jsxs("div",{className:"min-w-0",children:[d.jsx("div",{className:"text-[11px] uppercase tracking-[0.2em] text-[#6b7280] font-mono",children:"Workspace"}),d.jsxs("h2",{className:"text-lg text-white font-semibold mt-1 truncate flex items-center",children:[d.jsx(bf,{size:18,className:"mr-2 text-white"}),"Worktrees"]})]}),d.jsx("button",{onClick:b,className:"btn-ghost px-3 py-1.5 rounded text-[11px] uppercase tracking-wider",children:"close"})]}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[x.length===0&&d.jsx("div",{className:"h-full flex items-center justify-center text-[#737373] font-mono text-xs",children:"No projects discovered yet."}),x.map(w=>{const k=u[w],_=k==null?void 0:k.loading,o=(k==null?void 0:k.worktrees)||[],a=k==null?void 0:k.error;return d.jsxs("section",{className:"border border-[#1f1f1f] rounded-xl overflow-hidden",children:[d.jsxs("div",{className:"px-4 py-3 bg-[#090909] border-b border-[#1a1a1a] flex items-center justify-between gap-3",children:[d.jsxs("div",{className:"min-w-0",children:[d.jsx("div",{className:"text-white text-sm font-medium truncate",children:Yu(w)}),d.jsx("div",{className:"text-[10px] text-[#6b7280] font-mono truncate",title:w,children:Xu(w)})]}),d.jsx("div",{className:"text-[10px] text-[#9ca3af] font-mono uppercase tracking-wider",children:_?"loading...":`${o.length} worktrees`})]}),a&&d.jsx("div",{className:"px-4 py-3 text-[11px] text-red-300 bg-[#140808] border-b border-[#1a1a1a]",children:a}),!_&&o.length===0&&!a&&d.jsx("div",{className:"px-4 py-4 text-[11px] text-[#737373] font-mono",children:"No active worktrees for this project."}),!_&&o.length>0&&d.jsx("div",{className:"divide-y divide-[#141414]",children:o.map(n=>{const i=v.get(Do(n.path)),f=i?$[i.id]:void 0;return d.jsxs("div",{className:"px-4 py-3 flex items-center justify-between gap-4",children:[d.jsxs("div",{className:"min-w-0 flex-1",children:[d.jsxs("div",{className:"flex items-center min-w-0 gap-2",children:[d.jsx(hh,{size:12,className:"text-[#9ca3af] flex-shrink-0"}),d.jsx("span",{className:"text-[12px] text-white font-mono truncate",children:n.branchName||"(detached)"}),d.jsx("span",{className:"text-[10px] text-[#6b7280] font-mono truncate",children:Yu(n.path)})]}),d.jsx("div",{className:"text-[10px] text-[#6b7280] font-mono truncate mt-1",title:n.path,children:Xu(n.path,5)})]}),d.jsx("div",{className:"flex items-center gap-2",children:i?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"text-[10px] font-mono uppercase tracking-wider text-[#9ca3af] flex items-center",children:[d.jsx(df,{size:11,className:"mr-1 text-[#9ca3af]"}),jp(f)]}),d.jsx("button",{onClick:()=>{G(i.id),b()},className:"btn-primary px-3 py-1 rounded text-[10px] uppercase tracking-wider",children:"open session"}),d.jsxs("button",{onClick:()=>c(w,n.path,n.branchName),className:"btn-danger px-3 py-1 rounded text-[10px] uppercase tracking-wider flex items-center",title:"Delete this worktree and branch",children:[d.jsx(Ti,{size:10,className:"mr-1"}),"delete"]})]}):d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>{q(w,n.path,n.branchName),b()},className:"btn-ghost px-3 py-1 rounded text-[10px] uppercase tracking-wider",title:"Attach this existing worktree to a tab session",children:"open terminal"}),d.jsxs("button",{onClick:()=>c(w,n.path,n.branchName),className:"btn-danger px-3 py-1 rounded text-[10px] uppercase tracking-wider flex items-center",title:"Delete this worktree and branch",children:[d.jsx(Ti,{size:10,className:"mr-1"}),"delete"]})]})})]},n.path)})})]},w)})]})]})})},Ip=({isOpen:p,prompt:b,preference:T,onApply:I,onClose:$})=>{const[G,q]=N.useState("");if(N.useEffect(()=>{var g;if(!p||!b)return;const u=((g=b.candidates[0])==null?void 0:g.path)||"";if((T==null?void 0:T.mode)==="single"&&T.selectedPath){q(T.selectedPath);return}q(u)},[p,b,T]),!p||!b)return null;const c=!!G&&b.candidates.some(u=>u.path===G);return d.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[95] p-4",children:d.jsxs("div",{className:"app-panel border border-[#1a1a1a] rounded-xl shadow-2xl w-full max-w-2xl flex flex-col",children:[d.jsxs("div",{className:"p-5 border-b border-[#1a1a1a] bg-[#050505]",children:[d.jsx("h2",{className:"text-sm font-bold text-[#e5e5e5] uppercase tracking-widest",children:"Select Living Spec Source"}),d.jsxs("p",{className:"text-xs text-[#9ca3af] mt-2 leading-relaxed",children:["Multiple instruction files were found for this project. Choose the file Forkline should read directly (prefer",d.jsx("span",{className:"font-mono text-[#d4d4d8]",children:" AGENTS.md"})," when available)."]})]}),d.jsx("div",{className:"p-5 space-y-4 max-h-[60vh] overflow-y-auto",children:d.jsx("div",{className:"rounded border border-[#1a1a1a] bg-[#050505]",children:b.candidates.map(u=>d.jsxs("label",{className:"flex items-start gap-3 px-3 py-2 border-b border-[#111111] last:border-b-0 cursor-pointer",children:[d.jsx("input",{type:"radio",className:"mt-1",name:"living-spec-single",checked:G===u.path,onChange:()=>q(u.path)}),d.jsxs("div",{className:"min-w-0",children:[d.jsx("div",{className:"text-xs font-mono text-[#d4d4d8] break-all",children:u.path}),d.jsx("div",{className:"text-[11px] text-[#737373] uppercase tracking-wider mt-1",children:u.kind})]})]},u.path))})}),d.jsxs("div",{className:"p-4 border-t border-[#1a1a1a] flex items-center justify-end gap-2",children:[d.jsx("button",{type:"button",onClick:$,className:"btn-ghost px-3 py-1.5 rounded text-[11px] font-mono",children:"later"}),d.jsx("button",{type:"button",onClick:()=>{c&&I({mode:"single",selectedPath:G})},disabled:!c,className:"btn-primary px-3 py-1.5 rounded text-[11px] font-mono disabled:opacity-40 disabled:cursor-not-allowed",children:"apply"})]})]})})},Op=(p,b)=>p.replace(/[\\/]+/g,"-").replace(/\.\.+/g,"-").toLowerCase().trim().replace(/[^a-z0-9._-]+/g,"-").replace(/-+/g,"-").replace(/^[._-]+|[._-]+$/g,"").replace(/\.+$/,"")||`task-${b.slice(-4)}`,Fp=(p,b,T,I)=>[`You are subtask agent ${T} of ${I} for parent task "${p}".`,`Parent objective: ${b}`,"Focus on one clearly scoped implementation chunk and avoid unrelated edits.","Run relevant checks, then summarize exactly what changed and why."].join(`
`),Xn=(p,b=320)=>{const T=String(p||"").trim();return T?T.length<=b?T:`${T.slice(0,b-1)}`:""},Hp=p=>{const b=p.filter($=>$.status==="pending").length,T=p.filter($=>$.status==="in_progress").length,I=p.filter($=>$.status==="done").length;return`${b} pending, ${T} in progress, ${I} done`},zp=p=>{if(!p)return"n/a";const b=typeof p.totalTokens=="number"?p.totalTokens.toLocaleString():null,T=typeof p.percentUsed=="number"?`${p.percentUsed.toFixed(1)}%`:null,I=typeof p.costUsd=="number"?`$${p.costUsd.toFixed(4)}`:null;return[b&&`${b} tokens`,T&&`${T} context`,I&&I].filter(Boolean).join("  ")||"n/a"},$p=p=>{const b=p.git.modifiedFiles.length>0?p.git.modifiedFiles.map($=>Xn($,140)).join(", "):"none",T=p.task.todos.length>0?p.task.todos.slice(0,10).map($=>`[${$.status}] ${Xn($.title,100)}`).join(", "):"none";return["Handover context follows.",`Task=${p.taskName} (${p.taskId})`,`Source=${p.sourceAgent}`,`Target=${p.targetAgent}`,`Worktree=${p.worktreePath||"unknown"}`,`CurrentBranch=${p.currentBranch||p.taskName}`,`ParentBranch=${p.parentBranch||"main"}`,`Objective=${Xn(p.objective||p.taskName,240)}`,`OperatorInstruction=${Xn(p.operatorInstruction,360)}`,`ModifiedFiles=${p.git.modifiedCount}${p.git.truncated?" (truncated)":""}: ${b}`,`TodoSummary=${p.task.todoSummary}; Todos=${T}`,`Blocked=${p.task.isBlocked?`yes (${Xn(p.task.blockedReason||"unknown",140)})`:"no"}`,`Usage=${zp(p.usage)}`,"Reply with state confirmation + 3-step immediate plan + first concrete action."].join(" | ")},Up=p=>{var G,q,c;const b=Array.isArray(p.todos)?p.todos.slice(0,20):[],T=Array.isArray(p.modifiedFiles)?p.modifiedFiles.filter(u=>typeof u=="string"&&u.trim()):[],I=T.slice(0,20),$={generatedAt:Date.now(),taskId:p.taskId,taskName:p.taskName,worktreePath:p.worktreePath,sourceAgent:p.sourceAgent,targetAgent:p.targetAgent,parentBranch:p.parentBranch,currentBranch:p.currentBranch,objective:p.objective,operatorInstruction:Xn(p.operatorInstruction,1200),git:{modifiedCount:T.length,modifiedFiles:I,truncated:T.length>I.length},task:{isBlocked:!!((G=p.status)!=null&&G.isBlocked),blockedReason:(q=p.status)!=null&&q.isBlocked?(c=p.status)==null?void 0:c.blockedReason:void 0,todos:b,todoSummary:Hp(b)},usage:p.usage};return{...$,transferBrief:$p($)}},Wp=p=>p.trim().toLowerCase(),yh=p=>{const b=Wp(p);return b.includes("claude")?"claude":b.includes("gemini")?"gemini":b.includes("amp")?"amp":b.includes("aider")?"aider":b.includes("codex")?"codex":"shell"},Kp=p=>{const b=yh(p);return b==="aider"||b==="shell"?"in_place":"clean"},qp=(p,b,T)=>{const I=yh(p),$=p.trim(),G=I==="claude"||I==="gemini"||I==="amp"||I==="codex",q=G?`${$} ${_h(b)}`:$,c=gh(q,I==="shell"?"":I),u=I==="aider"?`/ask ${b}`:b;return I==="gemini"||I==="amp"?{provider:I,mode:T,inlineTransfer:G,interruptBeforeLaunch:T==="in_place",launchDelayMs:T==="clean"?350:300,transferDelayMs:T==="clean"?2200:1800,launchCommand:c,transferLine:u}:I==="claude"||I==="codex"?{provider:I,mode:T,inlineTransfer:G,interruptBeforeLaunch:T==="in_place",launchDelayMs:T==="clean"?320:260,transferDelayMs:T==="clean"?1500:1200,launchCommand:c,transferLine:u}:I==="aider"?{provider:I,mode:T,inlineTransfer:G,interruptBeforeLaunch:T==="in_place",launchDelayMs:T==="clean"?260:220,transferDelayMs:T==="clean"?900:800,launchCommand:c,transferLine:u}:{provider:I,mode:T,inlineTransfer:G,interruptBeforeLaunch:T==="in_place",launchDelayMs:T==="clean"?300:250,transferDelayMs:T==="clean"?1200:900,launchCommand:c,transferLine:u}},Qu="orchestrator.runtime.session",Ao={autonomousMode:!1,autoApproveMerge:!1,autoRespondPrompts:!1,promptResponse:"y"},dt=p=>p.trim().replace(/\\/g,"/").replace(/\/+$/,""),wh=p=>p.trim().replace(/\\/g,"/").replace(/^\.\/+/,""),Sh=p=>{const b=p.trim().replace(/\\/g,"/").replace(/^\.\/+/,"").toLowerCase();return b?b.split("/").pop()==="agents.md":!1},Ju=p=>{const b=xs(p.path).toLowerCase();return b==="agents.md"?0:b===".github/agents.md"?1:2},Zu=p=>{if(!Array.isArray(p)||p.length===0)return null;const b=p.filter(T=>Sh(T.path)).sort((T,I)=>{const $=Ju(T)-Ju(I);return $!==0?$:xs(T.path).localeCompare(xs(I.path))});return b.length>0?b[0]:null},Vp=p=>{const b=p.lastIndexOf(".");return b<=0?"":p.slice(b).toLowerCase()},xh=[/^openapi(\.|$)/i,/(^|\/)(openapi|swagger)\.(json|ya?ml)$/i,/(^|\/)(schema|db|database)\.prisma$/i,/(^|\/)package\.json$/i,/(^|\/)pnpm-lock\.yaml$/i,/(^|\/)package-lock\.json$/i,/(^|\/)yarn\.lock$/i,/(^|\/)go\.(mod|work|sum)$/i,/(^|\/)Cargo\.(toml|lock)$/i,/(^|\/)packages\/protocol\//i,/(^|\/)(api|contracts|schema|proto)\//i],Gp=p=>p.some(b=>xh.some(T=>T.test(b))),Ch=p=>{if(typeof p=="number"&&Number.isFinite(p))return p;if(typeof p=="string"){const b=Number(p.trim());if(Number.isFinite(b))return b}},$s=(p,b)=>{for(const T of b){const I=Ch(p[T]);if(typeof I=="number")return I}},kh=p=>{const b=p&&typeof p=="object"?p:null,T=[];if(b){T.push(b);for(const I of["usage","metrics","tokenUsage","stats","context"]){const $=b[I];$&&typeof $=="object"&&T.push($)}}for(const I of T){const $=$s(I,["contextTokens","context_tokens","contextSize","context_size","currentContextTokens","current_context_tokens"]),G=$s(I,["promptTokens","prompt_tokens","inputTokens","input_tokens"]),q=$s(I,["completionTokens","completion_tokens","outputTokens","output_tokens"]),c=$s(I,["totalTokens","total_tokens"]),u=$s(I,["contextWindow","context_window","maxContextTokens","max_context_tokens","modelContextWindow","model_context_window"]),g=$s(I,["percentUsed","contextUsagePercent","context_usage_percent","contextUsagePct","context_usage_pct"]),x=$s(I,["costUsd","cost_usd","estimatedCostUsd","estimated_cost_usd","totalCostUsd","total_cost_usd"]),h=$s(I,["promptCostUsd","prompt_cost_usd","inputCostUsd","input_cost_usd"]),v=$s(I,["completionCostUsd","completion_cost_usd","outputCostUsd","output_cost_usd"]),w={updatedAt:Date.now()};if(typeof $=="number"&&(w.contextTokens=$),typeof G=="number"&&(w.promptTokens=G),typeof q=="number"&&(w.completionTokens=q),typeof c=="number"&&(w.totalTokens=c),typeof u=="number"&&(w.contextWindow=u),typeof g=="number"&&(w.percentUsed=g<=1?g*100:g),typeof x=="number"&&(w.costUsd=x),typeof h=="number"&&(w.promptCostUsd=h),typeof v=="number"&&(w.completionCostUsd=v),typeof w.percentUsed!="number"&&typeof $=="number"&&typeof u=="number"&&u>0&&(w.percentUsed=$/u*100),typeof w.contextTokens=="number"||typeof w.promptTokens=="number"||typeof w.completionTokens=="number"||typeof w.totalTokens=="number"||typeof w.contextWindow=="number"||typeof w.percentUsed=="number"||typeof w.costUsd=="number"||typeof w.promptCostUsd=="number"||typeof w.completionCostUsd=="number")return w}return null},eh=(p,b)=>{const T=p==null?void 0:p[b];return typeof T=="number"&&Number.isFinite(T)?T:null},Yp=(p,b,T)=>eh(p,T)!==eh(b,T),Xp=(p,b)=>{if(!p&&b)return!0;if(!b)return!1;for(const T of["contextTokens","promptTokens","completionTokens","totalTokens","contextWindow","percentUsed","costUsd","promptCostUsd","completionCostUsd"])if(Yp(p,b,T))return!0;return!1},Qp=(p,b)=>{if(!p||!b)return!0;const T=Math.abs((b.totalTokens??p.totalTokens??0)-(p.totalTokens??0)),I=Math.abs((b.promptTokens??p.promptTokens??0)-(p.promptTokens??0)),$=Math.abs((b.completionTokens??p.completionTokens??0)-(p.completionTokens??0)),G=Math.abs((b.contextTokens??p.contextTokens??0)-(p.contextTokens??0)),q=Math.abs((b.percentUsed??p.percentUsed??0)-(p.percentUsed??0)),c=Math.abs((b.costUsd??p.costUsd??0)-(p.costUsd??0));return T>=64||I>=32||$>=32||G>=64||q>=1||c>=.001},Jp=p=>{if(!p||typeof p!="object")return{};const b={};for(const[T,I]of Object.entries(p)){const $=kh(I);if(!$)continue;const G=I&&typeof I=="object"?Ch(I.updatedAt):void 0;typeof G=="number"&&($.updatedAt=G),b[T]=$}return b},Zp=p=>{if(!p||typeof p!="object")return{};const b={};for(const[T,I]of Object.entries(p)){if(!I||typeof I!="object")continue;const $=I;b[T]={isReady:!!$.isReady,isDirty:!!$.isDirty,hasCollision:!!$.hasCollision,isBlocked:!1,blockedReason:void 0}}return b},em=p=>{const b={};for(const[T,I]of Object.entries(p||{}))b[T]={isReady:!!(I!=null&&I.isReady),isDirty:!!(I!=null&&I.isDirty),hasCollision:!!(I!=null&&I.hasCollision),isBlocked:!1,blockedReason:void 0};return b},tm=p=>{if(!p||typeof p!="object")return{};const b={};for(const[T,I]of Object.entries(p)){if(!Array.isArray(I))continue;const $=[];for(const G of I){if(!G||typeof G!="object")continue;const q=G,c=typeof q.title=="string"?q.title.trim():"";if(!c)continue;const u=q.status==="in_progress"||q.status==="done"?q.status:"pending",g=typeof q.id=="string"||typeof q.id=="number"?q.id:`${T}-${$.length+1}`;$.push({id:g,title:c,status:u})}$.length>0&&(b[T]=$)}return b},rm=p=>{if(!p||typeof p!="object")return{};const b={};for(const[T,I]of Object.entries(p)){const $=dt(T);if($){if(typeof I=="string"&&I.trim()){b[$]=I.trim();continue}b[$]=null}}return b},sm=p=>{if(!p||typeof p!="object")return{};const b={};for(const[T,I]of Object.entries(p)){const $=dt(T);if(!$||!I||typeof I!="object")continue;const G=I,q=G.promptResponse==="n"?"n":"y";b[$]={autonomousMode:!!G.autonomousMode,autoApproveMerge:!!G.autoApproveMerge,autoRespondPrompts:!!G.autoRespondPrompts,promptResponse:q}}return b},xs=p=>p.trim().replace(/\\/g,"/").replace(/^\.\/+/,"").replace(/\/+/g,"/"),nm=p=>{if(!p||typeof p!="object")return{};const b={};for(const[T,I]of Object.entries(p)){const $=dt(T);if(!$||!I||typeof I!="object")continue;const G=I,q=G.mode==="consolidated"?"consolidated":G.mode==="single"?"single":null;if(q){if(q==="single"){const c=typeof G.selectedPath=="string"?xs(G.selectedPath):"";if(!c||c.startsWith("/")||c.includes(".."))continue;b[$]={mode:"single",selectedPath:c};continue}b[$]={mode:"consolidated"}}}return b},th=p=>{const T=p.replace(/\\/g,"/").replace(/\/+$/,"").split("/").pop();return T&&T.trim()?T.trim():"restored-worktree"},im=72,om=24,am=8,To=p=>typeof p!="string"?"":p.trim().replace(/\s+/g," ").slice(0,im),lm=p=>typeof p!="string"?"":p.trim().toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9_-]/g,"").replace(/-+/g,"-").replace(/^-+|-+$/g,"").slice(0,om),yl=p=>{const b=Array.isArray(p)?p:typeof p=="string"?p.split(","):[],T=[],I=new Set;for(const $ of b){const G=lm($);if(!(!G||I.has(G))&&(I.add(G),T.push(G),T.length>=am))break}return T},cm=(p,b,T)=>{if(!Array.isArray(p))return[];const I=[];for(const $ of p){if(!$||typeof $!="object")continue;const G=$,q=typeof G.id=="string"&&G.id.trim()?G.id:`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,c=typeof G.name=="string"&&G.name.trim()?G.name.trim():"restored-task",u=To(G.displayName),g=yl(G.tags),x=typeof G.agent=="string"&&G.agent.trim()?G.agent.trim():T,h=typeof G.basePath=="string"&&G.basePath.trim()?G.basePath.trim():b,v={id:q,name:c,displayName:u&&u!==c?u:void 0,tags:g.length>0?g:void 0,agent:x,permissionMode:G.permissionMode==="bypass"?"bypass":"default",basePath:h,worktreePath:typeof G.worktreePath=="string"&&G.worktreePath.trim()?G.worktreePath:void 0,parentBranch:typeof G.parentBranch=="string"&&G.parentBranch.trim()?G.parentBranch.trim():void 0,parentTaskId:typeof G.parentTaskId=="string"&&G.parentTaskId.trim()?G.parentTaskId:void 0,prompt:typeof G.prompt=="string"?G.prompt:void 0,launchCommandOverride:typeof G.launchCommandOverride=="string"&&G.launchCommandOverride.trim()?G.launchCommandOverride.trim():void 0,livingSpecOverridePath:typeof G.livingSpecOverridePath=="string"&&G.livingSpecOverridePath.trim()?wh(G.livingSpecOverridePath):void 0,capabilities:G.capabilities&&typeof G.capabilities=="object"?{autoMerge:!!G.capabilities.autoMerge}:void 0,hasBootstrapped:typeof G.hasBootstrapped=="boolean"?G.hasBootstrapped:!0};I.push(v)}return I},um=()=>`restored-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,hm=()=>{const[p,b]=N.useState(null),[T,I]=N.useState([]),$=N.useRef([]),[G,q]=N.useState({}),c=N.useRef({}),[u,g]=N.useState(""),[x,h]=N.useState(null),[v,w]=N.useState(!1),[k,_]=N.useState(""),[o,a]=N.useState(""),[n,i]=N.useState("claude"),[f,S]=N.useState("off"),[C,E]=N.useState("copy_on_write"),[y,P]=N.useState(""),[O,F]=N.useState(""),[U,B]=N.useState(!1),[J,ie]=N.useState("off"),[fe,_e]=N.useState("off"),[Y,R]=N.useState([]),[M,A]=N.useState({}),[j,Z]=N.useState({}),[he,me]=N.useState({}),[ve,W]=N.useState({}),[D,oe]=N.useState(0),[ee,xe]=N.useState([]),[Ce,Ke]=N.useState([]),[Xe,ft]=N.useState({}),[gt,Ae]=N.useState({}),[Ht,Nt]=N.useState({}),[sr,kt]=N.useState({}),[De,Qe]=N.useState(null),ir=N.useRef({}),Mt=N.useRef({}),or=N.useRef({}),Re=N.useRef({}),ct=N.useRef({}),mt=N.useRef(null),Ue=ee[0]||null,ut=N.useCallback(async X=>{const se=dt(X);if(!se)return;const te=Mt.current[se],de=await window.electronAPI.getLivingSpecSummary(se,te);if(!de.success||!de.summary){kt(pe=>{const ue={...pe};return delete ue[se],ue});return}kt(pe=>({...pe,[se]:de.summary}))},[]);N.useEffect(()=>{$.current=T},[T]),N.useEffect(()=>{c.current=G},[G]),N.useEffect(()=>{ir.current=Xe},[Xe]),N.useEffect(()=>{Mt.current=gt},[gt]),N.useEffect(()=>{or.current=sr},[sr]),N.useEffect(()=>{const X=dt(u);X&&ut(X)},[u,gt,ut]);const nt=N.useCallback(async X=>{if(!X){h(null);return}const se=await window.electronAPI.validateSource(X);h(se)},[]),Qt=N.useCallback(X=>{g(X),nt(X)},[nt]),ar=N.useCallback(X=>{const se=dt(X);return se&&ir.current[se]||Ao},[]),Mr=N.useCallback((X,se)=>{const te=dt(X);te&&ft(de=>{const pe=de[te]||Ao,ue={autonomousMode:se.autonomousMode??pe.autonomousMode,autoApproveMerge:se.autoApproveMerge??pe.autoApproveMerge,autoRespondPrompts:se.autoRespondPrompts??pe.autoRespondPrompts,promptResponse:se.promptResponse==="n"?"n":se.promptResponse==="y"?"y":pe.promptResponse};return{...de,[te]:ue}})},[]),ur=N.useCallback((X,se)=>{if(!X)return!1;if(se.length===0)return!0;const te=se.filter(pe=>Sh(pe.path));if(te.length>0){if(X.mode!=="single"||!X.selectedPath)return!1;const pe=xs(X.selectedPath);return te.some(ue=>xs(ue.path)===pe)}if(X.mode==="consolidated")return!0;if(!X.selectedPath)return!1;const de=xs(X.selectedPath);return se.some(pe=>xs(pe.path)===de)},[]),Yt=N.useCallback((X,se)=>{const te=dt(X);te&&(Ae(de=>({...de,[te]:se})),ut(te))},[ut]),kr=N.useCallback(async X=>{const se=dt(X);if(!se)return[];const te=await window.electronAPI.detectLivingSpecCandidates(se);if(!te.success||!Array.isArray(te.candidates))return Nt(pe=>({...pe,[se]:[]})),[];const de=te.candidates.filter(pe=>pe&&typeof pe.path=="string"&&pe.path.trim()).map(pe=>({path:xs(pe.path),kind:typeof pe.kind=="string"&&pe.kind.trim()?pe.kind.trim():"spec"})).filter(pe=>pe.path&&!pe.path.startsWith("/")&&!pe.path.includes(".."));return Nt(pe=>({...pe,[se]:de})),de},[]),lr=N.useCallback(async X=>{const se=dt(X);if(!se)return{success:!0};const te=Ht[se],de=Array.isArray(te)?te:await kr(se);if(de.length===0)return{success:!0};const pe=Mt.current[se];if(ur(pe,de))return{success:!0};const ue=Zu(de);return ue?(Yt(se,{mode:"single",selectedPath:ue.path}),{success:!0}):de.length===1?(Yt(se,{mode:"single",selectedPath:de[0].path}),{success:!0}):(Qe({projectPath:se,candidates:de}),{success:!1,error:"Choose an AGENTS.md instruction file before spawning a new task."})},[kr,ur,Ht,Yt]),Fr=N.useCallback(X=>{const se=De;if(se){if(X.mode==="single"){const te=xs(X.selectedPath||"");if(!se.candidates.some(pe=>xs(pe.path)===te))return;Yt(se.projectPath,{mode:"single",selectedPath:te}),Qe(null);return}Yt(se.projectPath,{mode:"consolidated"}),Qe(null)}},[De,Yt]),Et=N.useCallback(()=>{Qe(null)},[]),Jt=N.useCallback(X=>{var ue;g(X),nt(X);const se=dt(X);if(!se){b(null);return}const te=$.current.filter(ge=>dt(ge.basePath)===se),de=c.current[se],pe=de&&te.some(ge=>ge.id===de)?de:((ue=te[0])==null?void 0:ue.id)||null;b(pe),q(ge=>({...ge,[se]:pe}))},[nt]),pt=N.useCallback(X=>{if(!X){b(null);return}const se=$.current.find(de=>de.id===X);if(!se)return;b(X);const te=dt(se.basePath);te&&q(de=>({...de,[te]:X})),se.basePath!==u&&(g(se.basePath),nt(se.basePath))},[u,nt]),Hr=N.useCallback(async()=>{const X=await window.electronAPI.openDirectoryDialog();return X&&Jt(X),X},[Jt]),jt=N.useCallback(X=>{const se=Date.now(),te=`${X.kind}::${X.projectPath}::${X.taskId}::${X.reason}`,de=ct.current[te]||0,pe=X.kind==="context_alert"||X.kind==="spec_deviation"?12e4:1500;se-de<pe||(ct.current[te]=se,Ke(ue=>[{id:`${se}-${Math.random().toString(36).slice(2,8)}`,createdAt:se,...X},...ue].slice(0,250)))},[]),Ls=N.useCallback(X=>{Ke(se=>se.filter(te=>te.id!==X))},[]),hs=N.useCallback(()=>{Ke([])},[]),es=N.useCallback(X=>{const se=dt(X);if(!se)return;const te=de=>{if(!Object.prototype.hasOwnProperty.call(de,se))return de;const pe={...de};return delete pe[se],pe};q(de=>te(de)),ft(de=>te(de)),Ae(de=>te(de)),Nt(de=>te(de)),kt(de=>te(de)),xe(de=>de.filter(pe=>{if(dt(pe.projectPath)===se)return!1;const ue=$.current.find(ge=>ge.id===pe.taskId);return ue?dt(ue.basePath)!==se:!0})),Ke(de=>de.filter(pe=>dt(pe.projectPath)!==se)),Qe(de=>(de==null?void 0:de.projectPath)===se?null:de)},[]),Xr=N.useCallback((X,se)=>{Ke(te=>te.filter(de=>de.taskId!==X?!0:!se||se.length===0?!1:!se.includes(de.kind)))},[]),br=N.useCallback(X=>{var pe;const se=$.current,te=se.find(ue=>ue.id===X),de=se.filter(ue=>ue.id!==X);if($.current=de,I(de),A(ue=>{const ge={...ue};return delete ge[X],ge}),Z(ue=>{const ge={...ue};return delete ge[X],ge}),me(ue=>{const ge={...ue};return delete ge[X],ge}),te){const ue=dt(te.basePath);if(ue){const ge=((pe=de.find(Q=>dt(Q.basePath)===ue))==null?void 0:pe.id)||null;q(Q=>({...Q,[ue]:ge}))}}b(ue=>{var ge;if(ue!==X)return ue;if(te){const Q=dt(te.basePath),Ie=de.find(Ge=>dt(Ge.basePath)===Q);if(Ie)return Ie.id}return((ge=de[0])==null?void 0:ge.id)||null})},[]),fr=N.useCallback(async(X,se)=>{const te=$.current.find(pe=>pe.id===X);if(!te)return{success:!1,error:"Task not found"};if(!te.worktreePath)return window.electronAPI.destroyPty(X),br(X),{success:!0};const de=se==="merge"?await window.electronAPI.mergeWorktree(te.basePath,te.name,te.worktreePath):await window.electronAPI.removeWorktree(te.basePath,te.name,te.worktreePath,!0);return de.success&&(window.electronAPI.fleetMarkClosed(X,se),window.electronAPI.fleetRecordEvent(X,se==="merge"?"worktree_merged":"worktree_deleted",{branch:te.name,worktreePath:te.worktreePath}),window.electronAPI.destroyPty(X),br(X)),de},[br]),vt=N.useCallback(async({rawTaskName:X,agentCommand:se,prompt:te,launchCommandOverride:de,permissionMode:pe,baseBranch:ue,createBaseBranchIfMissing:ge,dependencyCloneMode:Q,livingSpecOverridePath:Ie,capabilities:Ge,parentTaskId:Te,activate:Ne=!0})=>{if(!u)return{success:!1,error:"Base path is empty"};const Fe=await lr(u);if(!Fe.success)return{success:!1,error:Fe.error||"Living Spec selection is required."};const qe=`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,Ye=Op(X,qe),it=typeof ue=="string"&&ue.trim()?ue.trim():void 0,et={id:qe,name:Ye,agent:se,permissionMode:pe==="bypass"?"bypass":"default",basePath:u,parentBranch:it,parentTaskId:Te,prompt:te,launchCommandOverride:typeof de=="string"&&de.trim()?de.trim():void 0,livingSpecOverridePath:Ie?wh(Ie):void 0,capabilities:Ge,hasBootstrapped:!1},_t=[...$.current,et];$.current=_t,I(_t);const wt=dt(u);wt&&q(Ve=>({...Ve,[wt]:Ne?qe:Ve[wt]??null})),Ne&&b(qe);try{const Ve=await window.electronAPI.createWorktree(u,Ye,ue,{createBaseBranchIfMissing:ge,dependencyCloneMode:Q||C,packageStoreStrategy:f,pnpmStorePath:y,sharedCacheRoot:O,pnpmAutoInstall:U});return Ve.success&&Ve.worktreePath?($.current=$.current.map(Rt=>Rt.id===qe?{...Rt,worktreePath:Ve.worktreePath}:Rt),I($.current),window.electronAPI.fleetRecordEvent(qe,"task_spawned",{basePath:u,worktreePath:Ve.worktreePath,agent:se,parentBranch:it||null,parentTaskId:Te||null}),{success:!0,taskId:qe}):(br(qe),{success:!1,error:Ve.error||"Unable to create worktree"})}catch(Ve){return br(qe),{success:!1,error:Ve.message}}},[u,C,lr,f,U,y,br,O]),cn=N.useCallback(X=>{let se=!1;$.current=$.current.map(te=>te.id!==X||te.hasBootstrapped&&!te.launchCommandOverride?te:(se=!0,{...te,hasBootstrapped:!0,launchCommandOverride:void 0})),se&&I($.current)},[]),ts=N.useCallback((X,se)=>{const te=To(se);let de=!1,pe;return $.current=$.current.map(ue=>{if(ue.id!==X)return ue;const ge=To(ue.name),Q=To(ue.displayName),Ie=Q&&Q!==ge?Q:"",Ge=te&&te!==ge?te:"";return Ge===Ie?ue:(de=!0,pe=Ge||void 0,{...ue,displayName:Ge||void 0})}),de?(I($.current),window.electronAPI.fleetRecordEvent(X,"session_renamed",{displayName:pe||null}),!0):!1},[]),yr=N.useCallback((X,se)=>{const te=yl(se);let de=!1;return $.current=$.current.map(pe=>{if(pe.id!==X)return pe;const ue=yl(pe.tags);return ue.length===te.length&&ue.every((Ie,Ge)=>te[Ge]===Ie)?pe:(de=!0,{...pe,tags:te.length>0?te:void 0})}),de?(I($.current),window.electronAPI.fleetRecordEvent(X,"session_tags_updated",{tags:te}),!0):!1},[]),zt=N.useCallback(async(X,se,te,de)=>{const pe=Q=>new Promise(Ie=>window.setTimeout(Ie,Q)),ue=async(Q,Ie)=>{const Ge=String(Q||"").replace(/[\r\n]+/g," ").trim();if(!Ge)return{success:!1,error:"Empty PTY command."};const Te=8;for(let Ne=0;Ne<=Te;Ne+=1)try{const Fe=await window.electronAPI.launchPty(X,Ge,{suppressEcho:!0});if(Fe!=null&&Fe.success)return{success:!0};const qe=String((Fe==null?void 0:Fe.error)||"PTY launch failed.");if(Ne<Te&&/not running|session not found/i.test(qe)){window.electronAPI.createPty(X,Ie||""),await pe(Math.min(900,120*(Ne+1)));continue}return{success:!1,error:qe}}catch(Fe){const qe=String((Fe==null?void 0:Fe.message)||"PTY launch failed.");if(Ne<Te&&/not running|session not found/i.test(qe)){window.electronAPI.createPty(X,Ie||""),await pe(Math.min(900,120*(Ne+1)));continue}return{success:!1,error:qe}}return{success:!1,error:"PTY launch timed out."}},ge=async Q=>{var Ge;const Ie=Date.now()+Math.max(300,Q);for(;Date.now()<Ie;){try{const Te=await window.electronAPI.listPtySessions(),Ne=Te.success?(Ge=Te.sessions)==null?void 0:Ge.find(qe=>qe.taskId===X):void 0,Fe=String((Ne==null?void 0:Ne.mode)||"").toLowerCase();if(Fe==="agent"||Fe==="blocked"||Fe==="tui")return!0}catch{}await pe(120)}return!1};try{const Q=$.current.find(Ve=>Ve.id===X);if(!Q)return{success:!1,error:"Task not found."};if(!Q.worktreePath)return{success:!1,error:"Task worktree is not ready for handover."};const Ie=se.trim();if(!Ie)return{success:!1,error:"Target agent command is empty."};const Ge=te.trim();if(!Ge)return{success:!1,error:"Handover instruction cannot be empty."};const Te=async()=>{var Ve;try{const Rt=await window.electronAPI.listPtySessions(),ae=Rt.success?(Ve=Rt.sessions)==null?void 0:Ve.find(be=>be.taskId===X):void 0;(!ae||!ae.running)&&(window.electronAPI.createPty(X,Q.worktreePath),await pe(450))}catch{window.electronAPI.createPty(X,Q.worktreePath),await pe(450)}};await Te();const Ne=await window.electronAPI.getModifiedFiles(Q.worktreePath),Fe=Ne.success&&Array.isArray(Ne.files)?Ne.files:[],qe=Up({taskId:X,taskName:Q.name,worktreePath:Q.worktreePath,sourceAgent:Q.agent,targetAgent:Ie,parentBranch:Q.parentBranch,currentBranch:Q.name,objective:Q.prompt,operatorInstruction:Ge,status:M[X],todos:j[X]||[],usage:he[X],modifiedFiles:Fe}),Ye=de||Kp(Ie),it=await window.electronAPI.writeHandoverArtifact(Q.worktreePath,qe,Ie).catch(()=>({success:!1})),et=it.success?it.latestPath:void 0;et&&(qe.artifactPath=et,qe.transferBrief=`${qe.transferBrief} | Artifact=${et}`);const _t=qp(Ie,qe.transferBrief,Ye);Ye==="clean"?(await window.electronAPI.restartPty(X).catch(Rt=>({success:!1,error:(Rt==null?void 0:Rt.message)||"PTY restart failed."}))).success||(await Te(),window.electronAPI.writePty(X,""),await pe(180)):_t.interruptBeforeLaunch&&(window.electronAPI.writePty(X,""),await pe(150)),await pe(Math.min(_t.launchDelayMs,160));const wt=await ue(_t.launchCommand,Q.worktreePath);if(!wt.success)return{success:!1,error:wt.error||"Failed to launch target agent."};if(!_t.inlineTransfer){await ge(Math.min(2400,_t.transferDelayMs+500)),await pe(120);const Ve=_t.transferLine.replace(/[\r\n]+/g," ").trim();if(Ve){const Rt=await ue(Ve,Q.worktreePath);if(!Rt.success)return{success:!1,error:Rt.error||"Failed to deliver handover packet."}}}return $.current=$.current.map(Ve=>Ve.id===X?{...Ve,agent:Ie,hasBootstrapped:!0}:Ve),I($.current),window.electronAPI.fleetRecordEvent(X,"handover",{command:Ie,mode:Ye,promptLength:Ge.length,modifiedCount:qe.git.modifiedCount,todoCount:qe.task.todos.length,blocked:qe.task.isBlocked,artifactPath:et||null,inlineTransfer:_t.inlineTransfer,provider:_t.provider}),{success:!0,packet:qe,mode:Ye}}catch(Q){return{success:!1,error:(Q==null?void 0:Q.message)||"Handover failed unexpectedly."}}},[M,j,he]),rs=N.useCallback(async({parentTaskId:X,objective:se,count:te,command:de})=>{const pe=$.current.find(Ie=>Ie.id===X);if(!pe)return[];const ue=Math.min(8,Math.max(2,te)),ge=Date.now().toString().slice(-4),Q=[];for(let Ie=1;Ie<=ue;Ie+=1){const Ge=`${pe.name}-sub-${Ie}-${ge}`,Te=Fp(pe.name,se,Ie,ue),Ne=await vt({rawTaskName:Ge,agentCommand:de,prompt:Te,capabilities:{autoMerge:!1},parentTaskId:X,activate:!1});Ne.success&&Ne.taskId&&Q.push(Ne.taskId)}return Q.length>0&&(pt(Q[0]),window.electronAPI.fleetRecordEvent(X,"subtasks_spawned",{objective:se,count:ue,createdTaskIds:Q})),Q},[vt,pt]),Ut=N.useCallback((X,se,te)=>{const de=dt(X),pe=dt(se);if(!de||!pe)return null;const ue=$.current.find(Ie=>dt(Ie.worktreePath||"")===pe);if(ue)return pt(ue.id),ue.id;const ge={id:um(),name:te&&te.trim()?te.trim():th(pe),agent:n,permissionMode:"default",basePath:de,worktreePath:pe,capabilities:{autoMerge:!1},hasBootstrapped:!0},Q=[...$.current,ge];return $.current=Q,I(Q),b(ge.id),g(de),q(Ie=>({...Ie,[de]:ge.id})),nt(de),window.electronAPI.fleetRecordEvent(ge.id,"worktree_session_restored",{basePath:de,worktreePath:pe}),ge.id},[n,pt,nt]),zr=N.useCallback(async X=>{const se=ee.find(te=>te.requestId===X);if(se){if(window.electronAPI.respondToAgent(se.requestId,200,{status:"approved"}),se.action==="merge"){const te=await fr(se.taskId,"merge");if(!te.success){const de=$.current.find(pe=>pe.id===se.taskId);jt({kind:"approval_required",projectPath:(de==null?void 0:de.basePath)||"",taskId:se.taskId,taskName:(de==null?void 0:de.name)||se.taskId,reason:`Merge approval accepted, but local merge failed: ${te.error||"unknown error"}.`,requiresAction:!0})}}window.electronAPI.fleetRecordEvent(se.taskId,"approval_accepted",{action:se.action}),Xr(se.taskId,["approval_required"]),xe(te=>te.filter(de=>de.requestId!==se.requestId))}},[ee,fr,Xr,jt]),$r=N.useCallback(X=>{const se=ee.find(te=>te.requestId===X);se&&(window.electronAPI.respondToAgent(se.requestId,403,{error:"Request denied by user"}),window.electronAPI.fleetRecordEvent(se.taskId,"approval_rejected",{action:se.action}),Xr(se.taskId,["approval_required"]),xe(te=>te.filter(de=>de.requestId!==se.requestId)))},[ee,Xr]),hr=N.useCallback(async()=>{Ue&&await zr(Ue.requestId)},[Ue,zr]),bt=N.useCallback(()=>{Ue&&$r(Ue.requestId)},[Ue,$r]),Cs=N.useCallback(async()=>{const X=ee.map(se=>se.requestId);for(const se of X)await zr(se)},[ee,zr]),Ds=N.useCallback(()=>{ee.map(se=>se.requestId).forEach(se=>$r(se))},[ee,$r]),Ur=N.useCallback((X,se)=>{window.electronAPI.writePty(X,`${se}\r`),window.electronAPI.fleetRecordEvent(X,"blocked_prompt_response",{response:se})},[]),Er=N.useCallback(X=>{Object.entries(M).filter(([,te])=>!!(te!=null&&te.isBlocked)).map(([te])=>te).forEach(te=>{window.electronAPI.writePty(te,`${X}\r`),window.electronAPI.fleetRecordEvent(te,"blocked_prompt_response",{response:X,source:"bulk"})})},[M]);N.useEffect(()=>{let X=!1;return(async()=>{var fs,Ar;const te=window.electronAPI.detectAgents().then($e=>{X||R($e)}).catch(()=>{X||R([])}),[de,pe]=await Promise.all([window.electronAPI.loadStore(),window.electronAPI.loadRuntimeSession()]);if(X)return;const ue=de.success&&de.data?de.data:null,ge=pe.success&&pe.data?pe.data:null;let Q=null;if(typeof window<"u")try{const $e=window.sessionStorage.getItem(Qu);$e&&(Q=JSON.parse($e))}catch{}const Ie=await window.electronAPI.getDefaultPath();if(X)return;const Ge=(ge==null?void 0:ge.tabs)??(Q==null?void 0:Q.tabs)??[],Te=Array.isArray(Ge)&&Ge[0]&&typeof Ge[0]=="object"?Ge[0].basePath:void 0,Ne=dt((ue==null?void 0:ue.basePath)||(ge==null?void 0:ge.basePath)||(Q==null?void 0:Q.basePath)||(typeof Te=="string"?Te:"")||Ie),Fe=(ue==null?void 0:ue.defaultCommand)||(ge==null?void 0:ge.defaultCommand)||"claude",qe=rm((ge==null?void 0:ge.activeTabByProject)??(Q==null?void 0:Q.activeTabByProject)),Ye=sm(ue==null?void 0:ue.projectPermissions),it=nm(ue==null?void 0:ue.livingSpecPreferences);g(Ne),nt(Ne),ue!=null&&ue.context&&_(ue.context),ue!=null&&ue.defaultCommand&&i(ue.defaultCommand),((ue==null?void 0:ue.packageStoreStrategy)==="pnpm_global"||(ue==null?void 0:ue.packageStoreStrategy)==="polyglot_global")&&S(ue.packageStoreStrategy),(ue==null?void 0:ue.dependencyCloneMode)==="full_copy"&&E("full_copy"),typeof(ue==null?void 0:ue.pnpmStorePath)=="string"&&P(ue.pnpmStorePath),typeof(ue==null?void 0:ue.sharedCacheRoot)=="string"&&F(ue.sharedCacheRoot),typeof(ue==null?void 0:ue.pnpmAutoInstall)=="boolean"&&B(ue.pnpmAutoInstall),((ue==null?void 0:ue.sandboxMode)==="auto"||(ue==null?void 0:ue.sandboxMode)==="seatbelt"||(ue==null?void 0:ue.sandboxMode)==="firejail"||(ue==null?void 0:ue.sandboxMode)==="off")&&ie(ue.sandboxMode),((ue==null?void 0:ue.networkGuard)==="none"||(ue==null?void 0:ue.networkGuard)==="off")&&_e(ue.networkGuard);const et=(ge==null?void 0:ge.activeTab)??(Q==null?void 0:Q.activeTab)??null,_t=Jp((ge==null?void 0:ge.taskUsage)??(Q==null?void 0:Q.taskUsage)),wt=tm((ge==null?void 0:ge.taskTodos)??(Q==null?void 0:Q.taskTodos)),Ve=Zp((ge==null?void 0:ge.taskStatuses)??(Q==null?void 0:Q.taskStatuses)),Rt=cm(Ge,Ne,Fe).map($e=>({...$e,basePath:dt($e.basePath)||Ne})),ae=Array.from(new Set([Ne,...Rt.map($e=>dt($e.basePath)).filter(Boolean)])),be=[],ke=Date.now();let He=0;const ot=await Promise.all(ae.map(async $e=>({projectPath:$e,worktreeRes:await window.electronAPI.listWorktrees($e)})));for(const{projectPath:$e,worktreeRes:Oe}of ot){const tt=Rt.filter(At=>dt(At.basePath)===$e).map(At=>({...At,basePath:$e}));if(!X&&Oe.success&&Array.isArray(Oe.worktrees)){const At=Oe.worktrees,Ft=new Map,Wt=new Map;for(const ht of At)ht!=null&&ht.path&&(Ft.set(dt(ht.path),ht),ht.branchName&&Wt.set(ht.branchName,ht.path));const Kt=tt.map(ht=>{const er=ht.worktreePath?dt(ht.worktreePath):"";if(er&&Ft.has(er))return{...ht,worktreePath:er};const _r=Wt.get(ht.name);return _r?{...ht,worktreePath:dt(_r)}:ht}).filter(ht=>!!ht.worktreePath),ps=new Set(Kt.map(ht=>dt(ht.worktreePath||"")).filter(Boolean)),$t=new Set(Kt.map(ht=>ht.name));for(const ht of At){if(!ht.path)continue;const er=dt(ht.path),_r=ht.branchName||th(er);ps.has(er)||$t.has(_r)||(He+=1,Kt.push({id:`restored-${ke}-${He}`,name:_r,agent:Fe,permissionMode:"default",basePath:$e,worktreePath:er,capabilities:{autoMerge:!1},hasBootstrapped:!0}))}be.push(...Kt);continue}if(!X){const At=await Promise.all(tt.map(async Ft=>{if(!Ft.worktreePath)return{tab:Ft,valid:!1};const Wt=await window.electronAPI.validateSource(Ft.worktreePath);return{tab:Ft,valid:!!Wt.valid}}));be.push(...At.filter(Ft=>Ft.valid).map(Ft=>Ft.tab))}}const lt=new Map;for(const $e of be){if(!$e.worktreePath)continue;const Oe=`${dt($e.basePath)}::${dt($e.worktreePath)}`;lt.set(Oe,$e)}const Je=Array.from(lt.values()),Me={...qe},It=new Set([Ne]);Je.forEach($e=>It.add(dt($e.basePath)));for(const $e of It){const Oe=Je.filter(At=>dt(At.basePath)===$e),tt=Me[$e];Me[$e]=tt&&Oe.some(At=>At.id===tt)?tt:((fs=Oe[0])==null?void 0:fs.id)||null}const Ot=Je.some($e=>$e.id===et)?et:Me[Ne]||((Ar=Je[0])==null?void 0:Ar.id)||null,Zt={...Ye};for(const $e of It)Zt[$e]||(Zt[$e]={...Ao});$.current=Je,I(Je),b(Ot),q(Me),ft(Zt),Ae(it),me(_t),Z(wt),A(Ve);const mr=await window.electronAPI.listPendingAgentRequests().catch(()=>[]);if(X)return;const jr=(Array.isArray(mr)?mr:[]).map($e=>{const Oe=Je.find(tt=>tt.id===$e.taskId);return{requestId:$e.requestId,taskId:$e.taskId,action:$e.action,payload:$e.payload,projectPath:(Oe==null?void 0:Oe.basePath)||Ne}});xe($e=>{const Oe=new Map;return $e.forEach(tt=>Oe.set(tt.requestId,tt)),jr.forEach(tt=>Oe.set(tt.requestId,tt)),Array.from(Oe.values())}),jr.forEach($e=>{const Oe=Je.find(tt=>tt.id===$e.taskId);jt({kind:"approval_required",projectPath:$e.projectPath,taskId:$e.taskId,taskName:(Oe==null?void 0:Oe.name)||$e.taskId,reason:`Approval required for ${$e.action}`,requiresAction:!0})}),X||w(!0),await te})(),()=>{X=!0}},[nt]),N.useEffect(()=>{if(!v)return;const X=dt(u);if(!X)return;let se=!1;return(async()=>{const de=await kr(X);if(se)return;if(de.length===0){Qe(ge=>(ge==null?void 0:ge.projectPath)===X?null:ge);return}const pe=Mt.current[X];if(ur(pe,de)){Qe(ge=>(ge==null?void 0:ge.projectPath)===X?null:ge);return}const ue=Zu(de);if(ue){Yt(X,{mode:"single",selectedPath:ue.path}),Qe(ge=>(ge==null?void 0:ge.projectPath)===X?null:ge);return}if(de.length===1){Yt(X,{mode:"single",selectedPath:de[0].path}),Qe(ge=>(ge==null?void 0:ge.projectPath)===X?null:ge);return}Qe({projectPath:X,candidates:de})})(),()=>{se=!0}},[v,u,kr,ur,Yt]),N.useEffect(()=>{v&&window.electronAPI.saveStore({basePath:u,context:k,defaultCommand:n,packageStoreStrategy:f,dependencyCloneMode:C,pnpmStorePath:y,sharedCacheRoot:O,pnpmAutoInstall:U,sandboxMode:J,networkGuard:fe,projectPermissions:Xe,livingSpecPreferences:gt})},[v,u,k,n,f,C,y,O,U,J,fe,Xe,gt]),N.useEffect(()=>{if(!v)return;const X=em(M);if(window.electronAPI.saveRuntimeSession({basePath:u,tabs:T,activeTab:p,activeTabByProject:G,taskUsage:he,taskTodos:j,taskStatuses:X}),typeof window<"u")try{window.sessionStorage.setItem(Qu,JSON.stringify({basePath:u,tabs:T,activeTab:p,activeTabByProject:G,taskUsage:he,taskTodos:j,taskStatuses:X}))}catch{}},[v,u,T,p,G,he,j,M]),N.useEffect(()=>{if(v)return mt.current&&clearTimeout(mt.current),mt.current=setTimeout(()=>{$.current.forEach(se=>{const te=M[se.id],de=he[se.id];window.electronAPI.fleetTrackTask({taskId:se.id,runtimeTaskId:se.id,basePath:se.basePath,worktreePath:se.worktreePath,name:se.name,agent:se.agent,prompt:se.prompt,parentTaskId:se.parentTaskId,status:te!=null&&te.isBlocked?"blocked":te!=null&&te.isReady?"running":"provisioning",isReady:(te==null?void 0:te.isReady)||!1,isDirty:(te==null?void 0:te.isDirty)||!1,hasCollision:(te==null?void 0:te.hasCollision)||!1,isBlocked:(te==null?void 0:te.isBlocked)||!1,blockedReason:te==null?void 0:te.blockedReason,usage:de})})},250),()=>{mt.current&&(clearTimeout(mt.current),mt.current=null)}},[v,T,M,he]),N.useEffect(()=>{const X=[],se=window.electronAPI.onAgentRequest(Q=>{var Fe;const Ge=$.current.find(qe=>qe.id===Q.taskId);if(!Ge){window.electronAPI.respondToAgent(Q.requestId,404,{error:"Task not found"});return}const Te=ar(Ge.basePath);if(Q.action==="merge"&&(((Fe=Ge.capabilities)==null?void 0:Fe.autoMerge)||Te.autonomousMode||Te.autoApproveMerge)){jt({kind:"approval_auto_approved",projectPath:Ge.basePath,taskId:Q.taskId,taskName:Ge.name,reason:`Auto-approved ${Q.action} request`,requiresAction:!1}),window.electronAPI.respondToAgent(Q.requestId,200,{status:"approved",message:"Merge initiated"}),window.electronAPI.fleetRecordEvent(Q.taskId,"approval_auto_accepted",{action:Q.action,source:Te.autonomousMode?"project_autonomous_mode":Te.autoApproveMerge?"project_policy":"task_capability"}),setTimeout(()=>{fr(Q.taskId,"merge")},100);return}if(Te.autonomousMode){jt({kind:"approval_auto_approved",projectPath:Ge.basePath,taskId:Q.taskId,taskName:Ge.name,reason:`Autonomous mode approved ${Q.action} request`,requiresAction:!1}),window.electronAPI.respondToAgent(Q.requestId,200,{status:"approved",message:"Approved by autonomous mode"}),window.electronAPI.fleetRecordEvent(Q.taskId,"approval_auto_accepted",{action:Q.action,source:"project_autonomous_mode"});return}jt({kind:"approval_required",projectPath:Ge.basePath,taskId:Q.taskId,taskName:Ge.name,reason:`Approval required for ${Q.action}`,requiresAction:!0}),xe(qe=>qe.some(Ye=>Ye.requestId===Q.requestId)?qe:[...qe,{...Q,projectPath:Ge.basePath}])});X.push(se);const te=window.electronAPI.onAgentBlocked(({taskId:Q,isBlocked:Ie,reason:Ge})=>{if(A(Ye=>({...Ye,[Q]:{...Ye[Q]||{isReady:!0,isDirty:!1,hasCollision:!1},isBlocked:Ie,blockedReason:Ie?Ge:void 0}})),!Ie){Xr(Q,["blocked"]);return}const Te=$.current.find(Ye=>Ye.id===Q);if(!Te)return;jt({kind:"blocked",projectPath:Te.basePath,taskId:Q,taskName:Te.name,reason:Ge||"Agent is waiting for confirmation",requiresAction:!0});const Ne=ar(Te.basePath);if(!Ne.autonomousMode&&!Ne.autoRespondPrompts)return;const Fe=Re.current[Q]||0,qe=Date.now();qe-Fe<1200||(Re.current[Q]=qe,setTimeout(()=>{window.electronAPI.writePty(Q,`${Ne.promptResponse}\r`)},120),window.electronAPI.fleetRecordEvent(Q,"prompt_auto_response",{response:Ne.promptResponse,reason:Ge||null,source:Ne.autonomousMode?"project_autonomous_mode":"project_policy"}))});X.push(te);const de=window.electronAPI.onAgentTodos(Q=>{Array.isArray(Q.payload)&&Z(Ie=>({...Ie,[Q.taskId]:Q.payload}))});X.push(de);const pe=(Q,Ie)=>{if(!$.current.some(Fe=>Fe.id===Q))return;const Te=kh(Ie);if(!Te)return;const Ne=Date.now();me(Fe=>{const qe=Fe[Q],Ye={...qe||{},...Te,updatedAt:Ne};if(!Xp(qe,Ye))return Fe;const it=typeof(qe==null?void 0:qe.updatedAt)=="number"?qe.updatedAt:0,et=Ne-it;return et>0&&et<250&&!Qp(qe,Ye)?Fe:{...Fe,[Q]:Ye}})},ue=window.electronAPI.onAgentMessage(Q=>{pe(Q.taskId,Q.payload);const Ie=typeof Q.payload=="string"?Q.payload.slice(0,800):Q.payload&&typeof Q.payload=="object"?JSON.stringify(Q.payload).slice(0,1200):"";window.electronAPI.fleetRecordEvent(Q.taskId,"agent_message",{hasMessage:!!Ie,message:Ie})});X.push(ue);const ge=window.electronAPI.onAgentUsage(Q=>{pe(Q.taskId,Q.payload),window.electronAPI.fleetRecordEvent(Q.taskId,"agent_usage_reported",{payload:Q.payload&&typeof Q.payload=="object"?Q.payload:null})});return X.push(ge),()=>{X.forEach(Q=>Q())}},[fr,ar,jt,Xr]),N.useEffect(()=>{let X=!1,se=!1;const te=async()=>{if(!(X||se)&&!(typeof document<"u"&&document.hidden)){se=!0;try{const pe=$.current;if(pe.length===0){W({}),A({});return}const ue=pe.filter(Ye=>!!Ye.worktreePath),ge={},Q={},Ie=await Promise.all(ue.map(async Ye=>{const it=await window.electronAPI.getModifiedFiles(Ye.worktreePath);return{tabId:Ye.id,res:it}}));for(const{tabId:Ye,res:it}of Ie)Q[Ye]=!!it.success,it.success&&it.files&&(ge[Ye]=it.files);const Ge={},Te={},Ne=new Map(pe.map(Ye=>[Ye.id,Ye])),Fe=new Map;for(const Ye of Object.keys(ge)){Te[Ye]=ge[Ye].length>0;const it=Ne.get(Ye);if(!it)continue;const et=dt(it.basePath);if(!et)continue;const _t=Fe.get(et)||new Map;for(const wt of ge[Ye]){const Ve=_t.get(wt)||[];Ve.push(Ye),_t.set(wt,Ve)}Fe.set(et,_t)}const qe={};for(const[Ye,it]of Fe.entries()){const et=[],_t=new Set;for(const[wt,Ve]of it.entries())Ve.length<=1||(et.push(wt),Ve.forEach(Rt=>{Ge[Rt]=!0,_t.add(Rt)}));et.length>0&&(qe[Ye]={files:Array.from(new Set(et)).sort((wt,Ve)=>wt.localeCompare(Ve)),taskIds:Array.from(_t).sort((wt,Ve)=>wt.localeCompare(Ve))})}for(const[Ye,it]of Object.entries(ge)){if(!Gp(it))continue;const et=Ne.get(Ye);if(!et)continue;const _t=dt(et.basePath),wt=it.find(Ve=>xh.some(Rt=>Rt.test(Ve)))||it[0];for(const Ve of pe)Ve.id!==Ye&&dt(Ve.basePath)===_t&&Ve.worktreePath&&jt({kind:"context_alert",projectPath:Ve.basePath,taskId:Ve.id,taskName:Ve.name,reason:`Shared context updated by ${et.name}: ${wt}`,requiresAction:!1})}for(const[Ye,it]of Object.entries(ge)){if(it.length===0)continue;const et=Ne.get(Ye);if(!et)continue;const _t=or.current[dt(et.basePath)];if(!_t)continue;const wt=new Set((_t.forbiddenExts||[]).map(be=>be.toLowerCase())),Ve=new Set((_t.requiredExts||[]).map(be=>be.toLowerCase())),Rt=new Set(it.map(be=>Vp(be)).filter(Boolean)),ae=Array.from(Rt).find(be=>wt.has(be));if(ae){jt({kind:"spec_deviation",projectPath:et.basePath,taskId:et.id,taskName:et.name,reason:`Spec expects ${_t.preferredLanguage||"configured stack"} but task changed ${ae} files.`,requiresAction:!0});continue}if(Ve.size>0){const be=Array.from(Rt).some(He=>Ve.has(He));Array.from(Rt).some(He=>[".ts",".tsx",".js",".jsx",".py",".go",".rs"].includes(He))&&!be&&jt({kind:"spec_deviation",projectPath:et.basePath,taskId:et.id,taskName:et.name,reason:`Spec favors ${_t.preferredLanguage||"the selected spec"}, but recent edits target a different language set.`,requiresAction:!0})}}W(qe),A(Ye=>{const it={};return pe.forEach(et=>{var _t,wt,Ve;it[et.id]={isReady:!!et.worktreePath&&(et.worktreePath?Q[et.id]!==!1:!1),isDirty:Te[et.id]||!1,hasCollision:Ge[et.id]||!1,isBlocked:((_t=Ye[et.id])==null?void 0:_t.isBlocked)||!1,blockedReason:(wt=Ye[et.id])!=null&&wt.isBlocked?(Ve=Ye[et.id])==null?void 0:Ve.blockedReason:void 0}}),it})}finally{se=!1}}},de=setInterval(()=>{te()},1e4);return te(),()=>{X=!0,clearInterval(de)}},[jt,D]);const pr=N.useCallback(()=>{oe(X=>X+1)},[]),ds=T.filter(X=>{var se;return!!((se=M[X.id])!=null&&se.isBlocked)}).map(X=>{var se;return{taskId:X.id,taskName:X.name,projectPath:X.basePath,reason:((se=M[X.id])==null?void 0:se.blockedReason)||"Agent is waiting for confirmation."}});return{state:{activeTab:p,tabs:T,basePath:u,sourceStatus:x,isLoaded:v,context:k,envVars:o,defaultCommand:n,packageStoreStrategy:f,dependencyCloneMode:C,pnpmStorePath:y,sharedCacheRoot:O,pnpmAutoInstall:U,sandboxMode:J,networkGuard:fe,availableAgents:Y,taskStatuses:M,taskTodos:j,taskUsage:he,collisionsByProject:ve,pendingApproval:Ue,pendingApprovals:ee,pendingApprovalCount:ee.length,blockedTasks:ds,approvalInboxCount:ee.length+ds.length,attentionEvents:Ce,projectPermissions:Xe,livingSpecPreferences:gt,livingSpecCandidatesByProject:Ht,livingSpecSummariesByProject:sr,livingSpecSelectionPrompt:De,activeTabByProject:G},actions:{setActiveTab:pt,setBasePathAndValidate:Qt,switchProject:Jt,browseForBasePath:Hr,setContext:_,setEnvVars:a,setDefaultCommand:i,setPackageStoreStrategy:S,setDependencyCloneMode:E,setPnpmStorePath:P,setSharedCacheRoot:F,setPnpmAutoInstall:B,setSandboxMode:ie,setNetworkGuard:_e,updateProjectPermission:Mr,resolveLivingSpecSelectionPrompt:Fr,dismissLivingSpecSelectionPrompt:Et,dismissAttentionEvent:Ls,clearAttentionEvents:hs,forgetProjectState:es,createTask:vt,renameTaskSession:ts,setTaskTags:yr,markTaskBootstrapped:cn,closeTaskById:fr,handoverTask:zt,splitTask:rs,restoreExistingWorktree:Ut,approveApprovalRequest:zr,rejectApprovalRequest:$r,approveAllPendingRequests:Cs,rejectAllPendingRequests:Ds,respondToBlockedTask:Ur,respondToAllBlockedTasks:Er,approvePendingRequest:hr,rejectPendingRequest:bt,refreshTaskStatuses:pr,validatePath:nt}}},rh="orchestrator.sidebar.width",sh="orchestrator.project.paths",nh="orchestrator.project.rail.expanded",ih="orchestrator.theme",oh="orchestrator.welcome.dismissed.v1",Ai=180,_l=520,ah=p=>{if(typeof window>"u")return null;try{return window.localStorage.getItem(p)}catch{return null}},lh=(p,b)=>{if(!(typeof window>"u"))try{window.localStorage.setItem(p,b)}catch{}},Ct=p=>p.trim().replace(/\\/g,"/").replace(/\/+$/,""),Ss=p=>{const b=Ct(p),T=b.split("/");return T[T.length-1]||b},Qn=(p,b=3)=>{const T=Ct(p),I=T.split("/").filter(Boolean);return I.length<=b?T:`.../${I.slice(-b).join("/")}`},dm=(p,b)=>{const T=Ct(p),I=Ct(b);if(!I)return"-";if(!T)return Qn(I,4);if(I===T)return"./";if(I.startsWith(`${T}/`)){const $=I.slice(T.length+1),G=$.split("/").filter(Boolean);return G.length<=4?`./${$}`:`./.../${G.slice(-3).join("/")}`}return Qn(I,4)},fm=p=>{const b=Ss(p),T=Qn(p,3);return!T||T===p?b:`${b} (${T})`},us=p=>(typeof p.displayName=="string"?p.displayName.trim():"")||p.name,pm=p=>{const b=new Map;p.forEach(I=>{const $=Ss(I)||I;b.set($,(b.get($)||0)+1)});const T={};return p.forEach(I=>{const $=Ss(I)||I,G=(b.get($)||0)>1;T[I]=G?`${$}  ${Qn(I,2)}`:$}),T},mm=p=>/-worktrees\/[^/]+$/i.test(Ct(p)),gl=new Set(bn.map(p=>p.id));function _m(){var dn,ri;const{state:{activeTab:p,tabs:b,basePath:T,sourceStatus:I,context:$,envVars:G,defaultCommand:q,packageStoreStrategy:c,dependencyCloneMode:u,pnpmStorePath:g,sharedCacheRoot:x,pnpmAutoInstall:h,sandboxMode:v,networkGuard:w,availableAgents:k,taskStatuses:_,taskTodos:o,taskUsage:a,collisionsByProject:n,pendingApprovals:i,blockedTasks:f,approvalInboxCount:S,attentionEvents:C,livingSpecPreferences:E,livingSpecSelectionPrompt:y},actions:{setActiveTab:P,switchProject:O,browseForBasePath:F,setContext:U,setEnvVars:B,setDefaultCommand:J,setPackageStoreStrategy:ie,setDependencyCloneMode:fe,setPnpmStorePath:_e,setSharedCacheRoot:Y,setPnpmAutoInstall:R,setSandboxMode:M,setNetworkGuard:A,createTask:j,renameTaskSession:Z,markTaskBootstrapped:he,closeTaskById:me,restoreExistingWorktree:ve,approveApprovalRequest:W,rejectApprovalRequest:D,approveAllPendingRequests:oe,rejectAllPendingRequests:ee,respondToBlockedTask:xe,respondToAllBlockedTasks:Ce,dismissAttentionEvent:Ke,refreshTaskStatuses:Xe,resolveLivingSpecSelectionPrompt:ft,dismissLivingSpecSelectionPrompt:gt,forgetProjectState:Ae}}=hm(),[Ht,Nt]=N.useState(!1),[sr,kt]=N.useState(!1),[De,Qe]=N.useState(!1),[ir,Mt]=N.useState(!1),[or,Re]=N.useState(!1),ct=N.useRef(null),[mt,Ue]=N.useState(!1),[ut,nt]=N.useState(""),[Qt,ar]=N.useState(0),Mr=N.useRef([]),ur=N.useRef(null),[Yt,kr]=N.useState(!1),[lr,Fr]=N.useState(null),[Et,Jt]=N.useState(null),[pt,Hr]=N.useState(null),[jt,Ls]=N.useState(null),[hs,es]=N.useState(!1),[Xr,br]=N.useState({}),[fr,vt]=N.useState(()=>{const H=ah(ih)||"";return gl.has(H)?H:fl}),[cn,ts]=N.useState(()=>ah(oh)!=="1"),[yr,zt]=N.useState({isRepo:!1,currentBranch:null,defaultBranch:null}),[rs,Ut]=N.useState([]),[zr,$r]=N.useState(null),[hr,bt]=N.useState(null),[Cs,Ds]=N.useState([]),[Ur,Er]=N.useState(()=>{if(typeof window>"u")return[];try{const H=window.localStorage.getItem(sh);if(!H)return[];const le=JSON.parse(H);return Array.isArray(le)?Array.from(new Set(le.map(Pe=>typeof Pe=="string"?Ct(Pe):"").filter(Boolean))):[]}catch{return[]}}),[pr,ds]=N.useState(()=>typeof window>"u"?!1:window.localStorage.getItem(nh)==="1"),[X,se]=N.useState(()=>{if(typeof window>"u")return 280;const H=window.localStorage.getItem(rh),le=H?Number(H):NaN;return Number.isFinite(le)?Math.max(Ai,Math.min(_l,le)):280}),[te,de]=N.useState(!1);N.useEffect(()=>{const H=window.electronAPI.onGlobalShortcutNewTask(()=>{kt(!0)});return()=>{H()}},[]),N.useEffect(()=>{typeof window>"u"||window.localStorage.setItem(rh,String(X))},[X]),N.useEffect(()=>{const H=()=>{const le=Math.max(Ai+24,Math.min(_l,Math.floor(window.innerWidth*.45)));se(Pe=>Math.max(Ai,Math.min(le,Pe)))};return H(),window.addEventListener("resize",H),()=>{window.removeEventListener("resize",H)}},[]),N.useEffect(()=>{const H=gl.has(fr)?fr:fl;document.documentElement.setAttribute("data-theme",H),lh(ih,H)},[fr]),N.useEffect(()=>{document.title=ln.name},[]),N.useEffect(()=>{if(!hr)return;const H=window.setTimeout(()=>{bt(null)},3200);return()=>{window.clearTimeout(H)}},[hr]),N.useEffect(()=>{Er(H=>{const le=new Set(H),Pe=Ct(T);return Pe&&le.add(Pe),b.forEach(Ze=>{const Dt=Ct(Ze.basePath);Dt&&le.add(Dt)}),Array.from(le)})},[T,b]),N.useEffect(()=>{typeof window>"u"||window.localStorage.setItem(sh,JSON.stringify(Ur))},[Ur]),N.useEffect(()=>{typeof window>"u"||window.localStorage.setItem(nh,pr?"1":"0")},[pr]),N.useEffect(()=>{let H=!1;return(async()=>{const Pe=await window.electronAPI.fleetListProjects();if(H||!Pe.success||!Array.isArray(Pe.projects))return;const Ze=Pe.projects.map(Dt=>Dt&&typeof Dt.basePath=="string"?Ct(Dt.basePath):"").filter(Boolean);Ze.length!==0&&Er(Dt=>Array.from(new Set([...Dt,...Ze])))})(),()=>{H=!0}},[]),N.useEffect(()=>{if(!te)return;const H=Pe=>{const Ze=Math.max(Ai+40,Math.min(_l,Math.floor(window.innerWidth*.45)));se(Math.max(Ai,Math.min(Ze,Pe.clientX)))},le=()=>{de(!1),document.body.style.cursor="",document.body.style.userSelect=""};return document.body.style.cursor="col-resize",document.body.style.userSelect="none",window.addEventListener("mousemove",H),window.addEventListener("mouseup",le),()=>{document.body.style.cursor="",document.body.style.userSelect="",window.removeEventListener("mousemove",H),window.removeEventListener("mouseup",le)}},[te]),N.useEffect(()=>{let H=!1;return(async()=>{const Pe=Ct(T);if(!Pe){zt({isRepo:!1,currentBranch:null,defaultBranch:null}),Ut([]),$r(null);return}const[Ze,Dt,St]=await Promise.all([window.electronAPI.getWorkspaceInfo(Pe).catch(Bt=>({success:!1,error:(Bt==null?void 0:Bt.message)||"workspace info failed"})),window.electronAPI.listBranches(Pe).catch(Bt=>({success:!1,error:(Bt==null?void 0:Bt.message)||"branch listing failed",branches:[]})),window.electronAPI.getRepositoryWebUrl(Pe).catch(Bt=>({success:!1,error:(Bt==null?void 0:Bt.message)||"repo url lookup failed"}))]);if(H||!Ze.success){zt({isRepo:!1,currentBranch:null,defaultBranch:null}),Ut([]),$r(null);return}zt({isRepo:!!Ze.isRepo,currentBranch:Ze.currentBranch??null,defaultBranch:Ze.defaultBranch??null});const xt=Array.isArray(Dt.branches)?Dt.branches:[];Ut(xt),$r(St.success&&typeof St.webUrl=="string"?St.webUrl:null)})(),()=>{H=!0}},[T]),N.useEffect(()=>{const H=Pe=>{if((Pe.metaKey||Pe.ctrlKey)&&Pe.key.toLowerCase()==="k"){Pe.preventDefault(),Pe.stopPropagation(),mt?(Ue(!1),nt(""),ar(0),Mr.current=[]):Ue(!0);return}Pe.key==="Escape"&&mt&&(Ue(!1),nt(""),ar(0),Mr.current=[])};window.addEventListener("keydown",H,!0);const le=()=>{Ue(!0)};return window.addEventListener("orchestrator:open-command-palette",le),()=>{window.removeEventListener("keydown",H,!0),window.removeEventListener("orchestrator:open-command-palette",le)}},[mt]),N.useEffect(()=>{if(!or)return;const H=Pe=>{if(!ct.current)return;const Ze=Pe.target;Ze&&ct.current.contains(Ze)||Re(!1)},le=Pe=>{Pe.key==="Escape"&&Re(!1)};return window.addEventListener("mousedown",H),window.addEventListener("keydown",le),()=>{window.removeEventListener("mousedown",H),window.removeEventListener("keydown",le)}},[or]);const pe=Ct(T),ue=N.useMemo(()=>pe?b.filter(H=>Ct(H.basePath)===pe):b,[pe,b]);N.useEffect(()=>{ue.length!==0&&(p&&ue.some(H=>H.id===p)||P(ue[0].id))},[ue,p,P]);const ge=p?b.find(H=>H.id===p):null,Q=ge&&(!pe||Ct(ge.basePath)===pe)?ge:null,Ie=(Q==null?void 0:Q.worktreePath)||T,Ge=dm(T,Ie),Te=Q?o[Q.id]||[]:[],Ne=Q?_[Q.id]:void 0,Fe=N.useMemo(()=>new Map(b.map(H=>[H.id,H])),[b]),qe=N.useMemo(()=>ue.map(H=>({id:H.id,name:us(H),agent:H.agent,tags:H.tags})),[ue]),Ye=N.useMemo(()=>Cs.flatMap(H=>{const le=Fe.get(H);return le!=null&&le.worktreePath?[le]:[]}),[Cs,Fe]),it=yr.defaultBranch||yr.currentBranch||"main",et=Array.from(new Set([it,...rs].filter(Boolean))).sort((H,le)=>H.localeCompare(le)),wt=N.useMemo(()=>Array.from(new Set([T,...Ur,...b.map(H=>H.basePath)])).map(H=>Ct(H)).filter(H=>!!H&&!mm(H)).sort((H,le)=>H.localeCompare(le)),[T,Ur,b]),Ve=pm(wt),Rt=!!T.trim()&&!!(I!=null&&I.valid),ae=Q?Ne!=null&&Ne.isReady?Ne!=null&&Ne.isBlocked?"blocked":Ne!=null&&Ne.hasCollision?"collision":Ne!=null&&Ne.isDirty?"dirty":"clean":"provisioning":"standby",be=ae==="blocked"?"text-red-300 border-red-900/80 bg-[#240a0a]":ae==="collision"?"text-amber-300 border-amber-900/80 bg-[#1f1607]":ae==="dirty"?"text-blue-300 border-blue-900/80 bg-[#091424]":ae==="provisioning"?"text-cyan-300 border-cyan-900/80 bg-[#07161b]":ae==="standby"?"text-zinc-300 border-zinc-800 bg-[#121212]":"text-emerald-300 border-emerald-900/80 bg-[#0b1a13]",ke=N.useMemo(()=>{const H=(hr||"").trim().toLowerCase();return H?H.includes("failed")||H.includes("error")||H.includes("cannot")||H.includes("no remote repository url")?"error":H.includes("merged")||H.includes("deleted")||H.includes("completed")?"success":"info":"info"},[hr]),He=Ct(T),ot=He?C.filter(H=>Ct(H.projectPath)===He):C,lt=ot.find(H=>H.kind==="spec_deviation"),Je=ot.find(H=>H.kind==="context_alert"),Me=He?n[He]:void 0,It=(Me==null?void 0:Me.files)||[],Ot=N.useMemo(()=>((Me==null?void 0:Me.taskIds)||[]).flatMap(H=>{const le=Fe.get(H);return le?[us(le)]:[]}),[Me,Fe]),Zt=It.join("|"),mr=!!He&&Xr[He]===Zt,jr=It.length>0&&!mr,fs=jr||!!hr||!!lt||!!Je;N.useEffect(()=>{jr||es(!1)},[jr,He]);const Ar=Q?us(Q):"No active session",$e=Ge&&Ge!=="-"?Ge:Ie||T||"-",Oe=[...b.map(H=>({id:`task:${H.id}`,label:us(H),projectLabel:`${Ss(H.basePath)}  ${Qn(H.basePath,3)}`,searchText:`${us(H)} ${H.agent} ${Qn(H.basePath,3)}`.toLowerCase(),projectPath:H.basePath,taskId:H.id}))],tt=Q?Et&&!Et.taskId&&Q.hasBootstrapped===!1&&!Q.worktreePath||(Et==null?void 0:Et.taskId)===Q.id?Et.phase:Q.hasBootstrapped===!1?Q.worktreePath?"launching_agent":"preparing_environment":null:null,At=tt==="creating_worktree"?"Creating worktree":tt==="preparing_environment"?"Preparing environment":tt==="launching_agent"?"Launching agent":"",Ft=(Et==null?void 0:Et.taskName)||(Q?us(Q):""),Wt=!!tt;N.useEffect(()=>{Ds(H=>{const le=new Set(b.filter(Ze=>!!Ze.worktreePath).map(Ze=>Ze.id)),Pe=H.filter(Ze=>le.has(Ze));return!(Q!=null&&Q.worktreePath)||Pe.includes(Q.id)?Pe:[...Pe,Q.id]})},[b,Q==null?void 0:Q.id,Q==null?void 0:Q.worktreePath]);const Kt=ut.trim().toLowerCase(),$t=(Kt?Oe.filter(H=>H.searchText.includes(Kt)):Oe).slice(0,80),ht=H=>{const le=b.filter(St=>Ct(St.basePath)===Ct(H));return le.some(St=>{var xt;return(xt=_[St.id])==null?void 0:xt.isBlocked})?"bg-red-500":le.some(St=>{var xt;return(xt=_[St.id])==null?void 0:xt.hasCollision})?"bg-amber-400":le.some(St=>{var xt;return(xt=_[St.id])==null?void 0:xt.isReady})?"bg-emerald-400":"bg-[#2f2f2f]"},er=N.useMemo(()=>{const H={};return b.forEach(le=>{H[le.id]={taskName:us(le),projectPath:le.basePath,worktreePath:le.worktreePath}}),H},[b]),_r=N.useCallback(H=>{const le=Ct(H);le&&O(le)},[O]),ks=N.useCallback(H=>{const le=Ct(H);if(!le)return;const Pe=b.filter(Ze=>Ct(Ze.basePath)===le).map(Ze=>us(Ze));Ls({projectPath:le,sessionNames:Pe})},[b]),wr=(H,le)=>{const Pe=Ct(H);Pe&&(Er(Ze=>Array.from(new Set([...Ze,Pe]))),_r(Pe))},Ws=async H=>{const le=await window.electronAPI.openDirectoryDialog();le&&wr(le)},ss=async()=>{const H=await F();if(!H)return;const le=Ct(H);le&&Er(Pe=>Array.from(new Set([...Pe,le])))},Ns=N.useCallback(async()=>{const H=Ct(T);let le=typeof zr=="string"?zr.trim():"";if(!le&&H){const Ze=await window.electronAPI.getRepositoryWebUrl(H).catch(Dt=>({success:!1,error:(Dt==null?void 0:Dt.message)||"repo url lookup failed"}));Ze.success&&typeof Ze.webUrl=="string"&&(le=Ze.webUrl.trim(),$r(le))}if(!le){bt("No remote repository URL found for this project.");return}const Pe=await window.electronAPI.openExternalUrl(le);Pe.success||bt(`Failed to open repository URL: ${Pe.error||"unknown error"}.`)},[T,zr]),Br=N.useCallback(()=>{Ue(!1),nt(""),ar(0),Mr.current=[]},[]),bs=N.useCallback(H=>{_r(H.projectPath),P(H.taskId),Br()},[Br,_r,P]);N.useEffect(()=>{mt&&(ar(0),Mr.current=[])},[mt,ut]),N.useEffect(()=>{if(mt){if($t.length===0){Qt!==0&&ar(0);return}Qt>=$t.length&&ar($t.length-1)}},[Qt,mt,$t.length]),N.useEffect(()=>{if(!mt||$t.length===0)return;const H=Mr.current[Qt];H&&H.scrollIntoView({block:"nearest"})},[Qt,mt,$t.length]),N.useEffect(()=>{if(!mt)return;const H=requestAnimationFrame(()=>{var le,Pe;(le=ur.current)==null||le.focus(),(Pe=ur.current)==null||Pe.select()});return()=>cancelAnimationFrame(H)},[mt]);const Jn=N.useCallback(H=>{if(H==="Escape")return Br(),!0;if($t.length===0)return!1;if(H==="ArrowDown")return ar(le=>(le+1)%$t.length),!0;if(H==="ArrowUp")return ar(le=>(le-1+$t.length)%$t.length),!0;if(H==="Enter"){const le=$t[Qt]||$t[0];return le&&bs(le),!0}return!1},[Br,Qt,bs,$t]);N.useEffect(()=>{if(!mt)return;const H=le=>{!mt||le.metaKey||le.ctrlKey||le.altKey||!Jn(le.key)||(le.preventDefault(),le.stopPropagation())};return window.addEventListener("keydown",H,!0),()=>{window.removeEventListener("keydown",H,!0)}},[Jn,mt]),N.useEffect(()=>{if(!(Et!=null&&Et.taskId))return;const H=b.find(le=>le.id===Et.taskId);if(!H){Jt(null);return}if(H.hasBootstrapped){Jt(null);return}if(H.worktreePath&&Et.phase!=="launching_agent"){Jt(le=>le&&le.taskId===H.id?{...le,phase:"launching_agent"}:le);return}!H.worktreePath&&Et.phase!=="preparing_environment"&&Jt(le=>le&&le.taskId===H.id?{...le,phase:"preparing_environment"}:le)},[Et,b]);const jo=async(H,le,Pe,Ze,Dt,St)=>{if(!T||!(I!=null&&I.valid))return bt("Please select a valid base project path first."),{success:!1,error:"Please select a valid base project path first."};const xt=H.trim()||"new-session";Jt({taskName:xt,phase:"creating_worktree"});const Bt=await j({rawTaskName:H,agentCommand:le,prompt:Pe,permissionMode:St==null?void 0:St.permissionMode,launchCommandOverride:St==null?void 0:St.launchCommandOverride,baseBranch:Ze,createBaseBranchIfMissing:(St==null?void 0:St.createBaseBranchIfMissing)===!0,dependencyCloneMode:St==null?void 0:St.dependencyCloneMode,capabilities:Dt,activate:!0});return Bt.success?(Jt({taskName:xt,taskId:Bt.taskId,phase:"preparing_environment"}),{success:!0}):(Jt(null),bt(`Git worktree setup failed: ${Bt.error||"unknown error"}.`),{success:!1,error:Bt.error||"Git worktree setup failed."})},Zn=N.useCallback(H=>{const le=b.find(Pe=>Pe.id===H);le!=null&&le.worktreePath&&(Fr(H),kr(!0))},[b]),En=async()=>{if(!lr)return;const H=b.find(Pe=>Pe.id===lr),le=await me(lr,"merge");if(!le.success){bt(`Failed to merge worktree: ${le.error||"unknown error"}.`);return}bt(H?`Merged ${us(H)} into ${it}.`:"Merge completed.")},un=N.useCallback(H=>{const le=b.find(Dt=>Dt.id===H);if(!le)return!1;const Pe=(le.name||"").trim()||Ss(le.worktreePath||le.basePath),Ze=(le.worktreePath||"").trim();return Hr({kind:"task",taskId:le.id,sessionName:us(le),branchName:Pe,projectPath:le.basePath,worktreePath:Ze}),!0},[b]),ei=N.useCallback(H=>{un(H)},[un]),Es=(H,le,Pe)=>{const Ze=Ct(le),Dt=b.find(xt=>Ct(xt.worktreePath||"")===Ze);if(Dt){un(Dt.id);return}const St=(Pe||"").trim()||Ss(Ze);Hr({kind:"worktree",branchName:St,projectPath:H,worktreePath:Ze})},ti=N.useCallback(async()=>{if(!pt)return{success:!1,error:"No delete target selected."};if(pt.kind==="task"&&pt.taskId){const le=await me(pt.taskId,"delete");return le.success?(bt(`Deleted worktree for ${pt.sessionName||pt.branchName}.`),Mt(!1),{success:!0}):{success:!1,error:le.error||"Failed to delete worktree."}}const H=await window.electronAPI.removeWorktree(pt.projectPath,pt.branchName,pt.worktreePath,!0);return H.success?(bt(`Deleted worktree ${pt.branchName}.`),Mt(!1),{success:!0}):{success:!1,error:H.error||"Failed to delete worktree."}},[me,pt]),Pn=N.useCallback(async()=>{if(!jt)return{success:!1,error:"No project selected."};const H=Ct(jt.projectPath);if(!H)return{success:!1,error:"Invalid project path."};const le=b.filter(xt=>Ct(xt.basePath)===H).map(xt=>({id:xt.id,name:us(xt)})),Pe=Array.from(new Set([...Ur,...b.map(xt=>Ct(xt.basePath))])).map(xt=>Ct(xt)).filter(xt=>!!xt&&xt!==H),Ze=[];for(const xt of le){const Bt=await me(xt.id,"delete");Bt.success||Ze.push(`${xt.name}: ${Bt.error||"unknown error"}`)}if(Ze.length>0)return{success:!1,error:`Failed to delete ${Ze.length} session(s): ${Ze.slice(0,2).join(" | ")}`};const Dt=await window.electronAPI.fleetRemoveProject(H);if(!Dt.success)return{success:!1,error:Dt.error||"Failed to remove project history."};Ae(H),Er(xt=>xt.map(Bt=>Ct(Bt)).filter(Bt=>!!Bt&&Bt!==H)),Mt(!1),Ct(T)===H&&O(Pe[0]||"");const St=le.length;return bt(`Removed project ${Ss(H)} and ${St} session${St===1?"":"s"}.`),{success:!0}},[T,me,Ae,Ur,jt,O,b]),Li=()=>{ts(!1),lh(oh,"1")},hn=N.useCallback(H=>{vt(gl.has(H)?H:fl)},[]);return d.jsxs("div",{className:"flex h-screen w-full relative overflow-hidden",children:[d.jsxs("aside",{className:`${pr?"w-56":"w-14"} shrink-0 border-r border-[var(--panel-border)] bg-[var(--panel-subtle)] flex flex-col py-2 ${pr?"px-2":"items-center"} gap-1.5 transition-[width] duration-200`,children:[pr?d.jsxs("div",{className:"h-9 px-1 flex items-center justify-between",children:[d.jsx("span",{className:"text-[10px] uppercase tracking-[0.12em] font-mono text-[var(--text-tertiary)]",children:"Projects"}),d.jsxs("div",{className:"flex items-center gap-1",children:[d.jsx("button",{type:"button",onClick:()=>{Ws()},className:"h-7 w-7 rounded-md border border-transparent text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--panel)] flex items-center justify-center",title:"Add project",children:d.jsx(vl,{size:12})}),d.jsx("button",{type:"button",onClick:()=>ds(!1),className:"h-7 w-7 rounded-md border border-transparent text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--panel)] flex items-center justify-center",title:"Collapse project rail",children:d.jsx(pf,{size:12})})]})]}):d.jsxs("div",{className:"flex flex-col items-center gap-1",children:[d.jsx("button",{type:"button",onClick:()=>ds(!0),className:"h-8 w-9 rounded-md border border-transparent text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--panel)] flex items-center justify-center",title:"Expand project rail",children:d.jsx(mf,{size:12})}),d.jsx("button",{type:"button",onClick:()=>{Ws()},className:"h-8 w-9 rounded-md border border-transparent text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--panel)] flex items-center justify-center",title:"Add project",children:d.jsx(vl,{size:12})})]}),d.jsx("div",{className:`min-h-0 flex-1 ${pr?"overflow-y-auto space-y-1 pr-0.5":"overflow-y-auto flex flex-col items-center gap-1"}`,children:wt.map(H=>{const Pe=Ct(H)===Ct(T),Ze=Ss(H).slice(0,1).toUpperCase(),Dt=ht(H);return d.jsxs("div",{className:`group relative ${pr?"w-full":""}`,children:[d.jsx("button",{type:"button",onClick:()=>_r(H),className:`relative rounded-md text-[11px] font-mono flex items-center transition-colors border ${pr?`w-full h-10 pl-2 pr-8 justify-start gap-2 ${Pe?"border-[var(--input-border-focus)] bg-[var(--panel-strong)] text-[var(--text-primary)]":"border-transparent bg-transparent text-[var(--text-secondary)] hover:bg-[var(--panel)] hover:text-[var(--text-primary)]"}`:`w-9 h-9 justify-center ${Pe?"border-[var(--input-border-focus)] bg-[var(--panel-strong)] text-[var(--text-primary)]":"border-transparent text-[var(--text-secondary)] hover:bg-[var(--panel)]"}`}`,title:fm(H),children:pr?d.jsxs(d.Fragment,{children:[d.jsx("span",{className:"w-5 h-5 rounded border border-[var(--panel-border)] bg-[var(--panel)] text-[var(--text-secondary)] flex items-center justify-center text-[10px] shrink-0",children:Ze||"#"}),d.jsx("span",{className:"truncate flex-1 text-left",children:Ve[H]||Ss(H)}),d.jsx("span",{className:`w-2 h-2 rounded-full border border-[var(--panel)] shrink-0 ${Dt}`})]}):d.jsxs("span",{className:"relative w-5 h-5 rounded border border-[var(--panel-border)] bg-[var(--panel)] text-[10px] text-[var(--text-secondary)] flex items-center justify-center",children:[Ze||"#",d.jsx("span",{className:`absolute -right-1 -bottom-1 w-2.5 h-2.5 rounded-full border border-[var(--panel)] ${Dt}`})]})}),pr&&d.jsx("button",{type:"button",onClick:St=>{St.preventDefault(),St.stopPropagation(),ks(H)},className:`absolute right-1.5 top-1/2 -translate-y-1/2 h-6 w-6 rounded border border-transparent flex items-center justify-center transition-colors ${Pe?"text-[var(--text-secondary)] hover:text-red-300 hover:bg-[#2b1111]":"text-[var(--text-muted)] opacity-0 group-hover:opacity-100 hover:text-red-300 hover:bg-[#2b1111]"}`,title:`Remove project ${Ss(H)}`,"aria-label":`Remove project ${Ss(H)}`,children:d.jsx(Ti,{size:11})})]},H)})})]}),d.jsx(Ff,{tabs:qe,activeTab:p,statuses:_,usageByTask:a,width:X,repoWebUrl:zr,onSelectTab:P,onOpenRepo:()=>{Ns()},onDeleteTask:ei,onRenameTask:(H,le)=>{Z(H,le)&&bt("Session name updated.")},onNewTask:()=>{if(!Rt){ss();return}kt(!0)}}),d.jsx("div",{className:"w-1.5 shrink-0 mx-1 my-2 rounded bg-transparent hover:bg-[var(--panel-border)] active:bg-[var(--btn-ghost-border-hover)] cursor-col-resize",onMouseDown:H=>{H.preventDefault(),de(!0)},"aria-label":"Resize sidebar",role:"separator"}),d.jsxs("main",{className:"flex-1 min-w-0 flex flex-col h-full relative z-10 pt-2 pr-2 pb-2",children:[fs&&d.jsxs("div",{className:"space-y-2 mb-2",children:[jr&&d.jsxs("div",{className:"bg-[#1a0505] border border-red-900 rounded-lg z-40 text-red-300 shadow-sm px-3 py-2",children:[d.jsxs("div",{className:"flex items-start gap-2",children:[d.jsx(Us,{size:14,className:"mt-0.5 text-red-500 shrink-0"}),d.jsxs("div",{className:"min-w-0 flex-1",children:[d.jsx("div",{className:"text-xs font-semibold",children:"Collision detected in this project."}),d.jsxs("div",{className:"text-[11px] text-red-200/90 mt-0.5 truncate",title:It.join(", "),children:["Files: ",It.length>4?`${It.slice(0,4).join(", ")} +${It.length-4} more`:It.join(", ")]}),Ot.length>0&&d.jsxs("div",{className:"text-[11px] text-red-200/90 mt-0.5 truncate",title:Ot.join(", "),children:["Sessions: ",Ot.join(", ")]})]}),d.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[d.jsx("button",{type:"button",onClick:()=>{Xe(),bt("Re-checking project collisions...")},className:"h-7 px-2 rounded border border-red-800/90 text-[10px] font-semibold text-red-200 hover:bg-[#2b1111]",children:"Re-check"}),d.jsx("button",{type:"button",onClick:()=>es(H=>!H),className:"h-7 px-2 rounded border border-red-800/90 text-[10px] font-semibold text-red-200 hover:bg-[#2b1111]",children:hs?"Hide steps":"How to fix"}),d.jsx("button",{type:"button",onClick:()=>{He&&br(H=>({...H,[He]:Zt}))},className:"h-7 px-2 rounded border border-red-800/90 text-[10px] font-semibold text-red-200 hover:bg-[#2b1111]",children:"Dismiss"})]})]}),hs&&d.jsxs("div",{className:"mt-2 pl-6 text-[11px] text-red-100 space-y-1",children:[d.jsx("p",{className:"font-semibold",children:"Resolution steps"}),d.jsxs("ol",{className:"list-decimal pl-4 space-y-0.5",children:[d.jsx("li",{children:"Open one listed session and keep it as the source of truth for each colliding file."}),d.jsx("li",{children:"Merge or rebase sibling sessions, then resolve conflicts so each file has one final owner."}),d.jsx("li",{children:"Close stale sessions in this project rail if they are no longer needed."}),d.jsx("li",{children:"Click Re-check to refresh collision state for this project."})]})]})]}),hr&&d.jsxs("div",{className:`h-9 rounded-lg flex items-center z-40 text-[11px] font-semibold shadow-sm px-3 gap-2 ${ke==="error"?"border border-red-900/80 bg-[#1a0505] text-red-300":ke==="success"?"border border-emerald-900/80 bg-[#0b1a13] text-emerald-300":"app-panel border border-[var(--panel-border)] text-[var(--text-primary)]"}`,role:ke==="error"?"alert":void 0,children:[ke==="error"&&d.jsx(Us,{size:13,className:"shrink-0 text-red-400"}),d.jsx("span",{className:"truncate",children:hr})]}),lt&&d.jsx("button",{type:"button",onClick:()=>{P(lt.taskId);const H=Fe.get(lt.taskId);H!=null&&H.worktreePath?(Fr(lt.taskId),kr(!0)):bt(`Spec deviation: ${lt.reason}`),Ke(lt.id)},className:"btn-warning w-full h-9 rounded-lg z-40 text-[11px] px-3",children:d.jsxs("span",{className:"truncate",children:["Spec deviation: ",lt.taskName,"  ",lt.reason]})}),Je&&!lt&&d.jsx("button",{type:"button",onClick:()=>{P(Je.taskId);const H=Fe.get(Je.taskId);H!=null&&H.worktreePath?(Fr(Je.taskId),kr(!0)):bt(`Context alert: ${Je.reason}`),Ke(Je.id)},className:"btn-info w-full h-9 rounded-lg z-40 text-[11px] px-3",children:d.jsxs("span",{className:"truncate",children:["Context alert: ",Je.taskName,"  ",Je.reason]})})]}),d.jsx("div",{className:"app-panel rounded-xl px-3 py-2 z-30",children:d.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-wrap lg:flex-nowrap",children:[d.jsx("div",{className:"w-8 h-8 rounded-md border border-[var(--panel-border)] bg-[var(--panel-subtle)] p-1.5 shrink-0",children:d.jsx("img",{src:ln.logoSrc,alt:`${ln.name} logo`,className:"w-full h-full"})}),d.jsxs("div",{className:"min-w-0 flex-1 basis-full lg:basis-auto",children:[d.jsx("div",{className:"text-[13px] text-[var(--text-primary)] font-mono truncate",title:Ar,children:Ar}),d.jsxs("div",{className:"mt-0.5 flex items-center gap-2 min-w-0",children:[d.jsx("div",{className:"text-[11px] text-[var(--text-muted)] font-mono truncate min-w-0",title:Ie||T,children:$e}),yr.isRepo&&d.jsxs("span",{className:"text-[10px] tracking-wide border border-[var(--panel-border)] rounded px-2 py-0.5 font-mono text-[var(--text-secondary)] bg-[var(--panel-subtle)] shrink-0",children:["base ",it]})]})]}),d.jsxs("div",{className:"relative flex items-center gap-1.5 shrink-0 ml-auto",ref:ct,children:[d.jsx("span",{title:"Task state: standby (no active task), provisioning (creating worktree), blocked (needs input), collision (same file edited by multiple agents), dirty (uncommitted changes), clean (no local changes).",className:`text-[10px] uppercase tracking-wider border rounded px-2 py-0.5 font-mono ${be}`,children:ae}),S>0&&d.jsxs("button",{onClick:()=>Qe(!0),className:"btn-warning px-2 py-0.5 text-[10px] font-mono",title:"Open approval inbox",children:["inbox ",S]}),d.jsx("button",{onClick:()=>Ue(!0),className:"px-2 py-1 rounded-md btn-ghost text-[10px] font-mono",title:"Open command palette (Cmd/Ctrl+K)",children:"K"}),d.jsx("button",{onClick:()=>Re(H=>!H),className:"btn-ghost btn-icon rounded-md",title:"More actions","aria-expanded":or,"aria-haspopup":"menu",children:d.jsx(wf,{size:14})}),or&&d.jsxs("div",{className:"absolute right-0 top-[calc(100%+0.4rem)] w-44 app-panel border border-[var(--panel-border)] rounded-lg shadow-xl p-1.5 z-40",role:"menu","aria-label":"Header actions",children:[d.jsxs("button",{type:"button",className:"btn-ghost w-full justify-start px-2 py-1.5 text-[11px] font-mono",onClick:()=>{Mt(!0),Re(!1)},role:"menuitem",children:[d.jsx(hh,{size:13}),"Worktrees"]}),d.jsxs("button",{type:"button",className:"btn-ghost w-full justify-start px-2 py-1.5 text-[11px] font-mono",onClick:()=>{Nt(!0),Re(!1)},role:"menuitem",children:[d.jsx(Mf,{size:13}),"Settings"]})]})]})]})}),d.jsx("div",{className:"flex-1 mt-2 relative z-20 overflow-hidden",children:Q?d.jsxs("div",{className:"h-full flex gap-2",children:[d.jsx("div",{className:"flex-1 min-w-0 app-panel rounded-xl overflow-hidden",children:d.jsxs("div",{className:"h-full flex flex-col p-1 relative z-10",children:[Ye.map(H=>{var le,Pe;return d.jsx("div",{className:`absolute inset-0 transition-opacity duration-75 ${H.id===Q.id?"opacity-100 pointer-events-auto z-20":"opacity-0 pointer-events-none z-0"}`,"aria-hidden":H.id!==Q.id,children:d.jsx(dp,{taskId:H.id,cwd:H.worktreePath,agentCommand:H.agent,context:$,envVars:G,prompt:H.prompt,permissionMode:H.permissionMode,launchCommandOverride:H.launchCommandOverride,isActive:H.id===Q.id,shouldBootstrap:H.hasBootstrapped===!1,onBootstrapped:he,capabilities:H.capabilities,taskUsage:a[H.id],projectPath:H.basePath,parentBranch:H.parentBranch||it,livingSpecPreference:E[Ct(H.basePath)],livingSpecOverridePath:H.livingSpecOverridePath,packageStoreStrategy:c,pnpmStorePath:g,sharedCacheRoot:x,sandboxMode:v,networkGuard:w,isBlocked:(le=_[H.id])==null?void 0:le.isBlocked,blockedReason:(Pe=_[H.id])==null?void 0:Pe.blockedReason,onMerge:Zn,onDelete:ei})},H.id)}),Wt&&d.jsx("div",{className:"absolute inset-0 z-30 app-panel flex items-center justify-center",children:d.jsxs("div",{className:"w-[22rem] max-w-[88%] rounded-lg border border-[var(--panel-border)] bg-[var(--panel-subtle)] px-4 py-4",children:[d.jsx("div",{className:"text-[11px] uppercase tracking-[0.16em] font-mono text-[var(--text-secondary)]",children:"Starting Session"}),d.jsx("div",{className:"mt-1 text-[13px] font-mono text-[var(--text-primary)] truncate",title:Ft,children:Ft}),d.jsx("div",{className:"mt-3 space-y-2",children:[{key:"creating_worktree",label:"Create worktree"},{key:"preparing_environment",label:"Prepare environment"},{key:"launching_agent",label:"Launch agent"}].map(H=>{const le=H.key===tt?"active":tt==="preparing_environment"&&H.key==="creating_worktree"||tt==="launching_agent"&&(H.key==="creating_worktree"||H.key==="preparing_environment")?"done":"pending";return d.jsxs("div",{className:"flex items-center gap-2 text-[11px] font-mono",children:[d.jsx("span",{className:`h-2.5 w-2.5 rounded-full ${le==="done"?"bg-emerald-400":le==="active"?"bg-cyan-400 animate-pulse":"bg-[var(--panel-border)]"}`}),d.jsx("span",{className:le==="pending"?"text-[var(--text-muted)]":"text-[var(--text-primary)]",children:H.label})]},H.key)})}),d.jsxs("div",{className:"mt-3 text-[10px] font-mono text-[var(--text-tertiary)]",children:[At,"..."]})]})}),!Wt&&!Q.worktreePath&&d.jsxs("div",{className:"h-full w-full flex flex-col items-center justify-center font-mono",children:[d.jsx("div",{className:"mb-3 text-[var(--text-primary)] text-[11px] uppercase tracking-widest",children:"Initializing Environment"}),d.jsx("div",{className:"text-[var(--text-muted)] text-[10px]",children:us(Q)})]})]})}),Te.length>0&&d.jsx("div",{className:"hidden xl:block w-72 max-w-[32%] app-panel rounded-xl overflow-hidden",children:d.jsx(Sp,{todos:Te})})]}):d.jsx(xp,{basePath:T,sourceStatus:I,onBrowseWorkspace:()=>{ss()},onSpawnAgent:()=>{if(!Rt){ss();return}kt(!0)}})})]}),d.jsx(pp,{isOpen:Ht,onClose:()=>Nt(!1),context:$,setContext:U,envVars:G,setEnvVars:B,defaultCommand:q,setDefaultCommand:J,packageStoreStrategy:c,setPackageStoreStrategy:ie,dependencyCloneMode:u,setDependencyCloneMode:fe,pnpmStorePath:g,setPnpmStorePath:_e,sharedCacheRoot:x,setSharedCacheRoot:Y,pnpmAutoInstall:h,setPnpmAutoInstall:R,sandboxMode:v,setSandboxMode:M,networkGuard:w,setNetworkGuard:A,availableAgents:k,theme:fr,setTheme:hn}),Yt&&lr&&d.jsx(mp,{isOpen:Yt,onClose:()=>kr(!1),onConfirm:()=>{kr(!1),En()},worktreePath:((dn=b.find(H=>H.id===lr))==null?void 0:dn.worktreePath)||"",branchName:(ri=b.find(H=>H.id===lr))==null?void 0:ri.name,targetBranch:it}),d.jsx(vp,{isOpen:sr,onClose:()=>kt(!1),projectName:T.split("/").pop()||"proj",basePath:T,parentBranch:it,availableBranches:et,dependencyCloneMode:u,onSubmit:jo,defaultCommand:q,availableAgents:k}),d.jsx(wp,{isOpen:De,onClose:()=>Qe(!1),pendingApprovals:i,blockedTasks:f,taskMetaById:er,onSelectTask:H=>{P(H),Qe(!1)},onApproveOne:H=>{W(H)},onRejectOne:D,onApproveAll:()=>{oe()},onRejectAll:ee,onRespondBlocked:xe,onRespondAllBlocked:Ce}),d.jsx(Bp,{isOpen:ir,onClose:()=>Mt(!1),projectPaths:wt,tabs:b,statuses:_,onOpenSession:H=>P(H),onOpenWorktree:(H,le,Pe)=>{ve(H,le,Pe)},onDeleteWorktree:(H,le,Pe)=>{Es(H,le,Pe)}}),d.jsx(Ip,{isOpen:!!y,prompt:y,preference:y?E[Ct(y.projectPath)]:void 0,onApply:ft,onClose:gt}),d.jsx(Lp,{isOpen:!!pt,kind:(pt==null?void 0:pt.kind)==="task"?"session":"worktree",sessionName:pt==null?void 0:pt.sessionName,branchName:(pt==null?void 0:pt.branchName)||"",projectPath:(pt==null?void 0:pt.projectPath)||"",worktreePath:(pt==null?void 0:pt.worktreePath)||"",onClose:()=>Hr(null),onConfirm:ti}),d.jsx(Mp,{isOpen:!!jt,projectPath:(jt==null?void 0:jt.projectPath)||"",sessionNames:(jt==null?void 0:jt.sessionNames)||[],onClose:()=>Ls(null),onConfirm:Pn}),mt&&d.jsx("div",{className:"fixed inset-0 z-[92] bg-black/65 backdrop-blur-sm flex items-start justify-center pt-[9vh] px-4",onClick:Br,children:d.jsxs("div",{className:"w-full max-w-xl app-panel border border-[var(--panel-border)] rounded-xl overflow-hidden shadow-2xl",onClick:H=>H.stopPropagation(),children:[d.jsx("div",{className:"px-3 py-2.5 border-b border-[var(--panel-border)]",children:d.jsx("input",{ref:ur,value:ut,onChange:H=>nt(H.target.value),onKeyDown:H=>{H.metaKey||H.ctrlKey||H.altKey||!Jn(H.key)||(H.preventDefault(),H.stopPropagation())},placeholder:"Jump to session or project...",className:"w-full input-stealth rounded px-3 py-2 text-sm font-mono"})}),d.jsx("div",{className:"max-h-[58vh] overflow-y-auto p-2 space-y-1",children:$t.length===0?d.jsx("div",{className:"text-xs text-[var(--text-secondary)] font-mono px-2 py-3",children:"No matches"}):$t.map((H,le)=>d.jsxs("button",{type:"button",ref:Pe=>{Mr.current[le]=Pe},onMouseEnter:()=>ar(le),onClick:()=>bs(H),"aria-selected":le===Qt,className:`w-full text-left px-3 py-2 rounded-md font-mono border transition-colors ${le===Qt?"bg-[var(--panel-strong)] border-[var(--btn-primary-bg)] text-[var(--text-primary)]":"border-transparent text-[var(--text-secondary)] hover:bg-[var(--panel-subtle)] hover:text-[var(--text-primary)]"}`,children:[d.jsx("div",{className:"truncate text-[13px]",children:H.label}),d.jsx("div",{className:"truncate text-[10px] mt-0.5 text-[var(--text-tertiary)]",children:H.projectLabel})]},H.id))})]})}),d.jsx(Tp,{isOpen:cn,theme:fr,setTheme:hn,onContinue:Li})]})}af.createRoot(document.getElementById("root")).render(d.jsx(_m,{}));
